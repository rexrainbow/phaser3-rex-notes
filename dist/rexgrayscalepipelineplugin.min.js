var e,n;e=void 0,n=function(){const e=Phaser.Renderer.WebGL.Pipelines.PostFXPipeline,n=Phaser.Utils.Objects.GetValue;class t extends e{constructor(e){super({name:"rexGrayScalePostFx",game:e,renderTarget:!0,fragShader:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n// Effect parameters\nuniform float intensity;\nvoid main (void) {\n  vec4 front = texture2D(uMainSampler, outTexCoord);\n  float gray = dot(front.rgb, vec3(0.299, 0.587, 0.114));\n  gl_FragColor = mix(front, vec4(gray, gray, gray, front.a), intensity);\n}\n"}),this.intensity=1}resetFromJSON(e){return this.setIntensity(n(e,"intensity",1)),this}onPreRender(){this.set1f("intensity",this.intensity)}setIntensity(e){return this.intensity=e,this}}const i=Phaser.Game;var s=function(e){return e instanceof i};const r=Phaser.Scene;var o=function(e){return e instanceof r},a=function(e,n,t){var i;(i=e,null==i||"object"!=typeof i?null:s(i)?i:s(i.game)?i.game:o(i)?i.sys.game:o(i.scene)?i.scene.sys.game:void 0).renderer.pipelines.addPostPipeline(n,t)};const l=Phaser.Utils.Array.SpliceOne;class p extends Phaser.Plugins.BasePlugin{setPostPipelineClass(e,n){return this.PostFxPipelineClass=e,this.postFxPipelineName=n,this}start(){this.game.events.once("destroy",this.destroy,this),a(this.game,this.postFxPipelineName,this.PostFxPipelineClass)}add(e,n){return function(e,n,t){void 0===t&&(t={}),e.setPostPipeline(n);var i=e.postPipelines[e.postPipelines.length-1];return i.resetFromJSON(t),t.name&&(i.name=t.name),i}(e,this.PostFxPipelineClass,n)}remove(e,n){return function(e,n,t){if(void 0===t)for(var i=(s=e.postPipelines).length-1;i>=0;i--)(o=s[i])instanceof n&&(o.destroy(),l(s,i));else{i=0;for(var s,r=(s=e.postPipelines).length;i<r;i++){var o;(o=s[i])instanceof n&&o.name===t&&(o.destroy(),l(s,i))}}e.hasPostPipeline=e.postPipelines.length>0}(e,this.PostFxPipelineClass,n),this}get(e,n){return function(e,n,t){if(void 0===t){for(var i=[],s=0,r=(o=e.postPipelines).length;s<r;s++)(a=o[s])instanceof n&&i.push(a);return i}var o;for(s=0,r=(o=e.postPipelines).length;s<r;s++){var a;if((a=o[s])instanceof n&&a.name===t)return a}}(e,this.PostFxPipelineClass,n)}}var f=function(e){return null==e||""===e||0===e.length};return function(e,n,t,i){if(void 0===i&&(i="."),"object"==typeof e)if(f(n)){if(null==t)return;"object"==typeof t&&(e=t)}else{"string"==typeof n&&(n=n.split(i));var s=n.pop(),r=function(e,n,t){var i=e;if(f(n));else{var s;"string"==typeof n&&(n=n.split("."));for(var r=0,o=n.length;r<o;r++){var a;null!=i[s=n[r]]&&"object"==typeof i[s]||(a=r===o-1?void 0===t?{}:t:{},i[s]=a),i=i[s]}}return i}(e,n);r[s]=t}}(window,"RexPlugins.Pipelines.GrayScalePostFx",t),class extends p{constructor(e){super(e),this.setPostPipelineClass(t,"rexGrayScalePostFx")}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).rexgrayscalepipelineplugin=n();
