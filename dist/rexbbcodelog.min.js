!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexbbcodelog=e();}(undefined,(function(){function t(t,n,i){return n=u(n),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(t,e()?Reflect.construct(n,i||[],u(t).constructor):n.apply(t,i))}function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(t){}return (e=function(){return !!t})()}function n(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(t,"string");return "symbol"==typeof e?e:String(e)}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r);}}function o(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},f.apply(this,arguments)}function h(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var y={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1;}function s(t,e,i,s,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,s||t,o),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e];}function a(){this._events=new i,this._eventsCount=0;}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return [];if(i.fn)return [i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return !1;var u,l,c=this._events[a],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,i),!0;case 4:return c.fn.call(c.context,e,i,r),!0;case 5:return c.fn.call(c.context,e,i,r,s),!0;case 6:return c.fn.call(c.context,e,i,r,s,o),!0}for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u);}else {var h,p=c.length;for(l=0;l<p;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),f){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,e);break;case 3:c[l].fn.call(c[l].context,e,i);break;case 4:c[l].fn.call(c[l].context,e,i,r);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u);}}return !0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||o(this,s);else {for(var u=0,l=[],c=a.length;u<c;u++)(a[u].fn!==e||r&&!a[u].once||i&&a[u].context!==i)&&l.push(a[u]);l.length?this._events[s]=1===l.length?l[0]:l:o(this,s);}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a;}(y);var d=function(e){function n(){return r(this,n),t(this,n,arguments)}return a(n,e),o(n,[{key:"shutdown",value:function(){this.removeAllListeners();}},{key:"destroy",value:function(){this.removeAllListeners();}}]),n}(v(y.exports)),m={setEventEmitter:function(t,e){return void 0===e&&(e=d),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},g=function(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var i=e.split("."),r=t,s=n,o=0;o<i.length;o++){if(!r.hasOwnProperty(i[o])){s=n;break}s=r[i[o]],r=r[i[o]];}return s}return n}return n},E=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,b=/^0x[0-9A-F]+$/i,k=function(t){if("string"!=typeof t)return t;if(""===t)t=null;else if(E.test(t))t=parseFloat(t);else if(b.test(t))t=parseInt(t,16);else switch(t){case"false":t=!1;break;case"true":t=!0;break;case"null":t=null;break;case"undefined":t=void 0;}return t},_=function(t){return t.replace(x,"\\$&").replace(S,"\\x2d")},x=/[|\\{}()[\]^$+*?.]/g,S=/-/g,w=function(){function t(e){r(this,t),this.setEventEmitter(g(e,"eventEmitter",void 0)),this.setValueConverter(g(e,"valueConvert",!0)),this.setLoopEnable(g(e,"loop",!1)),this.setMultipleLinesTagEnable(g(e,"multipleLinesTag",!1));var n=g(e,"delimiters","<>");this.setDelimiters(n[0],n[1]),this.setTranslateTagNameCallback(g(e,"translateTagNameCallback")),this.isRunning=!1,this.isPaused=!1,this.skipEventFlag=!1,this.justCompleted=!1,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null;}return o(t,[{key:"shutdown",value:function(){this.destroyEventEmitter();}},{key:"destroy",value:function(){this.shutdown();}},{key:"setMultipleLinesTagEnable",value:function(t){return void 0===t&&(t=!0),this.multipleLinesTagEnable=t,this}},{key:"setDelimiters",value:function(t,e){void 0===e&&(e=t[1],t=t[0]),this.delimiterLeft=t,this.delimiterRight=e,t=_(this.delimiterLeft),e=_(this.delimiterRight);var n=this.multipleLinesTagEnable?"gs":"gi";return this.reSplit=RegExp("".concat(t,"(.+?)").concat(e),n),this}},{key:"setTranslateTagNameCallback",value:function(t){return this.translateTagNameCallback=t,this}},{key:"setValueConverter",value:function(t){return !0===t?t=k:t||(t=T),this.valueConverter=t,this}},{key:"setLoopEnable",value:function(t){return void 0===t&&(t=!0),this.loopEnable=t,this}},{key:"setSource",value:function(t){return this.source=t,this}},{key:"resetIndex",value:function(t){return void 0===t&&(t=0),this.progressIndex=t,this.reSplit.lastIndex=t,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null,this.justCompleted=!1,this.isRunning=!1,this}},{key:"start",value:function(t){return this.setSource(t).restart(),this}},{key:"restart",value:function(){this.resetIndex().next();}},{key:"next",value:function(){if(this.isPaused&&this.onResume(),this.isRunning)return this;if(this.isRunning=!0,this.justCompleted)return this.isRunning=!1,this;0===this.reSplit.lastIndex&&this.onStart();var t=this.source,e=t.length;for(this.reSplit.lastIndex=this.progressIndex;;){var n=this.reSplit.exec(t);if(!n){if(this.progressIndex<e&&(this.onContent(t.substring(this.progressIndex,e)),this.isPaused)){this.progressIndex=e;break}return this.onComplete(),void(this.isRunning=!1)}var i=this.reSplit.lastIndex,r=i-n[0].length;if(this.progressIndex<r&&(this.onContent(t.substring(this.progressIndex,r)),this.isPaused)){this.progressIndex=r;break}if(this.lastTagSource=n[0],this.onTag(n[1]),this.lastTagSource=void 0,this.progressIndex=i,this.isPaused)break}return this.isRunning=!1,this}},{key:"skipEvent",value:function(){return this.skipEventFlag=!0,this}},{key:"pause",value:function(){return this.isPaused||this.onPause(),this}},{key:"pauseUntilEvent",value:function(t,e){return this.isPaused||(this.pause(),t.once(e,(function(){this.next();}),this)),this}},{key:"onContent",value:function(t){this.skipEventFlag=!1,this.emit("content",t),this.lastContent=t;}},{key:"onTag",value:function(t){}},{key:"onStart",value:function(){this.isRunning=!0,this.emit("start",this);}},{key:"onComplete",value:function(){this.isRunning=!1,this.justCompleted=!0,this.emit("complete",this),this.loopEnable&&this.resetIndex();}},{key:"onPause",value:function(){this.isPaused=!0,this.emit("pause",this);}},{key:"onResume",value:function(){this.isPaused=!1,this.emit("resume",this);}}]),t}(),T=function(t){return t};Object.assign(w.prototype,m);var C=function(e){function n(e){var i;r(this,n),void 0===e&&(e={}),e.hasOwnProperty("multipleLinesTag")||(e.multipleLinesTag=!1),(i=t(this,n,[e])).setTagExpression(g(e,"regex.tag",void 0)),i.setValueExpression(g(e,"regex.value",void 0));var s=g(e,"delimiters","<>");return i.setDelimiters(s[0],s[1]),i}return a(n,e),o(n,[{key:"setTagExpression",value:function(t){return t||(t=O),this.tagExpression=t,this}},{key:"setValueExpression",value:function(t){return t||(t=O),this.valueExpression=t,this}},{key:"setDelimiters",value:function(t,e){f(u(n.prototype),"setDelimiters",this).call(this,t,e);var i="(".concat(this.tagExpression,")(=(").concat(this.valueExpression,"))?");if(this.reTag=RegExp(i,"i"),this.tagExpression!==O||this.valueExpression!==O){var r="".concat(this.tagExpression,"(=").concat(this.valueExpression,")?"),s="/".concat(this.tagExpression);t=_(this.delimiterLeft),e=_(this.delimiterRight);var o=this.multipleLinesTagEnable?"gs":"gi";this.reSplit=RegExp("".concat(t,"((").concat(r,")|(").concat(s,"))").concat(e),o);}return this}},{key:"onTag",value:function(t){var e=t.match(this.reTag),n=e[1],i="/"===n.charAt(0);if(i&&(n=n.substring(1,n.length)),this.translateTagNameCallback&&(n=this.translateTagNameCallback(n)),this.skipEventFlag=!1,i)this.emit("-".concat(n)),this.skipEventFlag||this.emit("-",n),this.lastTagEnd=n;else {var r=function(t,e,n){if(null==t)return [];void 0===e&&(e=k),void 0===n&&(n=",");for(var i=t.split(n),r=0,s=i.length;r<s;r++)i[r]=e(i[r]);return i}(e[3],this.valueConverter);this.emit.apply(this,["+".concat(n)].concat(h(r))),this.skipEventFlag||this.emit.apply(this,["+",n].concat(h(r))),this.lastTagStart=n;}}}]),n}(w),O="[^=]+",P=[function(t){t.on("+color",(function(e){t.addStyle("color",e),t.skipEvent();})).on("-color",(function(){t.removeStyle("color"),t.skipEvent();}));},function(t){t.on("+bgcolor",(function(e){t.addStyle("background-color",e),t.skipEvent();})).on("-bgcolor",(function(){t.removeStyle("background-color"),t.skipEvent();}));},function(t){t.on("+b",(function(){t.addStyle("font-weight","bold"),t.skipEvent();})).on("-b",(function(){t.removeStyle("font-weight"),t.skipEvent();}));},function(t){t.on("+i",(function(){t.addStyle("font-style","italic"),t.skipEvent();})).on("-i",(function(){t.removeStyle("font-style"),t.skipEvent();}));},function(t){t.on("+size",(function(e){"number"==typeof e&&(e="".concat(e,"px")),t.addStyle("font-size",e),t.skipEvent();})).on("-size",(function(){t.removeStyle("font-size"),t.skipEvent();}));},function(t){t.on("+u",(function(){t.addStyle("text-decoration","underline"),t.skipEvent();})).on("-u",(function(){t.removeStyle("text-decoration"),t.skipEvent();}));},function(t){t.on("+shadow",(function(e){t.addStyle("text-shadow","1px 1px 3px ".concat(e)),t.skipEvent();})).on("-shadow",(function(){t.removeStyle("text-shadow"),t.skipEvent();}));},function(t){t.on("+round",(function(e,n){void 0===e&&(e=3),void 0===n&&(n=e),"number"==typeof e&&(e="".concat(e,"px")),"number"==typeof n&&(n="".concat(n,"px")),t.addStyle("display","inline-block"),t.addStyle("border-radius",e),t.addStyle("padding",n),t.skipEvent();})).on("-round",(function(){t.removeStyle("display"),t.removeStyle("border-radius"),t.removeStyle("padding"),t.skipEvent();}));},function(t){t.on("+family",(function(e){t.addStyle("font-family",e),t.skipEvent();})).on("-family",(function(){t.removeStyle("font-family"),t.skipEvent();}));},function(t){t.on("content",(function(e){t.addContent(e),t.skipEvent();})).on("+",(function(){t.addContent(t.lastTagSource),t.skipEvent();})).on("-",(function(){t.addContent(t.lastTagSource),t.skipEvent();}));}],j=function(t,e){var n=Array.isArray(t);if(void 0===e?e=n?[]:{}:function(t){if("object"!==i(t)||null===t)return t;if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e];}(e),n){e.length=t.length;for(var r=0,s=t.length;r<s;r++)e[r]=t[r];}else for(var o in t)e[o]=t[o];return e},L=function(e){function n(e){var i;r(this,n),(i=t(this,n,[e])).segments=[],i.lastPropFlags={};for(var s=0,o=P.length;s<o;s++)P[s](c(i));return i}return a(n,e),o(n,[{key:"clearBuffers",value:function(){return this.segments.length=0,this.lastPropFlags={},this}},{key:"addStyle",value:function(t,e){return this.lastPropFlags[t]=e,this}},{key:"removeStyle",value:function(t){return delete this.lastPropFlags[t],this}},{key:"addContent",value:function(t){return this.segments.push(j(this.lastPropFlags)),this.segments.push(t),this}},{key:"parse",value:function(t){this.start(t);for(var e=[],n=0,r=this.segments.length;n<r;n++){var s=this.segments[n];if("string"==typeof s){var o=this.segments[n-1];"object"===i(o)?e.push({value:s,css:R(o)}):e.push({value:s,css:null});}}return this.clearBuffers(),e}}]),n}(C),R=function(t){var e=[];for(var n in t)e.push("".concat(n,":").concat(t[n]));return e.join(";")},A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.delimiters,i=void 0===n?"[]":n,s=e.enable,o=void 0===s||s;r(this,t),this.parser=new L({delimiters:i}),this.enable=o;}return o(t,[{key:"setEnable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.enable=t,this}},{key:"log",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";if(!this.enable)return this;if("string"==typeof t){var n,i=[],r=[];this.parser.parse(t).forEach((function(t){i.push("%c".concat(t.value)),r.push(t.css);})),(n=console[e]).call.apply(n,[console,i.join("")].concat(r));}else console[e](t);return this}}]),t}();return A}));
