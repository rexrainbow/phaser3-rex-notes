var t,e;t=void 0,e=function(){function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(t,e,s,r,o){if("function"!=typeof s)throw new TypeError("The listener must be a function");var a=new i(s,r||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,s,i=[];if(0===this._eventsCount)return i;for(s in t=this._events)e.call(t,s)&&i.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=n?n+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var i=0,r=s.length,o=new Array(r);i<r;i++)o[i]=s[i].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,s=this._events[e];return s?s.fn?1:s.length:0},a.prototype.emit=function(t,e,s,i,r,o){var a=n?n+t:t;if(!this._events[a])return!1;var l,h,u=this._events[a],p=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),p){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,s),!0;case 4:return u.fn.call(u.context,e,s,i),!0;case 5:return u.fn.call(u.context,e,s,i,r),!0;case 6:return u.fn.call(u.context,e,s,i,r,o),!0}for(h=1,l=new Array(p-1);h<p;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var v,c=u.length;for(h=0;h<c;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),p){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,s);break;case 4:u[h].fn.call(u[h].context,e,s,i);break;default:if(!l)for(v=1,l=new Array(p-1);v<p;v++)l[v-1]=arguments[v];u[h].fn.apply(u[h].context,l)}}return!0},a.prototype.on=function(t,e,n){return r(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return r(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,s,i){var r=n?n+t:t;if(!this._events[r])return this;if(!e)return o(this,r),this;var a=this._events[r];if(a.fn)a.fn!==e||i&&!a.once||s&&a.context!==s||o(this,r);else{for(var l=0,h=[],u=a.length;l<u;l++)(a[l].fn!==e||i&&!a[l].once||s&&a[l].context!==s)&&h.push(a[l]);h.length?this._events[r]=1===h.length?h[0]:h:o(this,r)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(e);var n=t(e.exports);class s extends n{shutdown(){this.removeAllListeners()}destroy(){this.removeAllListeners()}}var i={setEventEmitter(t,e){return void 0===e&&(e=s),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},r=function(t,e,n){if(!t||"number"==typeof t)return n;if("string"==typeof e){if(t.hasOwnProperty(e))return t[e];if(-1===e.indexOf("."))return n;e=e.split(".")}for(var s=e,i=t,r=n,o=0;o<s.length;o++){if(e=s[o],!i.hasOwnProperty(e)){r=n;break}i=r=i[e]}return r},o=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,a=/^0x[0-9A-F]+$/i,l=function(t){if("string"!=typeof t)return t;if(""===t)t=null;else if(o.test(t))t=parseFloat(t);else if(a.test(t))t=parseInt(t,16);else switch(t){case"false":t=!1;break;case"true":t=!0;break;case"null":t=null;break;case"undefined":t=void 0}return t},h=function(t){return t.replace(u,"\\$&").replace(p,"\\x2d")},u=/[|\\{}()[\]^$+*?.]/g,p=/-/g;let v=class{constructor(t){this.setEventEmitter(r(t,"eventEmitter",void 0)),this.setValueConverter(r(t,"valueConvert",!0)),this.setLoopEnable(r(t,"loop",!1)),this.setMultipleLinesTagEnable(r(t,"multipleLinesTag",!1));var e=r(t,"delimiters","<>");this.setDelimiters(e[0],e[1]),this.setTranslateTagNameCallback(r(t,"translateTagNameCallback")),this.isRunning=!1,this.isPaused=!1,this.skipEventFlag=!1,this.justCompleted=!1,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null}shutdown(){this.destroyEventEmitter()}destroy(){this.shutdown()}setMultipleLinesTagEnable(t){return void 0===t&&(t=!0),this.multipleLinesTagEnable=t,this}setDelimiters(t,e){void 0===e&&(e=t[1],t=t[0]),this.delimiterLeft=t,this.delimiterRight=e,t=h(this.delimiterLeft),e=h(this.delimiterRight);var n=this.multipleLinesTagEnable?"gs":"gi";return this.reSplit=RegExp(`${t}(.+?)${e}`,n),this}setTranslateTagNameCallback(t){return this.translateTagNameCallback=t,this}setValueConverter(t){return!0===t?t=l:t||(t=c),this.valueConverter=t,this}setLoopEnable(t){return void 0===t&&(t=!0),this.loopEnable=t,this}setSource(t){return this.source=t,this}resetIndex(t){return void 0===t&&(t=0),this.progressIndex=t,this.reSplit.lastIndex=t,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null,this.justCompleted=!1,this.isRunning=!1,this}start(t){return this.setSource(t).restart(),this}restart(){this.resetIndex().next()}next(){if(this.isPaused&&this.onResume(),this.isRunning)return this;if(this.isRunning=!0,this.justCompleted)return this.isRunning=!1,this;0===this.reSplit.lastIndex&&this.onStart();var t=this.source,e=t.length;for(this.reSplit.lastIndex=this.progressIndex;;){var n=this.reSplit.exec(t);if(!n){if(this.progressIndex<e&&(this.onContent(t.substring(this.progressIndex,e)),this.isPaused)){this.progressIndex=e;break}return this.onComplete(),void(this.isRunning=!1)}var s=this.reSplit.lastIndex,i=s-n[0].length;if(this.progressIndex<i&&(this.onContent(t.substring(this.progressIndex,i)),this.isPaused)){this.progressIndex=i;break}if(this.lastTagSource=n[0],this.onTag(n[1]),this.lastTagSource=void 0,this.progressIndex=s,this.isPaused)break}return this.isRunning=!1,this}skipEvent(){return this.skipEventFlag=!0,this}pause(){return this.isPaused||this.onPause(),this}pauseUntilEvent(t,e){return this.isPaused||(this.pause(),t.once(e,(function(){this.next()}),this)),this}onContent(t){this.skipEventFlag=!1,this.emit("content",t),this.lastContent=t}onTag(t){}onStart(){this.isRunning=!0,this.emit("start",this)}onComplete(){this.isRunning=!1,this.justCompleted=!0,this.emit("complete",this),this.loopEnable&&this.resetIndex()}onPause(){this.isPaused=!0,this.emit("pause",this)}onResume(){this.isPaused=!1,this.emit("resume",this)}};const c=function(t){return t};Object.assign(v.prototype,i);class f extends v{constructor(t){void 0===t&&(t={}),t.hasOwnProperty("multipleLinesTag")||(t.multipleLinesTag=!1),super(t),this.setTagExpression(r(t,"regex.tag",void 0)),this.setValueExpression(r(t,"regex.value",void 0));var e=r(t,"delimiters","<>");this.setDelimiters(e[0],e[1])}setTagExpression(t){return t||(t=d),this.tagExpression=t,this}setValueExpression(t){return t||(t=d),this.valueExpression=t,this}setDelimiters(t,e){super.setDelimiters(t,e);var n=`(${this.tagExpression})(=(${this.valueExpression}))?`;if(this.reTag=RegExp(n,"i"),this.tagExpression!==d||this.valueExpression!==d){var s=`${this.tagExpression}(=${this.valueExpression})?`,i=`/${this.tagExpression}`;t=h(this.delimiterLeft),e=h(this.delimiterRight);var r=this.multipleLinesTagEnable?"gs":"gi";this.reSplit=RegExp(`${t}((${s})|(${i}))${e}`,r)}return this}onTag(t){var e=t.match(this.reTag),n=e[1],s="/"===n.charAt(0);if(s&&(n=n.substring(1,n.length)),this.translateTagNameCallback&&(n=this.translateTagNameCallback(n)),this.skipEventFlag=!1,s)this.emit(`-${n}`),this.skipEventFlag||this.emit("-",n),this.lastTagEnd=n;else{var i=function(t,e,n){if(null==t)return[];void 0===e&&(e=l),void 0===n&&(n=",");for(var s=t.split(n),i=0,r=s.length;i<r;i++)s[i]=e(s[i]);return s}(e[3],this.valueConverter);this.emit(`+${n}`,...i),this.skipEventFlag||this.emit("+",n,...i),this.lastTagStart=n}}}const d="[^=]+";var m=[function(t){t.on("+color",(function(e){t.addStyle("color",e),t.skipEvent()})).on("-color",(function(){t.removeStyle("color"),t.skipEvent()}))},function(t){t.on("+bgcolor",(function(e){t.addStyle("background-color",e),t.skipEvent()})).on("-bgcolor",(function(){t.removeStyle("background-color"),t.skipEvent()}))},function(t){t.on("+b",(function(){t.addStyle("font-weight","bold"),t.skipEvent()})).on("-b",(function(){t.removeStyle("font-weight"),t.skipEvent()}))},function(t){t.on("+i",(function(){t.addStyle("font-style","italic"),t.skipEvent()})).on("-i",(function(){t.removeStyle("font-style"),t.skipEvent()}))},function(t){t.on("+size",(function(e){"number"==typeof e&&(e=`${e}px`),t.addStyle("font-size",e),t.skipEvent()})).on("-size",(function(){t.removeStyle("font-size"),t.skipEvent()}))},function(t){t.on("+u",(function(){t.addStyle("text-decoration","underline"),t.skipEvent()})).on("-u",(function(){t.removeStyle("text-decoration"),t.skipEvent()}))},function(t){t.on("+shadow",(function(e){t.addStyle("text-shadow",`1px 1px 3px ${e}`),t.skipEvent()})).on("-shadow",(function(){t.removeStyle("text-shadow"),t.skipEvent()}))},function(t){t.on("+round",(function(e,n){void 0===e&&(e=3),void 0===n&&(n=e),"number"==typeof e&&(e=`${e}px`),"number"==typeof n&&(n=`${n}px`),t.addStyle("display","inline-block"),t.addStyle("border-radius",e),t.addStyle("padding",n),t.skipEvent()})).on("-round",(function(){t.removeStyle("display"),t.removeStyle("border-radius"),t.removeStyle("padding"),t.skipEvent()}))},function(t){t.on("+family",(function(e){t.addStyle("font-family",e),t.skipEvent()})).on("-family",(function(){t.removeStyle("font-family"),t.skipEvent()}))},function(t){t.on("content",(function(e){t.addContent(e),t.skipEvent()})).on("+",(function(){t.addContent(t.lastTagSource),t.skipEvent()})).on("-",(function(){t.addContent(t.lastTagSource),t.skipEvent()}))}],g=function(t,e){var n=Array.isArray(t);if(void 0===e?e=n?[]:{}:function(t){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]}(e),n){e.length=t.length;for(var s=0,i=t.length;s<i;s++)e[s]=t[s]}else for(var r in t)e[r]=t[r];return e};class E extends f{constructor(t){super(t),this.segments=[],this.lastPropFlags={};for(var e=0,n=m.length;e<n;e++)m[e](this)}clearBuffers(){return this.segments.length=0,this.lastPropFlags={},this}addStyle(t,e){return this.lastPropFlags[t]=e,this}removeStyle(t){return delete this.lastPropFlags[t],this}addContent(t){return this.segments.push(g(this.lastPropFlags)),this.segments.push(t),this}parse(t){this.start(t);for(var e=[],n=0,s=this.segments.length;n<s;n++){var i=this.segments[n];if("string"==typeof i){var r=this.segments[n-1];"object"==typeof r?e.push({value:i,css:y(r)}):e.push({value:i,css:null})}}return this.clearBuffers(),e}}var y=function(t){var e=[];for(var n in t)e.push(`${n}:${t[n]}`);return e.join(";")};return class{constructor({delimiters:t="[]",enable:e=!0}={}){this.parser=new E({delimiters:t}),this.enable=e}setEnable(t=!0){return this.enable=t,this}log(t,e="log"){if(!this.enable)return this;if("string"==typeof t){var n=[],s=[];this.parser.parse(t).forEach((function(t){n.push(`%c${t.value}`),s.push(t.css)})),console[e].call(console,n.join(""),...s)}else console[e](t);return this}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexbbcodelog=e();
