var t,e;t=void 0,e=function(){var t={setEventEmitter(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter(){return this._eventEmitter},on(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},e={hasProperty(t){var e=this.gameObject;return!!e.hasOwnProperty(t)||void 0!==e[t]},getProperty(t){return this.gameObject[t]},setProperty(t,e){return this.gameObject[t]=e,this},easeProperty(t){var e=t.property,r=t.value,i=t.duration,n=t.delay,s=t.ease,o=t.repeat,a=t.yoyo,h=t.from,u=t.complete,c=t.target;if(void 0===i&&(i=1e3),void 0===n&&(n=0),void 0===s&&(s="Linear"),void 0===o&&(o=0),void 0===a&&(a=!1),void 0===c&&(c=this.gameObject),h){var l=r;r=c[e],c[e]=l}return(t={targets:c,duration:i,delay:n,ease:s,repeat:o,yoyo:a,onComplete:u})[e]=r,this.addTweenTask(e,t),this},addTweenTask(t,e){var r=this.tweens,i=r[t];i&&i.remove();var n=e.onComplete;return e.onComplete=function(){r[t].remove(),r[t]=null,n&&n(e.targets,t)},(i=this.scene.tweens.add(e)).timeScale=this.timeScale,r[t]=i,this},getTweenTask(t){return this.tweens[t]},freeTweens(){var t,e=this.tweens;for(var r in e)(t=e[r])&&t.remove(),e[r]=null;return this}},r={hasMethod(t){return"function"==typeof this.gameObject[t]},call(t,...e){if(!this.hasMethod(t))return console.warn(`[GameObjectManager] Game object '${this.name}' does not have method '${t}'`),this;var r=this.gameObject;return r[t].apply(r,e),this}},i={hasData(t){var e=this.gameObject;return!!e.data&&e.data.has(t)},getData(t){return this.gameObject.getData(t)},setData(t,e){return this.gameObject.setData(t,e),this}};class n{constructor(t,e,r){this.GOManager=t,this.tweens={},this.effects={},this.setGO(e,r)}get scene(){return this.GOManager.scene}get timeScale(){return this.GOManager.timeScale}destroy(){this.freeGO(),this.GOManager=void 0}freeGO(){return this.freeTweens(),this.gameObject.bob=void 0,this.gameObject.destroy(),this.gameObject=void 0,this}setGO(t,e){return t.goName=e,t.goType=this.GOManager.name,t.bob=this,this.gameObject=t,this.name=e,this.freeTweens(),this}setTimeScale(t){var e=this.tweens;for(var r in e){var i=e[r];i&&(i.timeScale=t)}return this}}Object.assign(n.prototype,e,r,i);var s=function(t){return t&&"!"!==t.charAt(0)},o={has(t){return this.bobs.hasOwnProperty(t)},exists(t){return this.bobs.hasOwnProperty(t)},get(t,e){if(s(t))return this.bobs[t];for(var r in void 0===e&&(e=[]),t&&(t=t.substring(1)),this.bobs)t&&r===t||e.push(this.bobs[r]);return e},getFitst(t){for(var e in t&&"!"===t.charAt(0)&&(t=t.substring(1)),this.bobs)if(!t||t!==e)return this.bobs[e];return null},getGO(t,e){var r=this.get(t);return r?Array.isArray(r)?(void 0===e&&(e=[]),r.forEach((function(t){e.push(t.gameObject)})),e):r.gameObject:null},forEachGO(t,e){for(var r in this.bobs){var i=this.bobs[r].gameObject;if(e?t.call(e,i,r,this):t(i,r,this))break}return this},getAllGO(t){for(var e in void 0===t&&(t=[]),this.bobs){var r=this.bobs[e].gameObject;t.push(r)}return t}},a=function(t){return t>>16&255},h=function(t){return t>>8&255},u=function(t){return 255&t};const c=Phaser.Events.EventEmitter;var l=function(t,e,r,i,n,s){return void 0===s?s={}:!0===s&&(s=f),"number"!=typeof r&&(r=0,i=0),s.x=n.x+n.width*t+r,s.y=n.y+n.height*e+i,s},f={},d=function(t,e,r,i,n,s,o){if(t.hasOwnProperty("vp"))return t;"function"==typeof r&&(o=r,r=void 0),"function"==typeof n&&(o=n,n=void 0),void 0===r&&(r=.5),void 0===i&&(i=.5),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=l),function(t){if(t.events)return t;var e=new c,r=t.x;Object.defineProperty(t,"x",{get:function(){return r},set:function(i){r!==i&&(r=i,e.emit("update",t))}});var i=t.y;Object.defineProperty(t,"y",{get:function(){return i},set:function(r){i!==r&&(i=r,e.emit("update",t))}});var n=t.width;Object.defineProperty(t,"width",{get:function(){return n},set:function(r){n!==r&&(n=r,e.emit("update",t))}});var s=t.height;Object.defineProperty(t,"height",{get:function(){return s},set:function(r){s!==r&&(s=r,e.emit("update",t))}}),t.events=e}(e);var a=e.events;t.vp=e;var h=function(){o(r,i,n,s,e,t)};a.on("update",h),t.once("destroy",(function(){a.off("update",h),t.vp=void 0})),Object.defineProperty(t,"vpx",{get:function(){return r},set:function(t){r!==t&&(r=t,h())}}),Object.defineProperty(t,"vpy",{get:function(){return i},set:function(t){i!==t&&(i=t,h())}}),Object.defineProperty(t,"vpxOffset",{get:function(){return n},set:function(t){n!==t&&(n=t,h())}}),Object.defineProperty(t,"vpyOffset",{get:function(){return s},set:function(t){s!==t&&(s=t,h())}}),h()},v=function(t,e){if(!t)return!1;if(t.hasOwnProperty(e))return!0;for(;t;){if(Object.getOwnPropertyDescriptor(t,e))return!0;t=t.__proto__}return!1},p=function(t,e){return void 0===e&&(e=!1),t.filters||t.enableFilters().focusFilters(),e?t.filters.external:t.filters.internal},y=function(t,e){t._effectSwitchNames||(t._effectSwitchNames=[],t.clearAllEffects=function(){for(var e=t._effectSwitchNames,r=0,i=e.length;r<i;r++)t[e[r]]=null;return t},t.on("destroy",t.clearAllEffects,t)),t._effectSwitchNames.push(e)},m=function(t,e,r){if(v(t,e))return t;var i,n=p(t),s=`_${e}Effect`;return Object.defineProperty(t,e,{get:function(){return i},set:function(o){i!==o&&(null===(i=o)||!1===i?t[s]&&(n.remove(t[s]),t[s]=void 0):(t[s]||(t[s]=n.addColorMatrix()),t[s].colorMatrix[e](1===r?o:void 0)))}}),t[e]=null,y(t,e),t};const g={barrel:function(t){if(v(t,"barrel"))return t;var e,r=p(t);return Object.defineProperty(t,"barrel",{get:function(){return e},set:function(i){e!==i&&(null===(e=i)||!1===e?t._barrelEffect&&(r.remove(t._barrelEffect),t._barrelEffect=void 0):(t._barrelEffect||(t._barrelEffect=r.addBarrel()),t._barrelEffect.amount=e))}}),t.barrel=null,y(t,"barrel"),t},blackWhite:function(t){return m(t,"blackWhite"),t},blur:function(t){if(v(t,"blurColor"))return t;var e,r=p(t),i=0,n=1,s=1,o=1,a=4;return Object.defineProperty(t,"blurColor",{get:function(){return e},set:function(h){e!==h&&(null===(e=h)||!1===e?t._blur&&(r.remove(t._blur),t._blur=void 0):(t._blur||(t._blur=r.addBlur(i,n,s,o,e,a)),t._blur.color=e))}}),Object.defineProperty(t,"blurQuality",{get:function(){return i},set:function(e){i!==e&&(i=e,t._blur&&(t._blur.quality=i))}}),Object.defineProperty(t,"blurX",{get:function(){return n},set:function(e){n!==e&&(n=e,t._blur&&(t._blur.x=n))}}),Object.defineProperty(t,"blurY",{get:function(){return s},set:function(e){s!==e&&(s=e,t._blur&&(t._blur.y=s))}}),Object.defineProperty(t,"blurStrength",{get:function(){return o},set:function(e){o!==e&&(o=e,t._blur&&(t._blur.strength=o))}}),Object.defineProperty(t,"blurSteps",{get:function(){return a},set:function(e){a!==e&&(a=e,t._blur&&(t._blur.steps=a))}}),t.blurColor=null,y(t,"blurColor"),t},bokeh:function(t){if(v(t,"bokehRadius"))return t;var e,r=p(t),i=1,n=.2;return Object.defineProperty(t,"bokehRadius",{get:function(){return e},set:function(s){e!==s&&(null===(e=s)||!1===e?t._bokeh&&(r.remove(t._bokeh),t._bokeh=void 0):(t._bokeh||(t._bokeh=r.addBokeh(e,i,n)),t._bokeh.radius=e))}}),Object.defineProperty(t,"bokehAmount",{get:function(){return i},set:function(e){i!==e&&(i=e,t._bokeh&&(t._bokeh.amount=i))}}),Object.defineProperty(t,"bokehContrast",{get:function(){return n},set:function(e){n!==e&&(n=e,t._bokeh&&(t._bokeh.contrast=n))}}),t.bokehRadius=null,y(t,"bokehRadius"),t},brightness:function(t){return m(t,"brightness",1),t},brown:function(t){return m(t,"brown"),t},contrast:function(t){return m(t,"contrast",1),t},desaturate:function(t){return m(t,"desaturate",1),t},desaturateLuminance:function(t){return m(t,"desaturateLuminance"),t},displacement:function(t){if(v(t,"displacementKey"))return t;var e,r=p(t),i=.005,n=.005;return Object.defineProperty(t,"displacementKey",{get:function(){return e},set:function(s){e!==s&&(null===(e=s)||!1===e?t._displacement&&(r.remove(t._displacement),t._displacement=void 0):(t._displacement||(t._displacement=r.addDisplacement(e,i,n)),t._displacement.setTexture(e)))}}),Object.defineProperty(t,"displacementX",{get:function(){return i},set:function(e){i!==e&&(i=e,t._displacement&&(t._displacement.x=i))}}),Object.defineProperty(t,"displacementY",{get:function(){return n},set:function(e){n!==e&&(n=e,t._displacement&&(t._displacement.y=n))}}),t.displacementKey=null,y(t,"displacementKey"),t},glow:function(t){if(v(t,"glowColor"))return t;var e,r=p(t),i=4,n=0;return Object.defineProperty(t,"glowColor",{get:function(){return e},set:function(s){e!==s&&(null===(e=s)||!1===e?t._glow&&(r.remove(t._glow),t._glow=void 0):(t._glow||(t._glow=r.addGlow(e,i,n)),t._glow.color=e))}}),Object.defineProperty(t,"glowOuterStrength",{get:function(){return i},set:function(e){i!==e&&(i=e,t._glow&&(t._glow.outerStrength=i))}}),Object.defineProperty(t,"glowInnerStrength",{get:function(){return n},set:function(e){n!==e&&(n=e,t._glow&&(t._glow.innerStrength=n))}}),t.glowColor=null,y(t,"glowColor"),t},grayscale:function(t){return m(t,"grayscale",1),t},hue:function(t){return m(t,"hue",1),t},kodachrome:function(t){return m(t,"kodachrome"),t},lsd:function(t){return m(t,"lsd"),t},negative:function(t){return m(t,"negative"),t},pixelate:function(t){if(v(t,"pixelate"))return t;var e,r=p(t);return Object.defineProperty(t,"pixelate",{get:function(){return e},set:function(i){e!==i&&(null===(e=i)||!1===e?t._pixelateEffect&&(r.remove(t._pixelateEffect),t._pixelateEffect=void 0):(t._pixelateEffect||(t._pixelateEffect=r.addPixelate()),t._pixelateEffect.amount=e))}}),t.pixelate=null,y(t,"pixelate"),t},polaroid:function(t){return m(t,"polaroid"),t},saturate:function(t){return m(t,"saturate",1),t},sepia:function(t){return m(t,"sepia"),t},shadow:function(t){if(v(t,"shadowColor"))return t;var e,r=p(t),i=0,n=0,s=.1,o=1,a=6,h=1;return Object.defineProperty(t,"shadowColor",{get:function(){return e},set:function(u){e!==u&&(null===(e=u)||!1===e?t._shadow&&(r.remove(t._shadow),t._shadow=void 0):(t._shadow||(t._shadow=r.addShadow(i,n,s,o,e,a,h)),t._shadow.color=e))}}),Object.defineProperty(t,"shadowX",{get:function(){return i},set:function(e){i!==e&&(i=e,t._shadow&&(t._shadow.x=i))}}),Object.defineProperty(t,"shadowY",{get:function(){return n},set:function(e){n!==e&&(n=e,t._shadow&&(t._shadow.y=n))}}),Object.defineProperty(t,"decay",{get:function(){return s},set:function(e){s!==e&&(s=e,t._shadow&&(t._shadow.decay=s))}}),Object.defineProperty(t,"shadowPower",{get:function(){return o},set:function(e){o!==e&&(o=e,t._shadow&&(t._shadow.power=o))}}),Object.defineProperty(t,"shadowSamples",{get:function(){return a},set:function(e){a!==e&&(a=e,t._shadow&&(t._shadow.samples=a))}}),Object.defineProperty(t,"shadowIntensity",{get:function(){return h},set:function(e){h!==e&&(h=e,t._shadow&&(t._shadow.intensity=h))}}),t.shadowColor=null,y(t,"shadowColor"),t},shiftToBGR:function(t){return m(t,"shiftToBGR"),t},technicolor:function(t){return m(t,"technicolor"),t},tiltShift:function(t){if(v(t,"tiltShiftRadius"))return t;var e,r=p(t),i=1,n=.2,s=1,o=1,a=1;return Object.defineProperty(t,"tiltShiftRadius",{get:function(){return e},set:function(h){e!==h&&(null===(e=h)||!1===e?t._tiltShift&&(r.remove(t._tiltShift),t._tiltShift=void 0):(t._tiltShift||(t._tiltShift=r.addTiltShift(e,i,n,s,o,a)),t._tiltShift.radius=e))}}),Object.defineProperty(t,"tiltShiftAmount",{get:function(){return i},set:function(e){i!==e&&(i=e,t._tiltShift&&(t._tiltShift.amount=i))}}),Object.defineProperty(t,"tiltShiftContrast",{get:function(){return n},set:function(e){n!==e&&(n=e,t._tiltShift&&(t._tiltShift.contrast=n))}}),Object.defineProperty(t,"tiltShiftBlurX",{get:function(){return s},set:function(e){s!==e&&(s=e,t._tiltShift&&(t._tiltShift.blurX=s))}}),Object.defineProperty(t,"tiltShiftBlurY",{get:function(){return o},set:function(e){o!==e&&(o=e,t._tiltShift&&(t._tiltShift.blurY=o))}}),Object.defineProperty(t,"tiltShiftStrength",{get:function(){return a},set:function(e){a!==e&&(a=e,t._tiltShift&&(t._tiltShift.strength=a))}}),t.tiltShiftRadius=null,y(t,"tiltShiftRadius"),t},vintagePinhole:function(t){return m(t,"vintagePinhole"),t}};var b=function(t,e){if(void 0===e)e=!0;else if("string"==typeof e)e={config:!0};else if(Array.isArray(e))for(var r=e,i=(e={},0),n=r.length;i<n;i++)e[r[i]]=!0;if(!0===e)for(var s in g)g[s](t);else for(var s in e)e[s]&&g[s]&&g[s](t);return t};const O=Phaser.Utils.Array.Remove;var _={addGO(t,e){this.remove(t,!0),this.useTintFadeEffect(e)&&function(t,e){if(t.hasOwnProperty("tintR"))return t;void 0===e&&(e=16777215);var r=a(e),i=h(e),n=u(e);Object.defineProperty(t,"tint",{get:function(){return e},set:function(s){s=16777215&Math.floor(s),t.setTint&&t.setTint(s),e!==s&&(r=a(e=s),i=h(e),n=u(e))}}),Object.defineProperty(t,"tintR",{get:function(){return r},set:function(i){i=255&Math.floor(i),r!==i&&(r=i,t.tint=(255&i)<<16|65535&e)}}),Object.defineProperty(t,"tintG",{get:function(){return i},set:function(r){r=255&Math.floor(r),i!==r&&(i=r,t.tint=(255&r)<<8|16711935&e)}}),Object.defineProperty(t,"tintB",{get:function(){return n},set:function(r){r=255&Math.floor(r),n!==r&&(n=r,t.tint=255&r|16776960&e)}}),Object.defineProperty(t,"tintGray",{get:function(){return Math.floor((r+i+n)/3)},set:function(e){e=255&Math.floor(e),r===e&&i===e&&n===e||(r=e,i=e,n=e,t.tint=(255&e)<<16|(255&e)<<8|255&e)}}),t.tint=e}(e),this.viewportCoordinateEnable&&d(e,this.viewport),this.effectPropertiesConfig&&b(e,this.effectPropertiesConfig),e.setName(t).once("destroy",(function(){O(this.removedGOs,e),this.isEmpty&&this.emit("empty")}),this);var r=new this.BobClass(this,e,t);return this.bobs[t]=r,this},add(t,...e){var r=this.createGameObjectCallback,i=this.createGameObjectScope,n=r.call(i,this.scene,...e);this.addGO(t,n),null!=this.gameObjectDepth&&n.setDepth(this.gameObjectDepth);var s=this.get(t);return this.fadeBob(s,0,1),this}},w={remove(t,e){var r=this.get(t);if(!r)return this;Array.isArray(r)||(r=[r]);var i=this;return r.forEach((function(t){delete i.bobs[t.name];var r=t.gameObject;i.removedGOs.push(r),r.setName(),e?t.destroy():i.fadeBob(t,void 0,0,(function(){t.destroy()}))})),this},removeAll(){var t=this.bobs;for(var e in t)this.remove(e);return this},clear(t){void 0===t&&(t=!0);var e=this.bobs;for(var r in e)t&&e[r].destroy(),delete e[r];return this.removedGOs.length=0,this}},P={hasProperty(t,e){var r=s(t)?this.get(t):this.getFitst(t);return!!r&&r.hasProperty(e)},getProperty(t,e){var r=s(t)?this.get(t):this.getFitst(t);if(r)return r.getProperty(e)},isNumberProperty(t,e){return"number"==typeof this.getProperty(t,e)},setProperty(t,e,r){var i=this.get(t);return i?(Array.isArray(i)||(i=[i]),this.symbols&&"string"==typeof r&&this.isNumberProperty(t,e)&&(r in this.symbols?r=this.symbols[r]:console.warn(`Can't find symbol ${r}`)),i.forEach((function(t){t.setProperty(e,r)})),this):this},easeProperty(t,e){var r=this.get(t);if(!r)return this;Array.isArray(r)||(r=[r]);var i=e.value,n=e.property;return this.symbols&&"string"==typeof i&&this.isNumberProperty(t,n)&&i in this.symbols&&(e.value=this.symbols[i]),r.forEach((function(t){t.easeProperty(e)})),this},hasTweenTask(t,e){var r=s(t)?this.get(t):this.getFitst(t);return!!r&&r.tweens.hasOwnProperty(e)},getTweenTask(t,e){var r=s(t)?this.get(t):this.getFitst(t);return r&&r.tweens[e]||null}},j={hasMethod(t,e){var r=s(t)?this.get(t):this.getFitst(t);return!!r&&r.hasMethod(e)},call(t,e,...r){var i=this.get(t);return i?(Array.isArray(i)||(i=[i]),i.forEach((function(t){t.call(e,...r)})),this):this}},E={hasData(t,e){var r=s(t)?this.get(t):this.getFitst(t);return!!r&&r.hasData(e)},getData(t,e){if(this.has(t))return this.get(t).getData(e)},setData(t,e,r){var i=this.get(t);return i?(Array.isArray(i)||(i=[i]),i.forEach((function(t){t.setData(e,r)})),this):this}};const C={tint:0,alpha:1,revealUp:2,revealDown:3,revealLeft:4,revealRight:5};var L={setGOFadeMode(t){return"string"==typeof t&&(t=C[t]),this.fadeMode=t,this},setGOFadeTime(t){return this.fadeTime=t,this},useTintFadeEffect(t){return(void 0===this.fadeMode||0===this.fadeMode)&&this.fadeTime>0&&void 0!==t.setTint},useAlphaFadeEffect(t){return(void 0===this.fadeMode||1===this.fadeMode)&&this.fadeTime>0&&void 0!==t.setAlpha},useRevealEffect(t){return this.fadeMode>=2&&this.fadeMode<=5&&this.fadeTime>0&&(t.preFX||t.postFX)},fadeBob(t,e,r,i){var n=t.gameObject;if(this.useTintFadeEffect(n))void 0!==e&&t.setProperty("tintGray",255*e),t.easeProperty({property:"tintGray",value:Math.floor(255*r),duration:this.fadeTime,delay:0,ease:"Linear",repeat:0,yoyo:!1,from:!1,complete:i});else if(this.useAlphaFadeEffect(n))void 0!==e&&t.setProperty("alpha",e),t.easeProperty({property:"alpha",value:r,duration:this.fadeTime,delay:0,ease:"Linear",repeat:0,yoyo:!1,from:!1,complete:i});else if(this.useRevealEffect(n)){var s;switch(b(n,"reveal"),this.fadeMode){case 2:s="revealUp";break;case 3:s="revealDown";break;case 4:s="revealLeft";break;case 5:s="revealRight"}void 0===e&&(e=0),n[s]=e,t.easeProperty({property:s,value:r,duration:this.fadeTime,delay:0,ease:"Linear",repeat:0,yoyo:!1,from:!1,complete:i}),t.getTweenTask(s).once("complete",(function(){n[s]=null}))}else i&&i(n);return this}},S=function(t){return void 0!==t.displayWidth?t.displayWidth:t.width},T=function(t){return void 0!==t.displayHeight?t.displayHeight:t.height};Phaser.Geom.Rectangle;const G=Phaser.Math.Vector2,x=Phaser.Math.RotateAround;Phaser.GameObjects.Container;var k=void 0,A=function(t,e,r){return void 0===r&&(r=!1),0!==t.rotation&&x(e,t.x,t.y,t.rotation),r&&t.parentContainer&&t.parentContainer.getBoundsTransformMatrix().transformPoint(e.x,e.y,e),e};const M=Phaser.Utils.Objects.GetValue;var F=function(t,e,r,i,n,s,o){if(t.getBounds||void 0!==t.width&&void 0!==t.height){void 0===r&&(r=16777215),void 0===i&&(i=1),void 0===n&&(n=null),void 0===s&&(s=1),void 0===o&&(o=0);var a=function(t,e,r){return void 0===e?e=new G:!0===e&&(void 0===k&&(k=new G),e=k),t.getTopLeft?t.getTopLeft(e):(e.x=t.x-S(t)*t.originX,e.y=t.y-T(t)*t.originY,A(t,e,r))}(t,B[0]);a.x-=o,a.y-=o;var h=function(t,e,r){return void 0===e?e=new G:!0===e&&(void 0===k&&(k=new G),e=k),t.getTopRight?t.getTopRight(e):(e.x=t.x-S(t)*t.originX+S(t),e.y=t.y-T(t)*t.originY,A(t,e,r))}(t,B[1]);h.x+=o,h.y-=o;var u=function(t,e,r){return void 0===e?e=new G:!0===e&&(void 0===k&&(k=new G),e=k),t.getBottomRight?t.getBottomRight(e):(e.x=t.x-S(t)*t.originX+S(t),e.y=t.y-T(t)*t.originY+T(t),A(t,e,r))}(t,B[2]);u.x+=o,u.y+=o;var c=function(t,e,r){return void 0===e?e=new G:!0===e&&(void 0===k&&(k=new G),e=k),t.getBottomLeft?t.getBottomLeft(e):(e.x=t.x-S(t)*t.originX,e.y=t.y-T(t)*t.originY+T(t),A(t,e,r))}(t,B[3]);c.x-=o,c.y+=o,null!==n&&e.fillStyle(n,s).fillPoints(B,!0,!0),null!==r&&e.lineStyle(i,r).strokePoints(B,!0,!0)}},B=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],R=function(t,e){var r,i=t.cameras;if(void 0===e)r=i.main;else switch(typeof e){case"string":r=i.getCamera(e);break;case"number":r=i.cameras[e];break;default:r=e}return r},D={setCamera(t,e){var r=this.get(t);if(!r)return this;var i=R(this.scene,e);return i?(r.gameObject.cameraFilter=4294967295^i.id,r.camera=i,this):this},getCamera(t){var e=this.get(t);return e?e.camera:null}},N={drawGameObjectsBounds:function(t,e){return this.forEachGO((function(r){r.drawBounds?r.drawBounds(t,e):function(t,e,r){var i,n,s,o,a;if("number"==typeof r?i=r:(i=M(r,"color"),n=M(r,"lineWidth"),s=M(r,"fillColor"),o=M(r,"fillAlpha",1),a=M(r,"padding",0)),Array.isArray(t))for(var h=0,u=t.length;h<u;h++)F(t[h],e,i,n,s,o,a);else F(t,e,i,n,s,o,a)}(r,t,e)})),this}};Object.assign(N,o,_,w,P,j,E,L,D);const X=Phaser.Cameras.Scene2D.BaseCamera,Y=Phaser.Geom.Rectangle;var V=function(t,e,r){return e instanceof X||(r=e,e=void 0),void 0===r?r=new Y:!0===r&&(r=U),e?t.scale.getViewPort(e,r):t.scale.getViewPort(r)},U=new Y;const $=Phaser.Utils.Objects.GetValue;class W{constructor(t,e){this.scene=t,this.BobClass=$(e,"BobClass",n),this.setCreateGameObjectCallback($(e,"createGameObject"),$(e,"createGameObjectScope")),this.setEventEmitter($(e,"eventEmitter",void 0)),this.setGameObjectDepth($(e,"depth",void 0));var r=$(e,"fade",500);"number"==typeof r?(this.setGOFadeMode(),this.setGOFadeTime(r)):(this.setGOFadeMode($(r,"mode")),this.setGOFadeTime($(r,"time",500)));var i=$(e,"viewportCoordinate",!1);!1!==i?(this.setViewportCoordinateEnable($(e,"enable",!0)),this.setViewport($(i,"viewport"))):this.setViewportCoordinateEnable(!1);var s=$(e,"effectProperties",!1);this.setEffectPropertiesConfig(s),this.setSymbols($(e,"symbols")),this.bobs={},this.removedGOs=[],this._timeScale=1,this.name=$(e,"name")}destroy(t){this.clear(!t),this.createGameObjectCallback=void 0,this.viewport=void 0,this.scene=void 0}set timeScale(t){if(this._timeScale!==t){this._timeScale=t;var e=this.bobs;for(var r in e)e[r].setTimeScale(t)}}get timeScale(){return this._timeScale}setTimeScale(t){return this.timeScale=t,this}setCreateGameObjectCallback(t,e){return this.createGameObjectCallback=t,this.createGameObjectScope=e,this}setGameObjectDepth(t){return this.gameObjectDepth=t,this}setViewportCoordinateEnable(t){return void 0===t&&(t=!0),this.viewportCoordinateEnable=t,this}setEffectPropertiesConfig(t){return void 0===t&&(t=!0),this.effectPropertiesConfig=t,this}setViewport(t){return void 0===t&&(t=V(this.scene,this.scene.cameras.main)),this.viewport=t,this}setSymbols(t){return this.symbols=t,this}get isEmpty(){return function(t){for(var e in t)return!1;return!0}(this.bobs)&&0===this.removedGOs.length}}Object.assign(W.prototype,t,N);const K=Phaser.GameObjects.GameObject,H=Phaser.GameObjects.Layer,I=Phaser.GameObjects.Layer;var q=function(t){var e=t.displayList;return function(t){return t instanceof I}(e)?e:null},Q={getLayer(t){return this.getGO(t)},getLayers(t){return void 0===t&&(t=[]),this.forEachGO((function(e){t.push(e)})),function(t,e){if(t.length<=1)return t;var r;void 0===e&&(e=!1);for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.displayList?r=s.displayList:s.parentContainer&&(r=s.parentContainer.list),r)break}r||(r=s.scene.sys.displayList),r.depthSort&&(r.depthSort(),r=r.list),e?t.sort((function(t,e){return r.indexOf(e)-r.indexOf(t)})):t.sort((function(t,e){return r.indexOf(t)-r.indexOf(e)}))}(t,!1),t},addToLayer(t,e){var r=this.getGO(t);if(r){Array.isArray(e)||(e=[e]);for(var i=0,n=e.length;i<n;i++){var s=e[i];s.isRexContainerLite?s.addToLayer(r):r.add(s)}return void 0!==r.scrollFactorX&&s.setScrollFactor(r.scrollFactorX,r.scrollFactorY),this}console.warn(`[LayerManager] Can't get layer "${t}"`)},addToBottomLayer(t){var e=this.getLayers()[0];return this.addToLayer(e.goName,t),this},addToTopLayer(t){var e=this.getLayers(),r=e[e.length-1];return this.addToLayer(r.goName,t),this},removeFromLayer(t,e,r){var i=this.getGO(t);if(i)return void 0===r&&(r=!0),e.isRexContainerLite?e.removeFromLayer(i,r):(i.remove(e),r&&e.addToDisplayList()),this;console.warn(`[LayerManager] Can't get layer "${t}"`)},clearLayer(t,e){void 0===e&&(e=!0);var r=this.getGO(t);if(r){if(e)for(var i=r.getAll(),n=0,s=i.length;n<s;n++)i[n].destroy();else r.removeAll();return this}console.warn(`Can't get layer "${t}"`)}},z={setScrollFactor(t,e,r){void 0===r&&(r=e);var i=this.getLayer(t);if(!i)return this;i.scrollFactorX=e,i.scrollFactorY=r;for(var n=i.getAll(),s=0,o=n.length;s<o;s++)n[s].setScrollFactor(e,r);return this}};const J=Phaser.Utils.Array;var Z={bringMeToTop:function(){var t;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t?(J.BringToTop(t,this),this):this},sendMeToBack:function(){var t;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t?(J.SendToBack(t,this),this):this},moveMyDepthBelow:function(t){var e;return t.parentContainer?-1===(e=t.parentContainer.list).indexOf(this)&&t.parentContainer.add(this):t.displayList&&-1===(e=t.displayList.list).indexOf(this)&&t.displayList.add(this),e?(J.MoveBelow(e,this,t),this):this},moveMyDepthAbove:function(t){var e;return t.parentContainer?-1===(e=t.parentContainer.list).indexOf(this)&&(t.isRexContainerLite?t.addToContainer(t.parentContainer):t.parentContainer.add(t)):t.displayList&&-1===(e=t.displayList.list).indexOf(this)&&(t.isRexContainerLite?t.addToLayer(t.displayList):t.displayList.add(t)),e?(J.MoveAbove(e,this,t),this):this}},tt={bringLayerToTop(t){var e=this.getLayer(t);return e?(Z.bringMeToTop.call(e),this):this},sendLayerToBack(t){var e=this.getLayer(t);return e?(Z.sendMeToBack.call(e),this):this},moveLayerBelow(t,e){if(t===e)return this;var r=this.getLayer(t),i=this.getLayer(e);return r&&i?(Z.moveMyDepthBelow.call(r,i),this):this},moveLayerAbove(t,e){if(t===e)return this;var r=this.getLayer(t),i=this.getLayer(e);return r&&i?(Z.moveMyDepthAbove.call(r,i),this):this}};const et=W.prototype.setCamera;var rt={setCamera(t,e){var r=R(this.scene,e);return r||(r=this.scene.cameras.add(void 0,void 0,void 0,void 0,!1,e)),et.call(this,t,r),this}},it={};Object.assign(it,Q,z,tt,rt);const nt=Phaser.Utils.Objects.GetValue;class st extends W{constructor(t,e){void 0===e?e={}:Array.isArray(e)&&(e={layers:e}),e.hasOwnProperty("fade")||(e.fade=0),e.viewportCoordinate=!1,super(t,e);var r=nt(e,"rootLayer");this.setRootLayer(r);var i=nt(e,"layers");if(i)for(var n=0,s=i.length;n<s;n++){var o=i[n];if("string"==typeof o)this.add(o);else{var a=o.name;this.add(a);var h=o.scrollFactor,u=nt(o,"scrollFactorX",h),c=nt(o,"scrollFactorY",h);void 0!==u&&this.setScrollFactor(a,u,c),this.setCamera(a,o.cameraName)}}}setCreateGameObjectCallback(t,e){return t||(t=ot),super.setCreateGameObjectCallback(t,e),this}setRootLayer(t){if(t===this.rootLayer)return this;var e=this.getAllGO();return t?t.add(e):this.scene.displayList.add(e),this.rootLayer=t,this}addGO(t,e){return super.addGO(t,e),e.name=t,this.rootLayer&&this.rootLayer.add(e),this}get(t,e){if((i=t)instanceof K||i instanceof H){var r=q(t);if(!r)return;if(!(t=r.name))return}var i;return super.get(t,e)}}var ot=function(t,e){var r=t.add.layer();return void 0!==e&&r.setDepth(e),r};Object.assign(st.prototype,it);class at extends Phaser.Plugins.BasePlugin{constructor(t){super(t)}start(){this.game.events.on("destroy",this.destroy,this)}add(t,e){return new st(t,e)}}return at},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexlayermanagerplugin=e();
