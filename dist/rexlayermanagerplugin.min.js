var e,t;e=void 0,t=function(){var e={setEventEmitter(e,t){return void 0===t&&(t=Phaser.Events.EventEmitter),this._privateEE=!0===e||void 0===e,this._eventEmitter=this._privateEE?new t:e,this},destroyEventEmitter(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter(){return this._eventEmitter},on(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit(e){return this._eventEmitter&&e&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},t={hasProperty(e){var t=this.gameObject;return!!t.hasOwnProperty(e)||void 0!==t[e]},getProperty(e){return this.gameObject[e]},setProperty(e,t){return this.gameObject[e]=t,this},easeProperty(e){var t=e.property,r=e.value,n=e.duration,i=e.delay,o=e.ease,s=e.repeat,a=e.yoyo,l=e.from,c=e.complete,f=e.target;if(void 0===n&&(n=1e3),void 0===i&&(i=0),void 0===o&&(o="Linear"),void 0===s&&(s=0),void 0===a&&(a=!1),void 0===f&&(f=this.gameObject),l){var h=r;r=f[t],f[t]=h}return(e={targets:f,duration:n,delay:i,ease:o,repeat:s,yoyo:a,onComplete:c})[t]=r,this.addTweenTask(t,e),this},addTweenTask(e,t){var r=this.tweens,n=r[e];n&&n.remove();var i=t.onComplete;return t.onComplete=function(){r[e].remove(),r[e]=null,i&&i(t.targets,e)},(n=this.scene.tweens.add(t)).timeScale=this.timeScale,r[e]=n,this},getTweenTask(e){return this.tweens[e]},freeTweens(){var e,t=this.tweens;for(var r in t)(e=t[r])&&e.remove(),t[r]=null;return this}},r={hasMethod(e){return"function"==typeof this.gameObject[e]},call(e,...t){if(!this.hasMethod(e))return console.warn(`[GameObjectManager] Game object '${this.name}' does not have method '${e}'`),this;var r=this.gameObject;return r[e].apply(r,t),this}},n={hasData(e){var t=this.gameObject;return!!t.data&&t.data.has(e)},getData(e){return this.gameObject.getData(e)},setData(e,t){return this.gameObject.setData(e,t),this}};class i{constructor(e,t,r){this.GOManager=e,this.tweens={},this.effects={},this.setGO(t,r)}get scene(){return this.GOManager.scene}get timeScale(){return this.GOManager.timeScale}destroy(){this.freeGO(),this.GOManager=void 0}freeGO(){return this.freeTweens(),this.gameObject.bob=void 0,this.gameObject.destroy(),this.gameObject=void 0,this}setGO(e,t){return e.goName=t,e.goType=this.GOManager.name,e.bob=this,this.gameObject=e,this.name=t,this.freeTweens(),this}setTimeScale(e){var t=this.tweens;for(var r in t){var n=t[r];n&&(n.timeScale=e)}return this}}Object.assign(i.prototype,t,r,n);var o=function(e){return e&&"!"!==e.charAt(0)},s={has(e){return this.bobs.hasOwnProperty(e)},exists(e){return this.bobs.hasOwnProperty(e)},get(e,t){if(o(e))return this.bobs[e];for(var r in void 0===t&&(t=[]),e&&(e=e.substring(1)),this.bobs)e&&r===e||t.push(this.bobs[r]);return t},getFitst(e){for(var t in e&&"!"===e.charAt(0)&&(e=e.substring(1)),this.bobs)if(!e||e!==t)return this.bobs[t];return null},getGO(e,t){var r=this.get(e);return r?Array.isArray(r)?(void 0===t&&(t=[]),r.forEach((function(e){t.push(e.gameObject)})),t):r.gameObject:null},forEachGO(e,t){for(var r in this.bobs){var n=this.bobs[r].gameObject;if(t?e.call(t,n,r,this):e(n,r,this))break}return this},getAllGO(e){for(var t in void 0===e&&(e=[]),this.bobs){var r=this.bobs[t].gameObject;e.push(r)}return e}},a=function(e){return e>>16&255},l=function(e){return e>>8&255},c=function(e){return 255&e};const f=Phaser.Events.EventEmitter;var h=function(e,t,r,n,i,o){return void 0===o?o={}:!0===o&&(o=u),"number"!=typeof r&&(r=0,n=0),o.x=i.x+i.width*e+r,o.y=i.y+i.height*t+n,o},u={},d=function(e,t,r,n,i,o,s){if(e.hasOwnProperty("vp"))return e;"function"==typeof r&&(s=r,r=void 0),"function"==typeof i&&(s=i,i=void 0),void 0===r&&(r=.5),void 0===n&&(n=.5),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=h),function(e){if(e.events)return e;var t=new f,r=e.x;Object.defineProperty(e,"x",{get:function(){return r},set:function(n){r!==n&&(r=n,t.emit("update",e))}});var n=e.y;Object.defineProperty(e,"y",{get:function(){return n},set:function(r){n!==r&&(n=r,t.emit("update",e))}});var i=e.width;Object.defineProperty(e,"width",{get:function(){return i},set:function(r){i!==r&&(i=r,t.emit("update",e))}});var o=e.height;Object.defineProperty(e,"height",{get:function(){return o},set:function(r){o!==r&&(o=r,t.emit("update",e))}}),e.events=t}(t);var a=t.events;e.vp=t;var l=function(){s(r,n,i,o,t,e)};a.on("update",l),e.once("destroy",(function(){a.off("update",l),e.vp=void 0})),Object.defineProperty(e,"vpx",{get:function(){return r},set:function(e){r!==e&&(r=e,l())}}),Object.defineProperty(e,"vpy",{get:function(){return n},set:function(e){n!==e&&(n=e,l())}}),Object.defineProperty(e,"vpxOffset",{get:function(){return i},set:function(e){i!==e&&(i=e,l())}}),Object.defineProperty(e,"vpyOffset",{get:function(){return o},set:function(e){o!==e&&(o=e,l())}}),l()},p=function(e,t){if(!e)return!1;if(e.hasOwnProperty(t))return!0;for(;e;){if(Object.getOwnPropertyDescriptor(e,t))return!0;e=e.__proto__}return!1},g=function(e,t){return void 0===t&&(t=!1),e.filters||e.enableFilters().focusFilters(),t?e.filters.external:e.filters.internal},v=function(e,t){e._effectSwitchNames||(e._effectSwitchNames=[],e.clearAllEffects=function(){for(var t=e._effectSwitchNames,r=0,n=t.length;r<n;r++)e[t[r]]=null;return e},e.on("destroy",e.clearAllEffects,e)),e._effectSwitchNames.push(t)},m=function(e,t,r){if(p(e,t))return e;var n,i=g(e),o=`_${t}Effect`;return Object.defineProperty(e,t,{get:function(){return n},set:function(s){n!==s&&(null===(n=s)||!1===n?e[o]&&(i.remove(e[o]),e[o]=void 0):(e[o]||(e[o]=i.addColorMatrix()),e[o].colorMatrix[t](1===r?s:void 0)))}}),e[t]=null,v(e,t),e};const b=Phaser.Game;var y=function(e){return e instanceof b};const _=Phaser.Scene;var O=function(e){return e instanceof _},w=function(e){return null==e||"object"!=typeof e?null:y(e)?e:y(e.game)?e.game:O(e)?e.sys.game:O(e.scene)?e.scene.sys.game:void 0},P=function(e,t){var r=t.FilterName,n=w(e).renderer.renderNodes;return!n.hasNode(r)&&(n.addNodeConstructor(r,t),!0)},S=function(e,t){var r=Phaser.GameObjects.Components.FilterList.prototype;r[e]||(r[e]=t)};const x="FilterP3BloomStep";class E extends Phaser.Renderer.WebGL.RenderNodes.BaseFilterShader{static FilterName=x;constructor(e){super(x,e,null,"#pragma phaserTemplate(shaderName)\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform vec2 offset;\nuniform float strength;\nuniform vec3 color;\n\n#pragma phaserTemplate(fragmentHeader)\n\nvoid main (void) {\n    vec4 sum = texture2D(uMainSampler, outTexCoord) * 0.204164 * strength;\n\n    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 1.407333) * 0.304005;\n    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 1.407333) * 0.304005;\n    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 3.294215) * 0.093913;\n    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 3.294215) * 0.093913;\n\n    gl_FragColor = sum * vec4(color, 1);\n}\n")}setupUniforms(e,t){const r=this.programManager;var n=2/t.width*e.offsetX,i=2/t.height*e.offsetY;r.setUniform("offset",[n,i]),r.setUniform("strength",e.strength),r.setUniform("color",e.glcolor)}}const C=Phaser.Utils.Objects.GetValue;class j extends Phaser.Filters.Controller{static FilterName=x;constructor(e,t){super(e,x),this.offsetX=1,this.offsetY=1,this.strength=1,this.glcolor=[1,1,1],this.resetFromJSON(t)}resetFromJSON(e){return this.setOffset(C(e,"offsetX",1),C(e,"offsetY",1)),this.setStrength(C(e,"strength",1)),this.setColor(C(e,"color",16777215)),this}get color(){var e=this.glcolor;return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}set color(e){var t=this.glcolor;t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255}setOffset(e,t){return this.offsetX=e,this.offsetY=t,this}setStrength(e){return this.strength=e,this}setColor(e){return this.color=e,this}}const T=Phaser.Utils.Objects.GetValue;let G=class extends Phaser.Filters.ParallelFilters{constructor(e,t){super(e),this.steps=0,this.offsetX=1,this.offsetY=1,this.blurStrength=1,this.color=16777215,this.strength=1,this.resetFromJSON(t)}resetFromJSON(e){return this.setOffset(T(e,"offsetX",1),T(e,"offsetY",1)),this.setBlurStrength(T(e,"blurStrength",1)),this.setColor(T(e,"color",16777215)),this.setStrength(T(e,"strength",1)),this.setSteps(T(e,"steps",4)),this}forEachController(e,t){this.top.list.forEach(e,t)}get steps(){return this._steps}set steps(e){if(this._steps!==e){var t=this.camera;if(this.steps<e)for(var r=this.top,n=2*e,i=2*this.steps;i<n;i++)r.add(new j(t));else{var o=this.top.list;for(n=2*e,i=2*this.steps-1;i>=n;i--)o[i].destroy();o.length=n}this._steps=e,this.setOffset(this.offsetX,this.offsetY),this.setBlurStrength(this.strength),this.setColor(this.color)}}setSteps(e){return this.steps=e,this}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this.forEachController((function(t,r){t.offsetX=r%2==0?e:0}))}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this.forEachController((function(t,r){t.offsetY=r%2==1?e:0}))}setOffset(e,t){return this.offsetX=e,this.offsetY=t,this}get blurStrength(){return this._blurStrength}set blurStrength(e){this._blurStrength=e,this.forEachController((function(t){t.strength=e}))}setBlurStrength(e){return this.blurStrength=e,this}get color(){return this._color}set color(e){this._color=e,this.forEachController((function(t){t.color=e}))}setColor(e){return this.color=e,this}get strength(){return this._strength}set strength(e){this._strength=e,this.blend.amount=e}setStrength(e){return this.strength=e,this}};const F="FilterP3Circle";class L extends Phaser.Renderer.WebGL.RenderNodes.BaseFilterShader{static FilterName=F;constructor(e){super(F,e,null,"#pragma phaserTemplate(shaderName)\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform vec2 texSize;\nuniform vec3 color;\nuniform vec4 backgroundColor;\nuniform vec3 config;\n\n#pragma phaserTemplate(fragmentHeader)\n\nvoid main (void) {\n    float thickness = config.x;\n    float scale = config.y;\n    float feather = config.z;\n\n    vec4 texture = texture2D(uMainSampler, outTexCoord);\n\n    vec2 position = (gl_FragCoord.xy / texSize.xy) * 2.0 - 1.0;\n\n    float aspectRatio = texSize.x / texSize.y;\n\n    position.x *= aspectRatio;\n\n    float grad = length(position);\n\n    //  height > width\n    float outer = aspectRatio;\n    float inner = outer - (thickness * 2.0 / texSize.y);\n\n    //  width > height\n    if (aspectRatio >= 1.0)\n    {\n        float f = 2.0 + (texSize.y / texSize.x);\n        outer = 1.0;\n        inner = 1.0 - (thickness * f / texSize.x);\n    }\n\n    outer *= scale;\n    inner *= scale;\n\n    float circle = smoothstep(outer, outer - 0.01, grad);\n\n    float ring = circle - smoothstep(inner, inner - feather, grad);\n\n    texture = mix(backgroundColor * backgroundColor.a, texture, texture.a);\n\n    texture = (texture * (circle - ring));\n\n    gl_FragColor = vec4(texture.rgb + (ring * color), texture.a);\n}\n")}setupUniforms(e,t){const r=this.programManager;r.setUniform("texSize",[t.width,t.height]),r.setUniform("color",e.glcolor),r.setUniform("backgroundColor",e.glcolor2),r.setUniform("config",[e.thickness,e.scale,e.feather])}}const R=Phaser.Utils.Objects.GetValue;class k extends Phaser.Filters.Controller{static FilterName=F;constructor(e,t){super(e,F),this.thickness=8,this.scale=1,this.feather=.005,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4],this.resetFromJSON(t)}resetFromJSON(e){return this.setThickness(R(e,"thickness",8)),this.setScale(R(e,"scale",1)),this.setFeather(R(e,"feather",.005)),this.setColor(R(e,"color",16724914)),this.setBackgroundColor(R(e,"backgroundColor",16711680)),this.setBackgroundAlpha(R(e,"backgroundAlpha",.4)),this}get color(){var e=this.glcolor;return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}set color(e){var t=this.glcolor;t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255}get backgroundColor(){var e=this.glcolor2;return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}set backgroundColor(e){var t=this.glcolor2;t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255}get backgroundAlpha(){return this.glcolor2[3]}set backgroundAlpha(e){this.glcolor2[3]=e}setThickness(e){return this.thickness=e,this}setScale(e){return this.scale=e,this}setFeather(e){return this.feather=e,this}setColor(e){return this.color=e,this}setBackgroundColor(e){return this.backgroundColor=e,this}setBackgroundAlpha(e){return this.backgroundAlpha=e,this}}const M="FilterP3Gradient";class N extends Phaser.Renderer.WebGL.RenderNodes.BaseFilterShader{static FilterName=M;constructor(e){super(M,e,null,"#pragma phaserTemplate(shaderName)\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n\n#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))\n#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))\n#define SRGB(r, g, b) SRGB_TO_LINEAR(vec3(float(r), float(g), float(b)) / 255.0)\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform float alpha;\nuniform vec2 positionFrom;\nuniform vec2 positionTo;\nuniform vec3 color1;\nuniform vec3 color2;\nuniform int size;\n\n#pragma phaserTemplate(fragmentHeader)\n\nfloat gradientNoise(in vec2 uv)\n{\n    const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n    return fract(magic.z * fract(dot(uv, magic.xy)));\n}\n\nfloat stepped (in float s, in float scale, in int steps)\n{\n    return steps > 0 ? floor( s / ((1.0 * scale) / float(steps))) * 1.0 / float(steps - 1) : s;\n}\n\nvoid main ()\n{\n    vec2 a = positionFrom;\n    vec2 b = positionTo;\n    vec2 ba = b - a;\n\n    float d = dot(outTexCoord - a, ba) / dot(ba, ba);\n    float t = size > 0 ? stepped(d, 1.0, size) : d;\n\n    t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));\n\n    vec3 color = mix(SRGB(color1.r, color1.g, color1.b), SRGB(color2.r, color2.g, color2.b), t);\n\n    color = LINEAR_TO_SRGB(color);\n    color += (1.0 / 255.0) * gradientNoise(outTexCoord) - (0.5 / 255.0);\n\n    vec4 texture = texture2D(uMainSampler, outTexCoord);\n\n    gl_FragColor = vec4(mix(color.rgb, texture.rgb, alpha), 1.0) * texture.a;\n}\n")}setupUniforms(e,t){const r=this.programManager;r.setUniform("alpha",e.alpha),r.setUniform("positionFrom",[e.fromX,e.fromY]),r.setUniform("positionTo",[e.toX,e.toY]),r.setUniform("color1",e.glcolor1),r.setUniform("color2",e.glcolor2),r.setUniform("size",e.size)}}const A=Phaser.Utils.Objects.GetValue;class B extends Phaser.Filters.Controller{static FilterName=M;constructor(e,t){super(e,M),this.alpha=.2,this.fromX=0,this.fromY=0,this.toX=0,this.toY=1,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0],this.size=0,this.resetFromJSON(t)}resetFromJSON(e){return this.setAlpha(A(e,"alpha",.2)),this.setFromPosition(A(e,"fromX",0),A(e,"fromY",0)),this.setToPosition(A(e,"toX",0),A(e,"toY",1)),this.setColor1(A(e,"color1",16711680)),this.setColor2(A(e,"color2",65280)),this.setSize(A(e,"size",0)),this}get color1(){var e=this.glcolor1;return(e[0]<<16)+(e[1]<<8)+(0|e[2])}set color1(e){var t=this.glcolor1;t[0]=e>>16&255,t[1]=e>>8&255,t[2]=255&e}get color2(){var e=this.glcolor2;return(e[0]<<16)+(e[1]<<8)+(0|e[2])}set color2(e){var t=this.glcolor2;t[0]=e>>16&255,t[1]=e>>8&255,t[2]=255&e}setAlpha(e){return this.alpha=e,this}setFromPosition(e,t){return this.fromX=e,this.fromY=t,this}setToPosition(e,t){return this.toX=e,this.toY=t,this}setColor1(e){return this.color1=e,this}setColor2(e){return this.color2=e,this}setSize(e){return this.size=e,this}}const D="FilterP3Wipe";class W extends Phaser.Renderer.WebGL.RenderNodes.BaseFilterShader{static FilterName=D;constructor(e){super(D,e,null,"#pragma phaserTemplate(shaderName)\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform vec4 config;\nuniform bool reveal;\n\n#pragma phaserTemplate(fragmentHeader)\n\nvoid main (void) {\n    vec2 uv = outTexCoord;\n\n    vec4 color0;\n    vec4 color1;\n\n    if (reveal) {\n        color0 = vec4(0);\n        color1 = texture2D(uMainSampler, uv);\n    } else {\n        color0 = texture2D(uMainSampler, uv);\n        color1 = vec4(0);\n    }\n\n    float distance = config.x;\n    float width = config.y;\n    float direction = config.z;\n    float axis = uv.x;\n\n    if (config.w == 1.0) {\n        axis = uv.y;\n    }\n\n    float adjust = mix(width, -width, distance);\n    float value = smoothstep(distance - width, distance + width, abs(direction - axis) + adjust);\n    gl_FragColor = mix(color1, color0, value);\n}\n")}setupUniforms(e,t){const r=this.programManager;r.setUniform("config",[e.progress,e.wipeWidth,e.direction,e.axis]),r.setUniform("reveal",e.reveal)}}const X=Phaser.Utils.Objects.GetValue,U=Phaser.Math.Clamp;class Y extends Phaser.Filters.Controller{static FilterName=D;constructor(e,t){super(e,D),this.progress=0,this.wipeWidth=.1,this.direction=0,this.axis=0,this.reveal=!1,this.resetFromJSON(t)}resetFromJSON(e){this.setProgress(X(e,"progress",0)),this.setWipeWidth(X(e,"wipeWidth",.1)),this.setDirection(X(e,"direction",0)),this.setAxis(X(e,"axis",0));var t=X(e,"reveal",void 0);return void 0===t&&(t=!X(e,"wipe",!0)),t?this.enableRevealMode():this.enableWipeMode(),this}get progress(){return this._progress}set progress(e){this._progress=U(e,0,1)}setProgress(e){return this.progress=e,this}get wipeWidth(){return this._wipeWidth}set wipeWidth(e){this._wipeWidth=U(e,0,1)}setWipeWidth(e){return this.wipeWidth=e,this}setDirection(e){return this.direction=e,this}setAxis(e){return this.axis=e,this}enableWipeMode(){return this.reveal=!1,this}enableRevealMode(){return this.reveal=!0,this}}var z=function(e){return e=w(e),!!P(e,W)&&(S("addP3Wipe",(function(e,t,r){return void 0===e&&(e=.1),void 0===t&&(t=0),void 0===r&&(r=0),this.add(new Y(this.camera,{wipeWidth:e,direction:t,axis:r}))})),S("addP3Reveal",(function(e,t,r){return void 0===e&&(e=.1),void 0===t&&(t=0),void 0===r&&(r=0),this.add(new Y(this.camera,{wipeWidth:e,direction:t,axis:r,reveal:!0}))})),!0)};const I="FilterP3Shine",V=36e5;var H=function(e,t){var r=t+w(e).loop.delta;return r>=V&&(r-=V),r};class J extends Phaser.Renderer.WebGL.RenderNodes.BaseFilterShader{static FilterName=I;constructor(e){super(I,e,null,"#pragma phaserTemplate(shaderName)\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform vec4 config;\nuniform bool reveal;\nuniform vec2 texSize;\n\n#pragma phaserTemplate(fragmentHeader)\n\nvoid main (void) {\n    float speed = config.x;\n    float time = config.y;\n    float lineWidth = config.z;\n    float gradient = config.w;\n\n\tvec2 uv = gl_FragCoord.xy / texSize;\n\n    vec4 tex = texture2D(uMainSampler, outTexCoord);\n\n    vec4 col1 = vec4(0.3, 0.0, 0.0, 1.0);\n    vec4 col2 = vec4(0.85, 0.85, 0.85, 1.0);\n\n    uv.x = uv.x - mod(time * speed, 2.0) + 0.5;\n    float y = uv.x * gradient;\n\n    float s = smoothstep(y - lineWidth, y, uv.y) - smoothstep(y, y + lineWidth, uv.y);\n\n    gl_FragColor = (((s * col1) + (s * col2)) * tex);\n\n    if (!reveal)\n    {\n        //  Apply the shine effect\n        gl_FragColor += tex;\n    }\n}\n")}setupUniforms(e,t){const r=this.programManager;e.now=H(this.manager.renderer.game,e.now),r.setUniform("config",[e.speed,e.now,e.lineWidth,e.gradient]),r.setUniform("reveal",e.reveal),r.setUniform("texSize",[t.width,t.height])}}const $=Phaser.Utils.Objects.GetValue;class K extends Phaser.Filters.Controller{static FilterName=I;constructor(e,t){super(e,I),this.now=0,this.speed=.5,this.lineWidth=.5,this.gradient=3,this.reveal=!1,this.resetFromJSON(t)}resetFromJSON(e){return this.setSpeed($(e,"speed",.5)),this.setLineWidth($(e,"lineWidth",.5)),this.setGradient($(e,"gradient",3)),this.setReveal($(e,"reveal",!1)),this}setSpeed(e){return this.speed=e,this}setLineWidth(e){return this.lineWidth=e,this}setGradient(e){return this.gradient=e,this}setReveal(e){return this.reveal=e,this}}const q="FilterP3Vignette";class Q extends Phaser.Renderer.WebGL.RenderNodes.BaseFilterShader{static FilterName=q;constructor(e){super(q,e,null,"#pragma phaserTemplate(shaderName)\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n\n// Scene buffer\nuniform sampler2D uMainSampler; \nvarying vec2 outTexCoord;\n\n// Effect parameters\nuniform vec2 config;\nuniform vec2 position;\n\n#pragma phaserTemplate(fragmentHeader)\n\nvoid main (void) {\n    float radius = config.x;\n    float strength = config.y;\n\n    vec4 col = vec4(1.0);\n\n    float d = length(outTexCoord - position);\n\n    if (d <= radius)\n    {\n        float g = d / radius;\n        g = sin(g * 3.14 * strength);\n    \tcol = vec4(g * g * g);\n    }\n\n    vec4 texture = texture2D(uMainSampler, outTexCoord);\n\n    gl_FragColor = texture * (1.0 - col);\n}\n")}setupUniforms(e,t){const r=this.programManager;r.setUniform("config",[e.radius,e.strength]),r.setUniform("position",[e.x,e.y])}}const Z=Phaser.Utils.Objects.GetValue;class ee extends Phaser.Filters.Controller{static FilterName=q;constructor(e,t){super(e,q),this.x=.5,this.y=.5,this.radius=.5,this.strength=.5,this.resetFromJSON(t)}resetFromJSON(e){return this.setPosition(Z(e,"x",.5),Z(e,"y",.5)),this.setRadius(Z(e,"radius",.5)),this.setStrength(Z(e,"strength",.5)),this}setPosition(e,t){return this.x=e,this.y=t,this}setRadius(e){return this.radius=e,this}setStrength(e){return this.strength=e,this}}const te={barrel:function(e){if(p(e,"barrel"))return e;var t,r=g(e);return Object.defineProperty(e,"barrel",{get:function(){return t},set:function(n){t!==n&&(null===(t=n)||!1===t?e._barrelEffect&&(r.remove(e._barrelEffect),e._barrelEffect=void 0):(e._barrelEffect||(e._barrelEffect=r.addBarrel()),e._barrelEffect.amount=t))}}),e.barrel=null,v(e,"barrel"),e},blackWhite:function(e){return m(e,"blackWhite"),e},bloom:function(e){if(p(e,"bloomColor"))return e;var t;t=w(t=e),P(t,E)&&S("addP3Bloom",(function(e,t,r,n,i,o){return void 0===e&&(e=16777215),void 0===t&&(t=1),void 0===r&&(r=1),void 0===n&&(n=1),void 0===i&&(i=1),void 0===o&&(o=4),this.add(new G(this.camera,{color:e,offsetX:t,offsetY:r,blurStrength:n,strength:i,steps:o}))}));var r,n=g(e),i=1,o=1,s=1,a=1,l=4;return Object.defineProperty(e,"bloomColor",{get:function(){return r},set:function(t){r!==t&&(null===(r=t)||!1===r?e._bloom&&(n.remove(e._bloom),e._bloom=void 0):(e._bloom||(e._bloom=n.addBloom(r,i,o,s,a,l)),e._bloom.color=r))}}),Object.defineProperty(e,"bloomOffsetX",{get:function(){return i},set:function(t){i!==t&&(i=t,e._bloom&&(e._bloom.offsetX=i))}}),Object.defineProperty(e,"bloomOffsetY",{get:function(){return o},set:function(t){o!==t&&(o=t,e._bloom&&(e._bloom.offsetY=o))}}),Object.defineProperty(e,"bloomBlurStrength",{get:function(){return s},set:function(t){s!==t&&(s=t,e._bloom&&(e._bloom.blurStrength=s))}}),Object.defineProperty(e,"bloomStrength",{get:function(){return a},set:function(t){a!==t&&(a=t,e._bloom&&(e._bloom.strength=a))}}),Object.defineProperty(e,"bloomSteps",{get:function(){return l},set:function(t){l!==t&&(l=t,e._bloom&&(e._bloom.steps=l))}}),e.bloomColor=null,v(e,"bloomColor"),e},blur:function(e){if(p(e,"blurColor"))return e;var t,r=g(e),n=0,i=1,o=1,s=1,a=4;return Object.defineProperty(e,"blurColor",{get:function(){return t},set:function(l){t!==l&&(null===(t=l)||!1===t?e._blur&&(r.remove(e._blur),e._blur=void 0):(e._blur||(e._blur=r.addBlur(n,i,o,s,t,a)),e._blur.color=t))}}),Object.defineProperty(e,"blurQuality",{get:function(){return n},set:function(t){n!==t&&(n=t,e._blur&&(e._blur.quality=n))}}),Object.defineProperty(e,"blurX",{get:function(){return i},set:function(t){i!==t&&(i=t,e._blur&&(e._blur.x=i))}}),Object.defineProperty(e,"blurY",{get:function(){return o},set:function(t){o!==t&&(o=t,e._blur&&(e._blur.y=o))}}),Object.defineProperty(e,"blurStrength",{get:function(){return s},set:function(t){s!==t&&(s=t,e._blur&&(e._blur.strength=s))}}),Object.defineProperty(e,"blurSteps",{get:function(){return a},set:function(t){a!==t&&(a=t,e._blur&&(e._blur.steps=a))}}),e.blurColor=null,v(e,"blurColor"),e},bokeh:function(e){if(p(e,"bokehRadius"))return e;var t,r=g(e),n=1,i=.2;return Object.defineProperty(e,"bokehRadius",{get:function(){return t},set:function(o){t!==o&&(null===(t=o)||!1===t?e._bokeh&&(r.remove(e._bokeh),e._bokeh=void 0):(e._bokeh||(e._bokeh=r.addBokeh(t,n,i)),e._bokeh.radius=t))}}),Object.defineProperty(e,"bokehAmount",{get:function(){return n},set:function(t){n!==t&&(n=t,e._bokeh&&(e._bokeh.amount=n))}}),Object.defineProperty(e,"bokehContrast",{get:function(){return i},set:function(t){i!==t&&(i=t,e._bokeh&&(e._bokeh.contrast=i))}}),e.bokehRadius=null,v(e,"bokehRadius"),e},brightness:function(e){return m(e,"brightness",1),e},brown:function(e){return m(e,"brown"),e},circle:function(e){if(p(e,"circleColor"))return e;var t;t=w(t=e),P(t,L)&&(S("addP3Bloom",(function(e,t,r,n,i,o){return void 0===e&&(e=16777215),void 0===t&&(t=1),void 0===r&&(r=1),void 0===n&&(n=1),void 0===i&&(i=1),void 0===o&&(o=4),this.add(new BloomController(this.camera,{color:e,offsetX:t,offsetY:r,blurStrength:n,strength:i,steps:o}))})),S("addP3Circle",(function(e,t,r,n,i){return void 0===e&&(e=8),void 0===t&&(t=16724914),void 0===r&&(r=16711680),void 0===n&&(n=1),void 0===i&&(i=.005),this.add(new k(this.camera,{thickness:e,color:t,backgroundColor:r,scale:n,feather:i}))})));var r,n=g(e),i=8,o=0,s=.4,a=1,l=.005;return Object.defineProperty(e,"circleColor",{get:function(){return r},set:function(t){r!==t&&(null===(r=t)||!1===r?e._circle&&(n.remove(e._circle),e._circle=void 0):(e._circle||(e._circle=n.addP3Circle(i,r,o,a,l),e.circleBackgroundAlpha=s),e._circle.color=r))}}),Object.defineProperty(e,"circleThickness",{get:function(){return i},set:function(t){i!==t&&(i=t,e._circle&&(e._circle.thickness=i))}}),Object.defineProperty(e,"circleBackgroundColor",{get:function(){return o},set:function(t){o!==t&&(o=t,e._circle&&(e._circle.backgroundColor=o))}}),Object.defineProperty(e,"circleBackgroundAlpha",{get:function(){return s},set:function(t){s!==t&&(s=t,e._circle&&(e._circle.glcolor2[3]=s))}}),Object.defineProperty(e,"circleScale",{get:function(){return a},set:function(t){a!==t&&(a=t,e._circle&&(e._circle.scale=a))}}),Object.defineProperty(e,"circleFeather",{get:function(){return l},set:function(t){l!==t&&(l=t,e._circle&&(e._circle.feather=l))}}),e.circleColor=null,v(e,"circleColor"),e},contrast:function(e){return m(e,"contrast",1),e},desaturate:function(e){return m(e,"desaturate",1),e},desaturateLuminance:function(e){return m(e,"desaturateLuminance"),e},displacement:function(e){if(p(e,"displacementKey"))return e;var t,r=g(e),n=.005,i=.005;return Object.defineProperty(e,"displacementKey",{get:function(){return t},set:function(o){t!==o&&(null===(t=o)||!1===t?e._displacement&&(r.remove(e._displacement),e._displacement=void 0):(e._displacement||(e._displacement=r.addDisplacement(t,n,i)),e._displacement.setTexture(t)))}}),Object.defineProperty(e,"displacementX",{get:function(){return n},set:function(t){n!==t&&(n=t,e._displacement&&(e._displacement.x=n))}}),Object.defineProperty(e,"displacementY",{get:function(){return i},set:function(t){i!==t&&(i=t,e._displacement&&(e._displacement.y=i))}}),e.displacementKey=null,v(e,"displacementKey"),e},glow:function(e){if(p(e,"glowColor"))return e;var t,r=g(e),n=4,i=0;return Object.defineProperty(e,"glowColor",{get:function(){return t},set:function(o){t!==o&&(null===(t=o)||!1===t?e._glow&&(r.remove(e._glow),e._glow=void 0):(e._glow||(e._glow=r.addGlow(t,n,i)),e._glow.color=t))}}),Object.defineProperty(e,"glowOuterStrength",{get:function(){return n},set:function(t){n!==t&&(n=t,e._glow&&(e._glow.outerStrength=n))}}),Object.defineProperty(e,"glowInnerStrength",{get:function(){return i},set:function(t){i!==t&&(i=t,e._glow&&(e._glow.innerStrength=i))}}),e.glowColor=null,v(e,"glowColor"),e},gradient:function(e){if(p(e,"gradientColor"))return e;var t;t=w(t=e),P(t,N)&&S("addP3Gradient",(function(e,t,r,n,i,o,s,a){return void 0===e&&(e=16711680),void 0===t&&(t=65280),void 0===r&&(r=.2),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=1),void 0===a&&(a=0),this.add(new B(this.camera,{color1:e,color2:t,alpha:r,fromX:n,fromY:i,toX:o,toY:s,size:a}))}));var r,n,i=g(e),o=.5,s=0,a=0,l=0,c=1,f=0;return Object.defineProperty(e,"gradientColor",{get:function(){return[r,n]},set:function(t){var h,u;null===t||!1===t?(h=null,u=null):(h=t[0],u=t[1]),r===h&&n===u||(n=u,null===(r=h)||!1===r?e._gradient&&(i.remove(e._gradient),e._gradient=void 0):(e._gradient||(e._gradient=i.addP3Gradient(r,n,o,s,a,l,c,f)),e._gradient.color1=r,e._gradient.color2=n))}}),Object.defineProperty(e,"gradientColor1",{get:function(){return r},set:function(t){null!==t&&!1!==t?r!==t&&(r=t,e._gradient&&(e._gradient.color1=r)):e.gradientColor=t}}),Object.defineProperty(e,"gradientColor2",{get:function(){return n},set:function(t){null!==t&&!1!==t?n!==t&&(n=t,e._gradient&&(e._gradient.color2=n)):e.gradientColor=t}}),Object.defineProperty(e,"gradientAlpha",{get:function(){return o},set:function(t){o!==t&&(o=t,e._gradient&&(e._gradient.alpha=o))}}),Object.defineProperty(e,"gradientFromX",{get:function(){return s},set:function(t){s!==t&&(s=t,e._gradient&&(e._gradient.fromX=s))}}),Object.defineProperty(e,"gradientFromY",{get:function(){return a},set:function(t){a!==t&&(a=t,e._gradient&&(e._gradient.fromY=a))}}),Object.defineProperty(e,"gradientToX",{get:function(){return l},set:function(t){l!==t&&(l=t,e._gradient&&(e._gradient.toX=l))}}),Object.defineProperty(e,"gradientToY",{get:function(){return c},set:function(t){c!==t&&(c=t,e._gradient&&(e._gradient.toY=c))}}),Object.defineProperty(e,"gradientSize",{get:function(){return f},set:function(t){f!==t&&(f=t,e._gradient&&(e._gradient.size=f))}}),e.gradientColor=null,v(e,"gradientColor"),e},grayscale:function(e){return m(e,"grayscale",1),e},hue:function(e){return m(e,"hue",1),e},kodachrome:function(e){return m(e,"kodachrome"),e},lsd:function(e){return m(e,"lsd"),e},negative:function(e){return m(e,"negative"),e},pixelate:function(e){if(p(e,"pixelate"))return e;var t,r=g(e);return Object.defineProperty(e,"pixelate",{get:function(){return t},set:function(n){t!==n&&(null===(t=n)||!1===t?e._pixelateEffect&&(r.remove(e._pixelateEffect),e._pixelateEffect=void 0):(e._pixelateEffect||(e._pixelateEffect=r.addPixelate()),e._pixelateEffect.amount=t))}}),e.pixelate=null,v(e,"pixelate"),e},polaroid:function(e){return m(e,"polaroid"),e},reveal:function(e){if(p(e,"revealLeft"))return e;z(e);var t,r,n,i,o=g(e),s=.1,a=function(){t=null,r=null,n=null,i=null},l=function(e){e._revealEffect&&(o.remove(e._revealEffect),e._revealEffect=void 0)};return Object.defineProperty(e,"revealLeft",{get:function(){return t},set:function(r){t!==r&&(a(),null===(t=r)||!1===t?l(e):(e._revealEffect||(e._revealEffect=o.addP3Reveal(s,0,0)),e._revealEffect.direction=1,e._revealEffect.axis=0,e._revealEffect.progress=t))}}),Object.defineProperty(e,"revealRight",{get:function(){return r},set:function(t){r!==t&&(a(),null===(r=t)||!1===r?l(e):(e._revealEffect||(e._revealEffect=o.addP3Reveal(s,0,0)),e._revealEffect.direction=0,e._revealEffect.axis=0,e._revealEffect.progress=r))}}),Object.defineProperty(e,"revealUp",{get:function(){return n},set:function(t){n!==t&&(a(),null===(n=t)||!1===n?l(e):(e._revealEffect||(e._revealEffect=o.addP3Reveal(s,0,0)),e._revealEffect.direction=1,e._revealEffect.axis=1,e._revealEffect.progress=n))}}),Object.defineProperty(e,"revealDown",{get:function(){return i},set:function(t){i!==t&&(a(),null===(i=t)||!1===i?l(e):(e._revealEffect||(e._revealEffect=o.addP3Reveal(s,0,0)),e._revealEffect.direction=0,e._revealEffect.axis=1,e._revealEffect.progress=i))}}),Object.defineProperty(e,"revealWidth",{get:function(){return s},set:function(t){s!==t&&(s=t,e._revealEffect&&(e._revealEffect.wipeWidth=s))}}),e.revealLeft=null,v(e,"revealLeft"),v(e,"revealRight"),v(e,"revealUp"),v(e,"revealDown"),e},saturate:function(e){return m(e,"saturate",1),e},sepia:function(e){return m(e,"sepia"),e},shadow:function(e){if(p(e,"shadowColor"))return e;var t,r=g(e),n=0,i=0,o=.1,s=1,a=6,l=1;return Object.defineProperty(e,"shadowColor",{get:function(){return t},set:function(c){t!==c&&(null===(t=c)||!1===t?e._shadow&&(r.remove(e._shadow),e._shadow=void 0):(e._shadow||(e._shadow=r.addShadow(n,i,o,s,t,a,l)),e._shadow.color=t))}}),Object.defineProperty(e,"shadowX",{get:function(){return n},set:function(t){n!==t&&(n=t,e._shadow&&(e._shadow.x=n))}}),Object.defineProperty(e,"shadowY",{get:function(){return i},set:function(t){i!==t&&(i=t,e._shadow&&(e._shadow.y=i))}}),Object.defineProperty(e,"decay",{get:function(){return o},set:function(t){o!==t&&(o=t,e._shadow&&(e._shadow.decay=o))}}),Object.defineProperty(e,"shadowPower",{get:function(){return s},set:function(t){s!==t&&(s=t,e._shadow&&(e._shadow.power=s))}}),Object.defineProperty(e,"shadowSamples",{get:function(){return a},set:function(t){a!==t&&(a=t,e._shadow&&(e._shadow.samples=a))}}),Object.defineProperty(e,"shadowIntensity",{get:function(){return l},set:function(t){l!==t&&(l=t,e._shadow&&(e._shadow.intensity=l))}}),e.shadowColor=null,v(e,"shadowColor"),e},shiftToBGR:function(e){return m(e,"shiftToBGR"),e},shine:function(e){if(p(e,"shineSpeed"))return e;var t;t=w(t=e),P(t,J)&&S("addP3Shine",(function(e,t,r,n){return void 0===e&&(e=.5),void 0===t&&(t=.5),void 0===r&&(r=3),void 0===n&&(n=!1),this.add(new K(this.camera,{speed:e,lineWidth:t,gradient:r,reveal:n}))}));var r,n=g(e),i=.5,o=3;return Object.defineProperty(e,"shineSpeed",{get:function(){return r},set:function(t){r!==t&&(null===(r=t)||!1===r?e._shine&&(n.remove(e._shine),e._shine=void 0):(e._shine||(e._shine=n.addP3Shine(r,i,o)),e._shine.speed=r))}}),Object.defineProperty(e,"shineLineWidth",{get:function(){return i},set:function(t){i!==t&&(i=t,e._shine&&(e._shine.lineWidth=i))}}),Object.defineProperty(e,"shineGradient",{get:function(){return o},set:function(t){o!==t&&(o=t,e._shine&&(e._shine.gradient=o))}}),e.shineSpeed=null,v(e,"shineSpeed"),e},technicolor:function(e){return m(e,"technicolor"),e},tiltShift:function(e){if(p(e,"tiltShiftRadius"))return e;var t,r=g(e),n=1,i=.2,o=1,s=1,a=1;return Object.defineProperty(e,"tiltShiftRadius",{get:function(){return t},set:function(l){t!==l&&(null===(t=l)||!1===t?e._tiltShift&&(r.remove(e._tiltShift),e._tiltShift=void 0):(e._tiltShift||(e._tiltShift=r.addTiltShift(t,n,i,o,s,a)),e._tiltShift.radius=t))}}),Object.defineProperty(e,"tiltShiftAmount",{get:function(){return n},set:function(t){n!==t&&(n=t,e._tiltShift&&(e._tiltShift.amount=n))}}),Object.defineProperty(e,"tiltShiftContrast",{get:function(){return i},set:function(t){i!==t&&(i=t,e._tiltShift&&(e._tiltShift.contrast=i))}}),Object.defineProperty(e,"tiltShiftBlurX",{get:function(){return o},set:function(t){o!==t&&(o=t,e._tiltShift&&(e._tiltShift.blurX=o))}}),Object.defineProperty(e,"tiltShiftBlurY",{get:function(){return s},set:function(t){s!==t&&(s=t,e._tiltShift&&(e._tiltShift.blurY=s))}}),Object.defineProperty(e,"tiltShiftStrength",{get:function(){return a},set:function(t){a!==t&&(a=t,e._tiltShift&&(e._tiltShift.strength=a))}}),e.tiltShiftRadius=null,v(e,"tiltShiftRadius"),e},vignette:function(e){if(p(e,"vignetteRadius"))return e;var t;t=w(t=e),P(t,Q)&&S("addP3Vignette",(function(e,t,r,n){return void 0===e&&(e=.5),void 0===t&&(t=.5),void 0===r&&(r=.5),void 0===n&&(n=.5),this.add(new ee(this.camera,{x:e,y:t,radius:r,strength:n}))}));var r,n=g(e),i=.5,o=.5,s=.5;return Object.defineProperty(e,"vignetteRadius",{get:function(){return r},set:function(t){r!==t&&(null===(r=t)||!1===r?e._vignette&&(n.remove(e._vignette),e._vignette=void 0):(e._vignette||(e._vignette=n.addP3Vignette(i,o,r,s)),e._vignette.radius=r))}}),Object.defineProperty(e,"vignetteX",{get:function(){return i},set:function(t){i!==t&&(i=t,e._vignette&&(e._vignette.x=i))}}),Object.defineProperty(e,"vignetteY",{get:function(){return o},set:function(t){o!==t&&(o=t,e._vignette&&(e._vignette.y=o))}}),Object.defineProperty(e,"vignetteStrength",{get:function(){return s},set:function(t){s!==t&&(s=t,e._vignette&&(e._vignette.strength=s))}}),e.vignetteRadius=null,v(e,"vignetteRadius"),e},vintagePinhole:function(e){return m(e,"vintagePinhole"),e},wipe:function(e){if(p(e,"wipeLeft"))return e;z(e);var t,r,n,i,o=g(e),s=.1,a=function(){t=null,r=null,n=null,i=null},l=function(e){e._wipeEffect&&(o.remove(e._wipeEffect),e._wipeEffect=void 0)};return Object.defineProperty(e,"wipeLeft",{get:function(){return t},set:function(r){t!==r&&(a(),null===(t=r)||!1===t?l(e):(e._wipeEffect||(e._wipeEffect=o.addP3Wipe(s,0,0)),e._wipeEffect.direction=1,e._wipeEffect.axis=0,e._wipeEffect.progress=t))}}),Object.defineProperty(e,"wipeRight",{get:function(){return r},set:function(t){r!==t&&(a(),null===(r=t)||!1===r?l(e):(e._wipeEffect||(e._wipeEffect=o.addP3Wipe(s,0,0)),e._wipeEffect.direction=0,e._wipeEffect.axis=0,e._wipeEffect.progress=r))}}),Object.defineProperty(e,"wipeUp",{get:function(){return n},set:function(t){n!==t&&(a(),null===(n=t)||!1===n?l(e):(e._wipeEffect||(e._wipeEffect=o.addP3Wipe(s,0,0)),e._wipeEffect.direction=1,e._wipeEffect.axis=1,e._wipeEffect.progress=n))}}),Object.defineProperty(e,"wipeDown",{get:function(){return i},set:function(t){i!==t&&(a(),null===(i=t)||!1===i?l(e):(e._wipeEffect||(e._wipeEffect=o.addP3Wipe(s,0,0)),e._wipeEffect.direction=0,e._wipeEffect.axis=1,e._wipeEffect.progress=i))}}),Object.defineProperty(e,"wipeWidth",{get:function(){return s},set:function(t){s!==t&&(s=t,e._wipeEffect&&(e._wipeEffect.wipeWidth=s))}}),e.wipeLeft=null,v(e,"wipeLeft"),v(e,"wipeRight"),v(e,"wipeUp"),v(e,"wipeDown"),e}};var re=function(e,t){if(void 0===t)t=!0;else if("string"==typeof t)t={config:!0};else if(Array.isArray(t))for(var r=t,n=(t={},0),i=r.length;n<i;n++)t[r[n]]=!0;if(!0===t)for(var o in te)te[o](e);else for(var o in t)t[o]&&te[o]&&te[o](e);return e};const ne=Phaser.Utils.Array.Remove;var ie={addGO(e,t){this.remove(e,!0),this.useTintFadeEffect(t)&&function(e,t){if(e.hasOwnProperty("tintR"))return e;void 0===t&&(t=16777215);var r=a(t),n=l(t),i=c(t);Object.defineProperty(e,"tint",{get:function(){return t},set:function(o){o=16777215&Math.floor(o),e.setTint&&e.setTint(o),t!==o&&(r=a(t=o),n=l(t),i=c(t))}}),Object.defineProperty(e,"tintR",{get:function(){return r},set:function(n){n=255&Math.floor(n),r!==n&&(r=n,e.tint=(255&n)<<16|65535&t)}}),Object.defineProperty(e,"tintG",{get:function(){return n},set:function(r){r=255&Math.floor(r),n!==r&&(n=r,e.tint=(255&r)<<8|16711935&t)}}),Object.defineProperty(e,"tintB",{get:function(){return i},set:function(r){r=255&Math.floor(r),i!==r&&(i=r,e.tint=255&r|16776960&t)}}),Object.defineProperty(e,"tintGray",{get:function(){return Math.floor((r+n+i)/3)},set:function(t){t=255&Math.floor(t),r===t&&n===t&&i===t||(r=t,n=t,i=t,e.tint=(255&t)<<16|(255&t)<<8|255&t)}}),e.tint=t}(t),this.viewportCoordinateEnable&&d(t,this.viewport),this.effectPropertiesConfig&&re(t,this.effectPropertiesConfig),t.setName(e).once("destroy",(function(){ne(this.removedGOs,t),this.isEmpty&&this.emit("empty")}),this);var r=new this.BobClass(this,t,e);return this.bobs[e]=r,this},add(e,...t){var r=this.createGameObjectCallback,n=this.createGameObjectScope,i=r.call(n,this.scene,...t);this.addGO(e,i),null!=this.gameObjectDepth&&i.setDepth(this.gameObjectDepth);var o=this.get(e);return this.fadeBob(o,0,1),this}},oe={remove(e,t){var r=this.get(e);if(!r)return this;Array.isArray(r)||(r=[r]);var n=this;return r.forEach((function(e){delete n.bobs[e.name];var r=e.gameObject;n.removedGOs.push(r),r.setName(),t?e.destroy():n.fadeBob(e,void 0,0,(function(){e.destroy()}))})),this},removeAll(){var e=this.bobs;for(var t in e)this.remove(t);return this},clear(e){void 0===e&&(e=!0);var t=this.bobs;for(var r in t)e&&t[r].destroy(),delete t[r];return this.removedGOs.length=0,this}},se={hasProperty(e,t){var r=o(e)?this.get(e):this.getFitst(e);return!!r&&r.hasProperty(t)},getProperty(e,t){var r=o(e)?this.get(e):this.getFitst(e);if(r)return r.getProperty(t)},isNumberProperty(e,t){return"number"==typeof this.getProperty(e,t)},setProperty(e,t,r){var n=this.get(e);return n?(Array.isArray(n)||(n=[n]),this.symbols&&"string"==typeof r&&this.isNumberProperty(e,t)&&(r in this.symbols?r=this.symbols[r]:console.warn(`Can't find symbol ${r}`)),n.forEach((function(e){e.setProperty(t,r)})),this):this},easeProperty(e,t){var r=this.get(e);if(!r)return this;Array.isArray(r)||(r=[r]);var n=t.value,i=t.property;return this.symbols&&"string"==typeof n&&this.isNumberProperty(e,i)&&n in this.symbols&&(t.value=this.symbols[n]),r.forEach((function(e){e.easeProperty(t)})),this},hasTweenTask(e,t){var r=o(e)?this.get(e):this.getFitst(e);return!!r&&r.tweens.hasOwnProperty(t)},getTweenTask(e,t){var r=o(e)?this.get(e):this.getFitst(e);return r&&r.tweens[t]||null}},ae={hasMethod(e,t){var r=o(e)?this.get(e):this.getFitst(e);return!!r&&r.hasMethod(t)},call(e,t,...r){var n=this.get(e);return n?(Array.isArray(n)||(n=[n]),n.forEach((function(e){e.call(t,...r)})),this):this}},le={hasData(e,t){var r=o(e)?this.get(e):this.getFitst(e);return!!r&&r.hasData(t)},getData(e,t){if(this.has(e))return this.get(e).getData(t)},setData(e,t,r){var n=this.get(e);return n?(Array.isArray(n)||(n=[n]),n.forEach((function(e){e.setData(t,r)})),this):this}};const ce={tint:0,alpha:1,revealUp:2,revealDown:3,revealLeft:4,revealRight:5};var fe={setGOFadeMode(e){return"string"==typeof e&&(e=ce[e]),this.fadeMode=e,this},setGOFadeTime(e){return this.fadeTime=e,this},useTintFadeEffect(e){return(void 0===this.fadeMode||0===this.fadeMode)&&this.fadeTime>0&&void 0!==e.setTint},useAlphaFadeEffect(e){return(void 0===this.fadeMode||1===this.fadeMode)&&this.fadeTime>0&&void 0!==e.setAlpha},useRevealEffect(e){return this.fadeMode>=2&&this.fadeMode<=5&&this.fadeTime>0&&(e.preFX||e.postFX)},fadeBob(e,t,r,n){var i=e.gameObject;if(this.useTintFadeEffect(i))void 0!==t&&e.setProperty("tintGray",255*t),e.easeProperty({property:"tintGray",value:Math.floor(255*r),duration:this.fadeTime,delay:0,ease:"Linear",repeat:0,yoyo:!1,from:!1,complete:n});else if(this.useAlphaFadeEffect(i))void 0!==t&&e.setProperty("alpha",t),e.easeProperty({property:"alpha",value:r,duration:this.fadeTime,delay:0,ease:"Linear",repeat:0,yoyo:!1,from:!1,complete:n});else if(this.useRevealEffect(i)){var o;switch(re(i,"reveal"),this.fadeMode){case 2:o="revealUp";break;case 3:o="revealDown";break;case 4:o="revealLeft";break;case 5:o="revealRight"}void 0===t&&(t=0),i[o]=t,e.easeProperty({property:o,value:r,duration:this.fadeTime,delay:0,ease:"Linear",repeat:0,yoyo:!1,from:!1,complete:n}),e.getTweenTask(o).once("complete",(function(){i[o]=null}))}else n&&n(i);return this}},he=function(e){return void 0!==e.displayWidth?e.displayWidth:e.width},ue=function(e){return void 0!==e.displayHeight?e.displayHeight:e.height};Phaser.Geom.Rectangle;const de=Phaser.Math.Vector2,pe=Phaser.Math.RotateAround;Phaser.GameObjects.Container;var ge=void 0,ve=function(e,t,r){return void 0===r&&(r=!1),0!==e.rotation&&pe(t,e.x,e.y,e.rotation),r&&e.parentContainer&&e.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t};const me=Phaser.Utils.Objects.GetValue;var be=function(e,t,r,n,i,o,s){if(e.getBounds||void 0!==e.width&&void 0!==e.height){void 0===r&&(r=16777215),void 0===n&&(n=1),void 0===i&&(i=null),void 0===o&&(o=1),void 0===s&&(s=0);var a=function(e,t,r){return void 0===t?t=new de:!0===t&&(void 0===ge&&(ge=new de),t=ge),e.getTopLeft?e.getTopLeft(t):(t.x=e.x-he(e)*e.originX,t.y=e.y-ue(e)*e.originY,ve(e,t,r))}(e,ye[0]);a.x-=s,a.y-=s;var l=function(e,t,r){return void 0===t?t=new de:!0===t&&(void 0===ge&&(ge=new de),t=ge),e.getTopRight?e.getTopRight(t):(t.x=e.x-he(e)*e.originX+he(e),t.y=e.y-ue(e)*e.originY,ve(e,t,r))}(e,ye[1]);l.x+=s,l.y-=s;var c=function(e,t,r){return void 0===t?t=new de:!0===t&&(void 0===ge&&(ge=new de),t=ge),e.getBottomRight?e.getBottomRight(t):(t.x=e.x-he(e)*e.originX+he(e),t.y=e.y-ue(e)*e.originY+ue(e),ve(e,t,r))}(e,ye[2]);c.x+=s,c.y+=s;var f=function(e,t,r){return void 0===t?t=new de:!0===t&&(void 0===ge&&(ge=new de),t=ge),e.getBottomLeft?e.getBottomLeft(t):(t.x=e.x-he(e)*e.originX,t.y=e.y-ue(e)*e.originY+ue(e),ve(e,t,r))}(e,ye[3]);f.x-=s,f.y+=s,null!==i&&t.fillStyle(i,o).fillPoints(ye,!0,!0),null!==r&&t.lineStyle(n,r).strokePoints(ye,!0,!0)}},ye=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],_e=function(e,t){var r,n=e.cameras;if(void 0===t)r=n.main;else switch(typeof t){case"string":r=n.getCamera(t);break;case"number":r=n.cameras[t];break;default:r=t}return r},Oe={setCamera(e,t){var r=this.get(e);if(!r)return this;var n=_e(this.scene,t);return n?(r.gameObject.cameraFilter=4294967295^n.id,r.camera=n,this):this},getCamera(e){var t=this.get(e);return t?t.camera:null}},we={drawGameObjectsBounds:function(e,t){return this.forEachGO((function(r){r.drawBounds?r.drawBounds(e,t):function(e,t,r){var n,i,o,s,a;if("number"==typeof r?n=r:(n=me(r,"color"),i=me(r,"lineWidth"),o=me(r,"fillColor"),s=me(r,"fillAlpha",1),a=me(r,"padding",0)),Array.isArray(e))for(var l=0,c=e.length;l<c;l++)be(e[l],t,n,i,o,s,a);else be(e,t,n,i,o,s,a)}(r,e,t)})),this}};Object.assign(we,s,ie,oe,se,ae,le,fe,Oe);const Pe=Phaser.Cameras.Scene2D.BaseCamera,Se=Phaser.Geom.Rectangle;var xe=function(e,t,r){return t instanceof Pe||(r=t,t=void 0),void 0===r?r=new Se:!0===r&&(r=Ee),t?e.scale.getViewPort(t,r):e.scale.getViewPort(r)},Ee=new Se;const Ce=Phaser.Utils.Objects.GetValue;class je{constructor(e,t){this.scene=e,this.BobClass=Ce(t,"BobClass",i),this.setCreateGameObjectCallback(Ce(t,"createGameObject"),Ce(t,"createGameObjectScope")),this.setEventEmitter(Ce(t,"eventEmitter",void 0)),this.setGameObjectDepth(Ce(t,"depth",void 0));var r=Ce(t,"fade",500);"number"==typeof r?(this.setGOFadeMode(),this.setGOFadeTime(r)):(this.setGOFadeMode(Ce(r,"mode")),this.setGOFadeTime(Ce(r,"time",500)));var n=Ce(t,"viewportCoordinate",!1);!1!==n?(this.setViewportCoordinateEnable(Ce(t,"enable",!0)),this.setViewport(Ce(n,"viewport"))):this.setViewportCoordinateEnable(!1);var o=Ce(t,"effectProperties",!1);this.setEffectPropertiesConfig(o),this.setSymbols(Ce(t,"symbols")),this.bobs={},this.removedGOs=[],this._timeScale=1,this.name=Ce(t,"name")}destroy(e){this.clear(!e),this.createGameObjectCallback=void 0,this.viewport=void 0,this.scene=void 0}set timeScale(e){if(this._timeScale!==e){this._timeScale=e;var t=this.bobs;for(var r in t)t[r].setTimeScale(e)}}get timeScale(){return this._timeScale}setTimeScale(e){return this.timeScale=e,this}setCreateGameObjectCallback(e,t){return this.createGameObjectCallback=e,this.createGameObjectScope=t,this}setGameObjectDepth(e){return this.gameObjectDepth=e,this}setViewportCoordinateEnable(e){return void 0===e&&(e=!0),this.viewportCoordinateEnable=e,this}setEffectPropertiesConfig(e){return void 0===e&&(e=!0),this.effectPropertiesConfig=e,this}setViewport(e){return void 0===e&&(e=xe(this.scene,this.scene.cameras.main)),this.viewport=e,this}setSymbols(e){return this.symbols=e,this}get isEmpty(){return function(e){for(var t in e)return!1;return!0}(this.bobs)&&0===this.removedGOs.length}}Object.assign(je.prototype,e,we);const Te=Phaser.GameObjects.GameObject,Ge=Phaser.GameObjects.Layer,Fe=Phaser.GameObjects.Layer;var Le=function(e){var t=e.displayList;return function(e){return e instanceof Fe}(t)?t:null},Re={getLayer(e){return this.getGO(e)},getLayers(e){return void 0===e&&(e=[]),this.forEachGO((function(t){e.push(t)})),function(e,t){if(e.length<=1)return e;var r;void 0===t&&(t=!1);for(var n=0,i=e.length;n<i;n++){var o=e[n];if(o.displayList?r=o.displayList:o.parentContainer&&(r=o.parentContainer.list),r)break}r||(r=o.scene.sys.displayList),r.depthSort&&(r.depthSort(),r=r.list),t?e.sort((function(e,t){return r.indexOf(t)-r.indexOf(e)})):e.sort((function(e,t){return r.indexOf(e)-r.indexOf(t)}))}(e,!1),e},addToLayer(e,t){var r=this.getGO(e);if(r){Array.isArray(t)||(t=[t]);for(var n=0,i=t.length;n<i;n++){var o=t[n];o.isRexContainerLite?o.addToLayer(r):r.add(o)}return void 0!==r.scrollFactorX&&o.setScrollFactor(r.scrollFactorX,r.scrollFactorY),this}console.warn(`[LayerManager] Can't get layer "${e}"`)},addToBottomLayer(e){var t=this.getLayers()[0];return this.addToLayer(t.goName,e),this},addToTopLayer(e){var t=this.getLayers(),r=t[t.length-1];return this.addToLayer(r.goName,e),this},removeFromLayer(e,t,r){var n=this.getGO(e);if(n)return void 0===r&&(r=!0),t.isRexContainerLite?t.removeFromLayer(n,r):(n.remove(t),r&&t.addToDisplayList()),this;console.warn(`[LayerManager] Can't get layer "${e}"`)},clearLayer(e,t){void 0===t&&(t=!0);var r=this.getGO(e);if(r){if(t)for(var n=r.getAll(),i=0,o=n.length;i<o;i++)n[i].destroy();else r.removeAll();return this}console.warn(`Can't get layer "${e}"`)}},ke={setScrollFactor(e,t,r){void 0===r&&(r=t);var n=this.getLayer(e);if(!n)return this;n.scrollFactorX=t,n.scrollFactorY=r;for(var i=n.getAll(),o=0,s=i.length;o<s;o++)i[o].setScrollFactor(t,r);return this}};const Me=Phaser.Utils.Array;var Ne={bringMeToTop:function(){var e;return this.parentContainer?e=this.parentContainer.list:this.displayList&&(e=this.displayList.list),e?(Me.BringToTop(e,this),this):this},sendMeToBack:function(){var e;return this.parentContainer?e=this.parentContainer.list:this.displayList&&(e=this.displayList.list),e?(Me.SendToBack(e,this),this):this},moveMyDepthBelow:function(e){var t;return e.parentContainer?-1===(t=e.parentContainer.list).indexOf(this)&&e.parentContainer.add(this):e.displayList&&-1===(t=e.displayList.list).indexOf(this)&&e.displayList.add(this),t?(Me.MoveBelow(t,this,e),this):this},moveMyDepthAbove:function(e){var t;return e.parentContainer?-1===(t=e.parentContainer.list).indexOf(this)&&(e.isRexContainerLite?e.addToContainer(e.parentContainer):e.parentContainer.add(e)):e.displayList&&-1===(t=e.displayList.list).indexOf(this)&&(e.isRexContainerLite?e.addToLayer(e.displayList):e.displayList.add(e)),t?(Me.MoveAbove(t,this,e),this):this}},Ae={bringLayerToTop(e){var t=this.getLayer(e);return t?(Ne.bringMeToTop.call(t),this):this},sendLayerToBack(e){var t=this.getLayer(e);return t?(Ne.sendMeToBack.call(t),this):this},moveLayerBelow(e,t){if(e===t)return this;var r=this.getLayer(e),n=this.getLayer(t);return r&&n?(Ne.moveMyDepthBelow.call(r,n),this):this},moveLayerAbove(e,t){if(e===t)return this;var r=this.getLayer(e),n=this.getLayer(t);return r&&n?(Ne.moveMyDepthAbove.call(r,n),this):this}};const Be=je.prototype.setCamera;var De={setCamera(e,t){var r=_e(this.scene,t);return r||(r=this.scene.cameras.add(void 0,void 0,void 0,void 0,!1,t)),Be.call(this,e,r),this}},We={};Object.assign(We,Re,ke,Ae,De);const Xe=Phaser.Utils.Objects.GetValue;class Ue extends je{constructor(e,t){void 0===t?t={}:Array.isArray(t)&&(t={layers:t}),t.hasOwnProperty("fade")||(t.fade=0),t.viewportCoordinate=!1,super(e,t);var r=Xe(t,"rootLayer");this.setRootLayer(r);var n=Xe(t,"layers");if(n)for(var i=0,o=n.length;i<o;i++){var s=n[i];if("string"==typeof s)this.add(s);else{var a=s.name;this.add(a);var l=s.scrollFactor,c=Xe(s,"scrollFactorX",l),f=Xe(s,"scrollFactorY",l);void 0!==c&&this.setScrollFactor(a,c,f),this.setCamera(a,s.cameraName)}}}setCreateGameObjectCallback(e,t){return e||(e=Ye),super.setCreateGameObjectCallback(e,t),this}setRootLayer(e){if(e===this.rootLayer)return this;var t=this.getAllGO();return e?e.add(t):this.scene.displayList.add(t),this.rootLayer=e,this}addGO(e,t){return super.addGO(e,t),t.name=e,this.rootLayer&&this.rootLayer.add(t),this}get(e,t){if((n=e)instanceof Te||n instanceof Ge){var r=Le(e);if(!r)return;if(!(e=r.name))return}var n;return super.get(e,t)}}var Ye=function(e,t){var r=e.add.layer();return void 0!==t&&r.setDepth(t),r};Object.assign(Ue.prototype,We);class ze extends Phaser.Plugins.BasePlugin{constructor(e){super(e)}start(){this.game.events.on("destroy",this.destroy,this)}add(e,t){return new Ue(e,t)}}return ze},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexlayermanagerplugin=t();
