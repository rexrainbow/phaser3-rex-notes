var e,t;e=void 0,t=function(){const e=Phaser.GameObjects.GetCalcMatrix;var t={multiTexturing:!1,smoothPixelArt:!1},r={renderWebGL:function(r,s,i,a){var n=i.camera;if(n.addToRenderList(s),!s.skipRender()){var o,h=e(s,n,a).calc;s.dirty&&s.updateBuffers();var l=s.texture;o=l&&null!==l.smoothPixelArt?l.smoothPixelArt:s.scene.sys.game.config.smoothPixelArt,t.smoothPixelArt=o,(s.customRenderNodes.BatchHandler||s.defaultRenderNodes.BatchHandler).batchTriangles(i,s,h,s.texture.source[0].glTexture,s.vertexBuffer,s.uvBuffer,s.colorBuffer,s.alphaBuffer,s.alpha,s.tintFill,t,s.debugCallback)}},renderCanvas:function(e,t,r,s){},skipRender:function(){return 0===this.faces.length}};const s=Phaser.Math.RotateAround;var i={};const a=Phaser.Math.Linear,n=Phaser.Math.RotateAround;class o{constructor(){this.parent=void 0,this.name="",this.u=0,this.v=0,this.frameU=0,this.frameV=0,this.frameX=0,this.frameY=0,this._dx=0,this._dy=0,this.localX=0,this.localY=0,this.alpha=1,this.color=16777215}setParent(e){return this.parent=e,this}setName(e){return this.name=e,this}get frameU(){return this._frameU}set frameU(e){this._frameU!==e&&(this._frameU=e,this.parent&&this.parent.setUVDirtyFlag())}get frameV(){return this._frameV}set frameV(e){this._frameV!==e&&(this._frameV=e,this.parent&&this.parent.setUVDirtyFlag())}get frameX(){return this._frameX}set frameX(e){this._frameX!==e&&(this._frameX=e,this._localX=e+this._dx,this.parent&&this.parent.setVertexDirtyFlag())}get frameY(){return this._frameY}set frameY(e){this._frameY!==e&&(this._frameY=e,this._localY=e+this._dy,this.parent&&this.parent.setVertexDirtyFlag())}get localX(){return this._localX}set localX(e){this._localX!==e&&(this._localX=e,this._dx=e-this._frameX,this.parent&&this.parent.setVertexDirtyFlag())}get localY(){return this._localY}set localY(e){this._localY!==e&&(this._localY=e,this._dy=e-this._frameY,this.parent&&this.parent.setVertexDirtyFlag())}get alpha(){return this._alpha}set alpha(e){this._alpha!==e&&(this._alpha=e,this.parent&&this.parent.setAlphaDirtyFlag())}get color(){return this._color}set color(e){this._color!==e&&(this._color=e,this.parent&&this.parent.setColorDirtyFlag())}setUV(e,t){return this.u=e,this.v=t,this}setFrameUV(e,t,r,s){return this.frameU=a(e,r,this.u),this.frameV=a(t,s,this.v),this}setFrameSize(e,t){return this.frameX=this.u*e,this.frameY=this.v*t,this}resetPosition(){return this.localX=this.frameX,this.localY=this.frameY,this}setLocalPosition(e,t){return this.localX=e,this.localY=t,this}rotateAround(e,t,r){return h.x=this.localX,h.y=this.localY,n(h,e,t,r),this.localX=h.x,this.localY=h.y,this}setAlpha(e){return this.alpha=e,this}setColor(e){return this.color=e,this}getWorldXY(e){return this.parent?function(e,t,r,a){void 0===a?a={}:!0===a&&(a=i);var n=e.displayOriginX,o=e.displayOriginY;return a.x=t-n,a.y=r-o,s(a,0,0,e.rotation),a.x*=e.scaleX,a.y*=e.scaleY,a.x+=e.x,a.y+=e.y,a}(this.parent,this.localX,this.localY,e):null}setWorldXY(e,t){var r=function(e,t,r,a){void 0===a?a={}:!0===a&&(a=i);var n=e.displayOriginX,o=e.displayOriginY;return a.x=t-e.x,a.y=r-e.y,a.x/=e.scaleX,a.y/=e.scaleY,s(a,0,0,-e.rotation),a.x+=n,a.y+=o,a}(this.parent,e,t,!0);return this.setLocalPosition(r.x,r.y),this}setPosition(e,t){return this.setWorldXY(e,t),this}get x(){return this.parent?this.getWorldXY(!0).x:null}set x(e){this.setWorldXY(e,this.y)}get y(){return this.parent?this.getWorldXY(!0).y:null}set y(e){this.setWorldXY(this.x,e)}}var h={};const l=Phaser.Geom.Triangle.InCenter;var c={},u={};const d=Phaser.Math.RadToDeg,f=Phaser.Math.DegToRad;class v{constructor(e,t,r){void 0===e&&(e=new o),void 0===t&&(t=new o),void 0===r&&(r=new o),this.parent=void 0,this.name="",this.vertices=[e,t,r],this._localOffsetX=0,this._localOffsetY=0,this._rotation=0,this._alpha=1,this._color=16777215}setParent(e){return this.parent=e,this.vertices[0].setParent(e),this.vertices[1].setParent(e),this.vertices[2].setParent(e),this}setName(e){return this.name=e,this}get vertex0(){return this.vertices[0]}set vertex0(e){this.vertices[0]=e}get vertex1(){return this.vertices[1]}set vertex1(e){this.vertices[1]=e}get vertex2(){return this.vertices[2]}set vertex2(e){this.vertices[2]=e}get localOffsetX(){return this._localOffsetX}set localOffsetX(e){e!==this._localOffsetX&&(this._localOffsetX=e,this.updateVerticesPosition())}get localOffsetY(){return this._localOffsetY}set localOffsetY(e){e!==this._localOffsetY&&(this._localOffsetY=e,this.updateVerticesPosition())}get rotation(){return this._rotation}set rotation(e){if(e!==this._rotation){this._rotation=e;var t,r,s=(t=this,void 0===(r=!0)?r={}:!0===r&&(r=u),c.x1=t.vertices[0].localX,c.y1=t.vertices[0].localY,c.x2=t.vertices[1].localX,c.y2=t.vertices[1].localY,c.x3=t.vertices[2].localX,c.y3=t.vertices[2].localY,l(c,r)),i=s.x,a=s.y;this.vertices[0].rotateAround(i,a,e),this.vertices[1].rotateAround(i,a,e),this.vertices[2].rotateAround(i,a,e)}}get angle(){return d(this._rotation)}set angle(e){this.rotation=f(e)}get alpha(){return this._alpha}set alpha(e){this._alpha!==e&&(this._alpha=e,this.vertices[0].setAlpha(e),this.vertices[1].setAlpha(e),this.vertices[2].setAlpha(e))}get color(){return this._color}set color(e){this._color!==e&&(this._color=e,this.vertices[0].setColor(e),this.vertices[1].setColor(e),this.vertices[2].setColor(e))}get isPositionModified(){return 0!==this._localOffsetX||0!==this._localOffsetY||0!==this._rotation}setUV(e,t,r,s,i,a){return this.vertices[0].setUV(e,t),this.vertices[1].setUV(r,s),this.vertices[2].setUV(i,a),this}setFrameUV(e,t,r,s){return this.vertices[0].setFrameUV(e,t,r,s),this.vertices[1].setFrameUV(e,t,r,s),this.vertices[2].setFrameUV(e,t,r,s),this}setFrameSize(e,t){for(var r=0,s=this.vertices.length;r<s;r++)this.vertices[r].setFrameSize(e,t);return this.isPositionModified&&this.updateVerticesPosition(),this}setLocalOffset(e,t){return this.localOffsetX=e,this.localOffsetY=t,this}resetVerticesPosition(){for(var e=0,t=this.vertices.length;e<t;e++)this.vertices[e].resetPosition();return this.isPositionModified&&this.updateVerticesPosition(),this}updateVerticesPosition(){for(var e=this._localOffsetX,t=this._localOffsetY,r=this.vertices,s=0,i=r.length;s<i;s++){var a=r[s];a.setLocalPosition(a.frameX+e,a.frameY+t)}var n=this.rotation;return this._rotation=0,this.rotation=n,this}setRotation(e){return this.rotation=e,this}setAngle(e){return this.angle=e,this}setAlpha(e){return this.alpha=e,this}setColor(e){return this.color=e,this}}const g=Phaser.Utils.Array.GetFirst;var p={clear(){return this.faces.length=0,this.vertices.length=0,this.setFaceCountDirtyFlag(),this},createVertex(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var r=new o;return r.setUV(e,t),r},createFace:(e,t,r)=>new v(e,t,r),addFace(e){if(this.faces.includes(e))return this;e.setParent(this),this.faces.push(e),this.setFaceCountDirtyFlag();var t=this.frame;e.setFrameSize(t.cutWidth,t.cutHeight).setFrameUV(t.u0,t.v0,t.u1,t.v1).resetVerticesPosition();var r=this.vertices;return e.vertices.forEach((function(e){r.includes(e)||r.push(e)})),this},addFaces(e){for(var t=0,r=e.length;t<r;t++)this.addFace(e[t]);return this},addGridFaces(e,t,r){return function(e,t,r,s){if(function(e){if("object"!=typeof e||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!{}.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0}(t)){var i=t;t=i.columns,r=i.rows,s=i.sharedVertexMode}void 0===t&&(t=1),void 0===r&&(r=1),void 0===s&&(s=!1);var a,n,o,h,l,c=[];if(s){a=[];for(var u=0;u<=r;u++)for(var d=0;d<=t;d++){var f=e.createVertex(d/t,u/r);a.push(f)}}for(u=0;u<r;u++)for(d=0;d<t;d++)if(s){var v=u*(t+1)+d,g=v+1,p=(u+1)*(t+1)+d,m=p+1,y=a[v],x=a[g],P=a[p],w=a[m];l=e.createFace(y,w,P),e.addFace(l),c.push(l),l=e.createFace(y,x,w),e.addFace(l),c.push(l)}else{var b=d/t,O=(d+1)/t,_=u/r,F=(u+1)/r;n=e.createVertex(b,_),o=e.createVertex(b,F),h=e.createVertex(O,F),l=e.createFace(n,o,h),e.addFace(l),c.push(l),n=e.createVertex(b,_),o=e.createVertex(O,F),h=e.createVertex(O,_),l=e.createFace(n,o,h),e.addFace(l),c.push(l)}s&&e.vertices.sort((function(e,t){return e.v===t.v?e.u-t.u:e.v-t.v}))}(this,e,t,r),this},getVertexByName(e){return g(this.vertices,"name",e)},getFaceByName(e){return g(this.faces,"name",e)},resetVerticesPosition(){for(var e=this.vertices,t=0,r=e.length;t<r;t++)e[t].resetPosition();return this}},m={clearDirtyFlag(){return this.dirtyFlags=0,this},setFaceCountDirtyFlag(){return this.dirtyFlags|=31,this},setUVDirtyFlag(){return this.dirtyFlags|=2,this},setVertexDirtyFlag(){return this.dirtyFlags|=4,this},setAlphaDirtyFlag(){return this.dirtyFlags|=8,this},setColorDirtyFlag(){return this.dirtyFlags|=16,this}},y={updateBuffers(){return this.dirty?(1&this.dirtyFlags&&this.resizeBuffers(),2&this.dirtyFlags&&this.updateUVBuffer(),4&this.dirtyFlags&&this.updateVertexBuffer(),8&this.dirtyFlags&&this.updateAlphaBuffer(),16&this.dirtyFlags&&this.updateColorBuffer(),this.clearDirtyFlag(),this):this},resizeBuffers(){var e=this.faces.length;return this.vertexBuffer=new Float32Array(6*e),this.uvBuffer=new Float32Array(6*e),this.colorBuffer=new Uint32Array(3*e),this.alphaBuffer=new Float32Array(3*e),this},updateUVBuffer(){for(var e,t,r=this.uvBuffer,s=this.faces,i=0,a=s.length;i<a;i++)t=s[i].vertices,r[e=6*i]=t[0].frameU,r[e+1]=t[0].frameV,r[e+2]=t[1].frameU,r[e+3]=t[1].frameV,r[e+4]=t[2].frameU,r[e+5]=t[2].frameV;return this},updateVertexBuffer(){for(var e,t,r=this.vertexBuffer,s=this.faces,i=0,a=s.length;i<a;i++)t=s[i].vertices,r[e=6*i]=t[0].localX,r[e+1]=t[0].localY,r[e+2]=t[1].localX,r[e+3]=t[1].localY,r[e+4]=t[2].localX,r[e+5]=t[2].localY;return this},updateAlphaBuffer(){for(var e,t,r=this.alphaBuffer,s=this.faces,i=0,a=s.length;i<a;i++)t=s[i].vertices,r[e=3*i]=t[0].alpha,r[e+1]=t[1].alpha,r[e+2]=t[2].alpha;return this},updateColorBuffer(){for(var e,t,r=this.colorBuffer,s=this.faces,i=0,a=s.length;i<a;i++)t=s[i].vertices,r[e=3*i]=t[0].color,r[e+1]=t[1].color,r[e+2]=t[2].color;return this}},x={setTintFill(e){return void 0===e&&(e=!1),this.tintFill=e,this},setTint(e){return this.tint=e,this},clearTint(){return this.setTint(16777215),this}},P={setDebug(e,t){return this.debugGraphic=e,this.debugCallback=e||t?t||this.renderDebugVerts:null,this},renderDebugVerts(e,t,r){for(var s=e.debugGraphic,i=0;i<t;i+=6){var a=r[i+0],n=r[i+1],o=r[i+2],h=r[i+3],l=r[i+4],c=r[i+5];s.lineBetween(a,n,o,h),s.lineBetween(o,h,l,c),s.lineBetween(l,c,a,n)}}},w={};Object.assign(w,p,m,y,x,P);const b=Phaser.Renderer.WebGL.Shaders.MultiFrag,O=Phaser.Renderer.WebGL.Shaders.MultiVert,_=Phaser.Renderer.WebGL.ShaderAdditionMakers,F=_.MakeApplyTint,Y=_.MakeDefineTexCount,X=_.MakeGetTexCoordOut,V=_.MakeGetTexRes,B=_.MakeSmoothPixelArt,T=_.MakeGetTexture,k=Phaser.Renderer.WebGL.Utils,R=Phaser.Renderer.WebGL.RenderNodes.BatchHandlerQuad,A=k.getTintAppendFloatAlpha;class j extends R{constructor(e,t){super(e,t),this.renderOptions.multiTexturing=!0}_generateElementIndices(e){for(var t=new ArrayBuffer(5*e*2),r=new Uint16Array(t),s=0,i=0;i<e;i++){var a=3*i;r[s++]=a,r[s++]=a,r[s++]=a+1,r[s++]=a+2,r[s++]=a+2}return t}batchTriangles(e,t,r,s,i,a,n,o,h,l,c,u){0===this.instanceCount&&this.manager.setCurrentBatchNode(this,e);var d=i.length/(2*this.verticesPerInstance);if(d>this.instancesPerBatch)throw new Error("rexBatchHandlerTriangle: Vertex count exceeds maximum per batch ("+this.maxVerticesPerBatch+")");this.instanceCount+d>this.instancesPerBatch&&this.run(e),this.updateRenderOptions(c),this._renderOptionsChanged&&(this.run(e),this.updateShaderConfig());var f,v=this.batchTextures(s),g=this.instanceCount*this.floatsPerInstance,p=this.vertexBufferLayout.buffer,m=p.viewF32,y=p.viewU32,x=e.camera.roundPixels;u&&(f=[]);for(var P=r.a,w=r.b,b=r.c,O=r.d,_=r.e,F=r.f,Y=-t.displayOriginX,X=-t.displayOriginY,V=i.length,B=0;B<V;B+=6){for(var T=0;T<3;T++){var k=B+2*T,R=i[k],j=i[k+1],G=(R+=Y)*P+(j+=X)*b+_,D=R*w+j*O+F;x&&(G=Math.round(G),D=Math.round(D));var C=B/2+T,S=A(n[C],o[C]*h);m[g++]=G,m[g++]=D,m[g++]=a[k],m[g++]=a[k+1],m[g++]=v,m[g++]=l,y[g++]=S,f&&f.push(G,D)}this.instanceCount++,this.currentBatchEntry.count++}u&&u.call(t,t,V,f)}}j.prototype.defaultConfig={name:"rexBatchHandlerTriangle",verticesPerInstance:3,indicesPerInstance:5,shaderName:"REXTRI",vertexSource:O,fragmentSource:b,shaderAdditions:[X(),V(!0),B(!0),Y(1),T(),F()],vertexBufferLayout:{usage:"DYNAMIC_DRAW",layout:[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexDatum"},{name:"inTintEffect"},{name:"inTint",size:4,type:"UNSIGNED_BYTE",normalized:!0}]}};const G=Phaser.Game;var D=function(e){return e instanceof G};const C=Phaser.Scene;var S=function(e){return e instanceof C},U=function(e,t,r){var s,i=(s=e,null==s||"object"!=typeof s?null:D(s)?s:D(s.game)?s.game:S(s)?s.sys.game:S(s.scene)?s.scene.sys.game:void 0).renderer.renderNodes;i.hasNode(t,!0)||i.addNodeConstructor(t,r)};const M=Phaser.GameObjects.GameObject,L=new Phaser.Structs.Map([["BatchHandler","rexBatchHandlerTriangles"]]);let W=class extends M{constructor(e,t,r,s,i){void 0===t&&(t=0),void 0===r&&(r=0),void 0===s&&(s="__DEFAULT"),super(e,"rexMeshImage"),this.dirtyFlags=0,this.vertices=[],this.faces=[],this.vertexBuffer=null,this.uvBuffer=null,this.alphaBuffer=null,this.colorBuffer=null,this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.setTexture(s,i),this.setPosition(t,r),this.setSizeToFrame(),this.setOriginFromFrame(),U(e,"rexBatchHandlerTriangles",j),this.initRenderNodes(this._defaultRenderNodesMap)}get _defaultRenderNodesMap(){return L}get dirty(){return 0!==this.dirtyFlags}get frame(){return this._frame}set frame(e){if(this._frame!==e){this._frame=e;var t=this.faces;if(t){var r,s=e?e.u0:0,i=e?e.v0:0,a=e?e.u1:0,n=e?e.v1:0,o=e?e.cutWidth:0,h=e?e.cutHeight:0,l=this._frameWidthSave!==o||this._frameHeightSave!==h;this._frameWidthSave=o,this._frameHeightSave=h;for(var c=0,u=t.length;c<u;c++)(r=t[c]).setFrameUV(s,i,a,n),l&&r.setFrameSize(o,h)}}}get tint(){return this.faces.length>0?this.faces[0].color:16777215}set tint(e){for(var t=this.faces,r=0,s=t.length;r<s;r++)t[r].setColor(e)}addedToScene(){this.scene.sys.updateList.add(this)}removedFromScene(){this.scene.sys.updateList.remove(this)}};const N=Phaser.GameObjects.Components;Phaser.Class.mixin(W,[N.AlphaSingle,N.BlendMode,N.Depth,N.Flip,N.Mask,N.Origin,N.RenderNodes,N.Size,N.Texture,N.Transform,N.Visible,N.ScrollFactor,r,w]);var I={play(e,t){return this.anims.play(e,t)},playReverse(e,t){return this.anims.playReverse(e,t)},playAfterDelay(e,t){return this.anims.playAfterDelay(e,t)},playAfterRepeat(e,t){return this.anims.playAfterRepeat(e,t)},chain(e){return this.anims.chain(e)},stop(){return this.anims.stop()},stopAfterDelay(e){return this.anims.stopAfterDelay(e)},stopAfterRepeat(e){return this.anims.stopAfterRepeat(e)},stopOnFrame(e){return this.anims.stopOnFrame(e)}},z={};Object.assign(z,I);const H=Phaser.Animations.AnimationState;class E extends W{constructor(e,t,r,s,i){super(e,t,r,s,i),this.type="rexMeshSprite",this.anims=new H(this)}preUpdate(e,t){this.anims.update(e,t)}preDestroy(){this.anims.destroy(),this.anims=void 0}}Object.assign(E.prototype,z);const Q=[0,2,3,0,3,1],q=[1,3,2,1,2,0],J=[0,3,4,0,4,1,1,4,2,4,5,2,3,6,4,6,7,4,4,7,8,4,8,5],K=Phaser.Utils.Objects.IsPlainObject,Z=Phaser.Utils.Objects.GetValue;class $ extends E{constructor(e,t,r,s,i,a){K(t)&&(t=Z(a=t,"x",0),r=Z(a,"y",0),s=Z(a,"key",null),i=Z(a,"frame",null)),super(e,t,r,s,i),this.type="rexQuadImage",this.isNinePointMode=Z(a,"ninePointMode",!1),this.fourPointsModeRTL=Z(a,"rtl",!1),function(e){for(var t,r=e.isNinePointMode,s=r?3:2,i=[],a=0;a<s;a++)for(var n=0;n<s;n++){var o=n/(s-1),h=a/(s-1),l=e.createVertex(o,h);i.push(l)}for(var c=0,u=(t=r?J:e.fourPointsModeRTL?q:Q).length;c<u;c+=3){var d=i[t[c+0]],f=i[t[c+1]],v=i[t[c+2]],g=e.createFace(d,f,v);e.addFace(g)}e.vertices.sort((function(e,t){return e.v===t.v?e.u-t.u:e.v-t.v})),r?(e.topLeft=i[0],e.topCenter=i[1],e.topRight=i[2],e.centerLeft=i[3],e.center=i[4],e.centerRight=i[5],e.bottomLeft=i[6],e.bottomCenter=i[7],e.bottomRight=i[8]):(e.topLeft=i[0],e.topRight=i[1],e.bottomLeft=i[2],e.bottomRight=i[3])}(this)}destroy(e){this.scene&&!this.ignoreDestroy&&super.destroy(e)}}function ee(e,t,r,s,i){var a=new $(this.scene,e,t,r,s,i);return this.scene.add.existing(a),a}const te=Phaser.Utils.Objects.GetAdvancedValue,re=Phaser.GameObjects.BuildGameObject;function se(e,t){void 0===e&&(e={}),void 0!==t&&(e.add=t);var r=te(e,"key",null),s=te(e,"frame",null),i=new $(this.scene,0,0,r,s,e);return re(this.scene,i,e),i}const ie=Phaser.Textures.DynamicTexture;var ae=function(e,t,r){return void 0===t&&(t=2),void 0===r&&(r=2),new ie(e.sys.textures,null,t,r)},ne=function(e){return void 0!==e.displayWidth?e.displayWidth:e.width},oe=function(e){return void 0!==e.displayHeight?e.displayHeight:e.height};const he=Phaser.Geom.Rectangle,le=Phaser.Math.Vector2,ce=Phaser.Math.RotateAround,ue=Phaser.GameObjects.Container;var de=function(e,t){if(void 0===t?t=new he:!0===t&&(void 0===fe&&(fe=new he),t=fe),e.getBounds&&!(e instanceof ue))return e.getBounds(t);var r,s,i,a,n,o,h,l;if(e.parentContainer){var c=e.parentContainer.getBoundsTransformMatrix();ve(e,t),c.transformPoint(t.x,t.y,t),r=t.x,s=t.y,ge(e,t),c.transformPoint(t.x,t.y,t),i=t.x,a=t.y,pe(e,t),c.transformPoint(t.x,t.y,t),n=t.x,o=t.y,me(e,t),c.transformPoint(t.x,t.y,t),h=t.x,l=t.y}else ve(e,t),r=t.x,s=t.y,ge(e,t),i=t.x,a=t.y,pe(e,t),n=t.x,o=t.y,me(e,t),h=t.x,l=t.y;return t.x=Math.min(r,i,n,h),t.y=Math.min(s,a,o,l),t.width=Math.max(r,i,n,h)-t.x,t.height=Math.max(s,a,o,l)-t.y,t},fe=void 0,ve=function(e,t,r){return void 0===t?t=new le:!0===t&&(void 0===ye&&(ye=new le),t=ye),e.getTopLeft?e.getTopLeft(t):(t.x=e.x-ne(e)*e.originX,t.y=e.y-oe(e)*e.originY,xe(e,t,r))},ge=function(e,t,r){return void 0===t?t=new le:!0===t&&(void 0===ye&&(ye=new le),t=ye),e.getTopRight?e.getTopRight(t):(t.x=e.x-ne(e)*e.originX+ne(e),t.y=e.y-oe(e)*e.originY,xe(e,t,r))},pe=function(e,t,r){return void 0===t?t=new le:!0===t&&(void 0===ye&&(ye=new le),t=ye),e.getBottomLeft?e.getBottomLeft(t):(t.x=e.x-ne(e)*e.originX,t.y=e.y-oe(e)*e.originY+oe(e),xe(e,t,r))},me=function(e,t,r){return void 0===t?t=new le:!0===t&&(void 0===ye&&(ye=new le),t=ye),e.getBottomRight?e.getBottomRight(t):(t.x=e.x-ne(e)*e.originX+ne(e),t.y=e.y-oe(e)*e.originY+oe(e),xe(e,t,r))},ye=void 0,xe=function(e,t,r){return void 0===r&&(r=!1),0!==e.rotation&&ce(t,e.x,e.y,e.rotation),r&&e.parentContainer&&e.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t};const Pe=Phaser.Geom.Rectangle,we=Phaser.Geom.Rectangle.Union;var be,Oe=function(e,t){var r=Array.isArray(e);if(void 0===t?t=r?[]:{}:function(e){if("object"!=typeof e||null===e)return e;if(Array.isArray(e))e.length=0;else for(var t in e)delete e[t]}(t),r){t.length=e.length;for(var s=0,i=e.length;s<i;s++)t[s]=e[s]}else for(var a in e)t[a]=e[a];return t};const _e=Phaser.GameObjects.GameObject,Fe=Phaser.GameObjects.Layer;var Ye=Phaser.Utils.Objects.GetValue,Xe=function(e){if(e){var t,r,s=e.gameObjects,i=e.renderTexture,a=e.saveTexture,n=Ye(e,"x",void 0),o=Ye(e,"y",void 0),h=Ye(e,"width",void 0),l=Ye(e,"height",void 0),c=Ye(e,"originX",0),u=Ye(e,"originY",0),d=Ye(e,"padding",0);if(void 0===h||void 0===l||void 0===n||void 0===o){var f=function(e,t){var r;void 0===t?t=new Pe:!0===t&&(void 0===be&&(be=new Pe),t=be),t.setTo(0,0,0,0);for(var s=!0,i=0,a=e.length;i<a;i++)if((r=e[i]).getBounds){var n=de(r,!0);s?(t.setTo(n.x,n.y,n.width,n.height),s=!1):we(n,t,t)}return t}(s,!0);void 0!==n&&void 0!==o?(h=2*Math.max(n-f.left,f.right-n),l=2*Math.max(o-f.top,f.bottom-o),c=.5,u=.5):(n=f.x,o=f.y,h=f.width,l=f.height,c=0,u=0),t=f.x,r=f.y}else t=n+(0-c)*h,r=o+(0-u)*l;t-=d,r-=d,h+=2*d,l+=2*d;var v,g=s[0].scene,p=g.sys.textures;return a&&!i&&(i=p.addDynamicTexture(a,h,l)),i||(i=g.add.renderTexture(0,0,h,l)),i.setPosition&&i.setPosition(n,o),i.width===h&&i.height===l||i.setSize(h,l),i.setOrigin&&i.setOrigin(c,u),i.camera.setScroll(t,r),s=function(e,t){if(e.length<=1)return e;var r;void 0===t&&(t=!1);for(var s=0,i=e.length;s<i;s++){var a=e[s];if(a.displayList?r=a.displayList:a.parentContainer&&(r=a.parentContainer.list),r)break}return r||(r=a.scene.sys.displayList),r.depthSort&&(r.depthSort(),r=r.list),t?e.sort((function(e,t){return r.indexOf(t)-r.indexOf(e)})):e.sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})),e}(Oe(s)),i.draw(s),a&&((v=i)instanceof _e||v instanceof Fe?i.saveTexture(a):i.key!==a&&p.renameTexture(i.key,key)),i}};const Ve=Phaser.Utils.Objects.IsPlainObject,Be=Phaser.Utils.Objects.GetValue;class Te extends ${constructor(e,t,r,s,i,a){Ve(t)&&(t=Be(a=t,"x",0),r=Be(a,"y",0),s=Be(a,"width",32),i=Be(a,"height",32)),super(e,t,r,ae(e,s,i),null,a),this.type="rexQuadRenderTexture",this.rt=this.texture}destroy(e){this.scene&&!this.ignoreDestroy&&(super.destroy(e),this.rt.destroy(),this.rt=null)}snapshot(e,t){return void 0===t&&(t={}),t.gameObjects=e,t.renderTexture=this.rt,Xe(t),this.width===this.frame.realWidth&&this.height===this.frame.realHeight||this.syncSize(),this}}function ke(e,t,r,s,i){var a=new Te(this.scene,e,t,r,s,i);return this.scene.add.existing(a),a}const Re=Phaser.Utils.Objects.GetAdvancedValue,Ae=Phaser.GameObjects.BuildGameObject;function je(e,t){void 0===e&&(e={}),void 0!==t&&(e.add=t);var r=Re(e,"width",32),s=Re(e,"height",32),i=new Te(this.scene,0,0,r,s,e);return Ae(this.scene,i,e),i}var Ge=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0);for(var s=e.displayOriginX,i=e.displayOriginY,a=Math.tan(t)*i,n=Math.tan(r)*s,o=e.vertices,h=0,l=o.length;h<l;h++){var c=o[h],u=c.frameX,d=c.frameY;d>i?c.localX=u+a:d<i&&(c.localX=u-a),u>s?c.localY=d+n:u<s&&(c.localY=d-n)}};const De=Phaser.Utils.Objects.IsPlainObject,Ce=Phaser.Utils.Objects.GetValue,Se=Phaser.Math.DegToRad,Ue=Phaser.Math.RadToDeg;class Me extends ${constructor(e,t,r,s,i){if(De(t)){var a=t;t=Ce(a,"x",0),r=Ce(a,"y",0),s=Ce(a,"key",null),i=Ce(a,"frame",null)}super(e,t,r,s,i),this.type="rexSkewmage",this._skewX=0,this._skewY=0}get skewX(){return this._skewX}set skewX(e){this._skewX=e,Ge(this,this._skewX,this._skewY)}get skewXDeg(){return Ue(this._skewX)}set skewXDeg(e){this.skewX=Se(e)}get skewY(){return this._skewY}set skewY(e){this._skewY=e,Ge(this,this._skewX,this._skewY)}get skewYDeg(){return Ue(this._skewY)}set skewYDeg(e){this.skewY=Se(e)}setSkewX(e){return this.skewX=e,this}setSkewY(e){return this.skewY=e,this}setSkew(e,t){return void 0===t&&(t=e),this.skewX=e,this.skewY=t,this}setSkewXDeg(e){return this.skewXDeg=e,this}setSkewYDeg(e){return this.skewYDeg=e,this}setSkewDeg(e,t){return void 0===t&&(t=e),this.skewXDeg=e,this.skewYDeg=t,this}}function Le(e,t,r,s){var i=new Me(this.scene,e,t,r,s);return this.scene.add.existing(i),i}const We=Phaser.Utils.Objects.GetAdvancedValue,Ne=Phaser.GameObjects.BuildGameObject;function Ie(e,t){void 0===e&&(e={}),void 0!==t&&(e.add=t);var r=We(e,"key",null),s=We(e,"frame",null),i=new Me(this.scene,0,0,r,s);return Ne(this.scene,i,e),i}const ze=Phaser.Utils.Objects.IsPlainObject,He=Phaser.Utils.Objects.GetValue;class Ee extends Me{constructor(e,t,r,s,i){if(ze(t)){var a=t;t=He(a,"x",0),r=He(a,"y",0),s=He(a,"width",32),i=He(a,"height",32)}super(e,t,r,ae(e,s,i),null),this.type="rexSkewRenderTexture",this.rt=this.texture}destroy(e){this.scene&&!this.ignoreDestroy&&(super.destroy(e),this.rt.destroy(),this.rt=null)}}function Qe(e,t,r,s){var i=new Ee(this.scene,e,t,r,s);return this.scene.add.existing(i),i}const qe=Phaser.Utils.Objects.GetAdvancedValue,Je=Phaser.GameObjects.BuildGameObject;function Ke(e,t){void 0===e&&(e={}),void 0!==t&&(e.add=t);var r=qe(e,"width",32),s=qe(e,"height",32),i=new Ee(this.scene,0,0,r,s);return Je(this.scene,i,e),i}const Ze=Phaser.Utils.Objects.GetValue;var $e=function(e,t){if(!e)return!1;for(var r=t.visibleSibling,s=0,i=r.length;s<i;s++)e.setChildVisible(r[s],!0);return r.length=0,e.setChildVisible(t,!1),t.isRunning=!1,!0},et=function(e){return class extends e{constructor(e,t){var r=e.scene;super(r,0,0,1,1,t),r.add.existing(this),function(e,t,r){t.visibleSibling=[],t.isRunning=!1,t.useParentBounds=Ze(r,"useParentBounds",!1),t.setPosition(e.x,e.y).setVisible(!1),e.pin(t)}(e,this,t)}destroy(e){this.scene&&!this.ignoreDestroy&&(this.exit(),super.destroy(e))}enter(){return function(e,t){if(!e)return!1;$e(e,t);var r=t.useParentBounds;Xe({gameObjects:e.getAllVisibleChildren(),renderTexture:t.rt,x:t.x,y:t.y,width:r?e.displayWidth:void 0,height:r?e.displayHeighth:void 0,originX:r?e.originX:void 0,originY:r?e.originY:void 0}),e.setChildVisible(t,!0);for(var s=t.visibleSibling,i=e.children,a=0,n=i.length;a<n;a++){var o=i[a];o.visible&&o!==t&&(e.setChildVisible(o,!1),s.push(o))}return t.isRunning=!0,!0}(this.rexContainer.parent,this)&&this.syncSize(),this}exit(){return $e(this.rexContainer.parent,this),this}}};class tt extends(et(Ee)){get skewState(){return this.isRunning}}var rt=function(e){return null==e||""===e||0===e.length},st=function(e,t,r,s){if(void 0===s&&(s="."),"object"==typeof e){if(rt(t)){if(null==r)return;"object"==typeof r&&(e=r)}else{"string"==typeof t&&(t=t.split(s));var i=t.pop(),a=function(e,t,r){var s=e;if(rt(t));else{var i;"string"==typeof t&&(t=t.split("."));for(var a=0,n=t.length;a<n;a++){var o;null!=s[i=t[a]]&&"object"==typeof s[i]||(o=a===n-1?void 0===r?{}:r:{},s[i]=o),s=s[i]}}return s}(e,t);a[i]=r}return e}};class it extends Phaser.Plugins.BasePlugin{constructor(e){super(e),e.registerGameObject("rexQuadImage",ee,se),e.registerGameObject("rexQuadRenderTexture",ke,je),e.registerGameObject("rexSkewImage",Le,Ie),e.registerGameObject("rexSkewRenderTexture",Qe,Ke)}start(){this.game.events.on("destroy",this.destroy,this)}addContainerSkew(e,t){return new tt(e,t)}}return st(window,"RexPlugins.GameObjects.QuadImage",$),st(window,"RexPlugins.GameObjects.QuadRenderTexture",Te),st(window,"RexPlugins.GameObjects.SkewImage",Me),st(window,"RexPlugins.GameObjects.SkewRenderTexture",Ee),st(window,"RexPlugins.GameObjects.ContainerSkew",tt),it},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexquadimageplugin=t();
