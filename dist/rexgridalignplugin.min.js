!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexgridalignplugin=e();}(undefined,(function(){function t(t,i,n){return i=s(i),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,e()?Reflect.construct(i,n||[],s(t).constructor):i.apply(t,n))}function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(t){}return (e=function(){return !!t})()}function i(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(t,"string");return "symbol"==typeof e?e:String(e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r);}}function o(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}var h=Math.sqrt(3),c=Math.sqrt(3),a=0,f=1,l=2,d=3,g=a,y=f,v=l,p=d,b={},x=a,w=f,k=l,O=d,m={},P={},_=a,W=f,T=l,X=d,Y=4/3,z=2/3,j={},S={},M=function(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var n=e.split("."),r=t,o=i,s=0;s<n.length;s++){if(!r.hasOwnProperty(n[s])){o=i;break}o=r[n[s]],r=r[n[s]];}return o}return i}return i},H=a,C=f,E=l,D=d,N=function(){function t(e){n(this,t),this.resetFromJSON(e);}return o(t,[{key:"resetFromJSON",value:function(t){this.setType(M(t,"staggeraxis",1),M(t,"staggerindex",1)),this.setDirectionMode(),this.setOriginPosition(M(t,"x",0),M(t,"y",0));var e=M(t,"size",void 0);void 0!==e?this.setCellRadius(e):this.setCellSize(M(t,"cellWidth",0),M(t,"cellHeight",0));}},{key:"setType",value:function(t,e){return "string"==typeof t&&(t=F[t]),"string"==typeof e&&(e=q[e]),this.staggeraxis=t,this.staggerindex=e,this.mode=0===t?0===e?D:E:0===e?C:H,this}},{key:"setDirectionMode",value:function(){return this.directions=6,this}},{key:"setOriginPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2;}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2;}},{key:"setCellSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"setCellRadius",value:function(t){this.size=t;var e={size:this.size,type:this.staggeraxis},i=function(t){return 0===t.type?2*t.size:h*t.size}(e),n=function(t){return 0===t.type?c*t.size:2*t.size}(e);return this.setCellSize(i,n),this}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t;}},{key:"cellHeight",get:function(){return this.height},set:function(t){this.height=t;}}]),t}(),R={getWorldXY:function(t,e,i){void 0===i?i={}:!0===i&&(i=b);var n=t*this.width,r=e*this.height;switch(this.mode){case g:1&e&&(n+=this._halfWidth),r*=.75;break;case y:1&e&&(n-=this._halfWidth),r*=.75;break;case v:n*=.75,1&t&&(r+=this._halfHeight);break;case p:n*=.75,1&t&&(r-=this._halfHeight);}return n+=this.x,r+=this.y,i.x=n,i.y=r,i},getWorldX:function(t,e){return this.getWorldXY(t,e,!0).x},getWorldY:function(t,e){return this.getWorldXY(t,e,!0).y},getTileXY:function(t,e,i){var n,r;switch(void 0===i?i={}:!0===i&&(i=S),t-=this.x,e-=this.y,this.mode){case _:case W:r=e*Y/this.height,n=t/this.width-z*(e/this.height);break;case T:case X:r=e/this.height-z*(t/this.width),n=t*Y/this.width;}var o=function(t,e,i){return void 0===i?i={}:!0===i&&(i=m),i.x=t,i.y=-t-e,i.z=e,i}(n,r,j);return function(t,e,i,n){"number"!=typeof t&&(t=(n=t).x,e=n.y,i=n.z),void 0===n?n={}:!0===n&&(n=m);var r=Math.round(t),o=Math.round(e),s=Math.round(i),u=Math.abs(r-t),h=Math.abs(o-e),c=Math.abs(s-i);u>h&&u>c?r=-o-s:h>c?o=-r-s:s=-r-o,n.x=r,n.y=o,n.z=s;}(o),function(t,e,i,n,r){switch(void 0===r?r={}:!0===r&&(r=P),t){case x:r.x=e+(n-(1&n))/2,r.y=n;break;case w:r.x=e+(n+(1&n))/2,r.y=n;break;case k:r.x=e,r.y=n+(e-(1&e))/2;break;case O:r.x=e,r.y=n+(e+(1&e))/2;}}(this.mode,o.x,o.y,o.z,i),i},getTileX:function(t,e){return this.getTileXY(t,e,!0).x},getTileY:function(t,e){return this.getTileXY(t,e,!0).y}};Object.assign(N.prototype,R);var F={y:0,x:1},q={even:0,odd:1},J=function(){},B=new Phaser.GameObjects.Zone({sys:{queueDepthSort:J,events:{once:J}}},0,0,1,1);B.setOrigin(0);var G=0,A=1,U=2,V=4,Z=6,I=8,K=10,L=12,Q=function(t){return void 0!==t.displayWidth?t.displayWidth:t.width},$=function(t){return void 0!==t.displayHeight?t.displayHeight:t.height},tt=function(t){var e=$(t);return t.y+e-e*t.originY},et=function(t){var e=Q(t);return t.x-e*t.originX+.5*e},it=function(t,e){var i=$(t);return t.y=e-i+i*t.originY,t},nt=function(t,e){var i=Q(t),n=i*t.originX;return t.x=e+n-.5*i,t},rt=function(t){var e=Q(t);return t.x-e*t.originX},ot=function(t,e){var i=Q(t);return t.x=e+i*t.originX,t},st=function(t){var e=Q(t);return t.x+e-e*t.originX},ut=function(t,e){var i=Q(t);return t.x=e-i+i*t.originX,t},ht=function(t,e){var i=$(t),n=i*t.originY;return t.y=e+n-.5*i,t},ct=function(t){var e=$(t);return t.y-e*t.originY+.5*e},at=function(t){var e=$(t);return t.y-e*t.originY},ft=function(t,e){var i=$(t);return t.y=e+i*t.originY,t},lt=[];lt[11]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),nt(t,et(e)+i),it(t,tt(e)+n),t},lt[K]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),ot(t,rt(e)-i),it(t,tt(e)+n),t},lt[L]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),ut(t,st(e)+i),it(t,tt(e)+n),t},lt[Z]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),function(t,e,i){nt(t,e),ht(t,i);}(t,et(e)+i,ct(e)+n),t},lt[V]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),ot(t,rt(e)-i),ht(t,ct(e)+n),t},lt[I]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),ut(t,st(e)+i),ht(t,ct(e)+n),t},lt[A]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),nt(t,et(e)+i),ft(t,at(e)-n),t},lt[G]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),ot(t,rt(e)-i),ft(t,at(e)-n),t},lt[U]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),ut(t,st(e)+i),ft(t,at(e)-n),t};var dt=function(t,e,i,n,r){return lt[i](t,e,n,r)},gt=Phaser.Utils.Objects.GetFastValue,yt=new N,vt={},pt={},bt=function(){function t(e){n(this,t),this.resetFromJSON(e);}return o(t,[{key:"resetFromJSON",value:function(t){this.setType(M(t,"type",0)),this.setDirectionMode(M(t,"dir",4)),this.setOriginPosition(M(t,"x",0),M(t,"y",0)),this.setCellSize(M(t,"cellWidth",0),M(t,"cellHeight",0));}},{key:"setType",value:function(t){return "string"==typeof t&&(t=wt[t]),this.mode=t,this}},{key:"setDirectionMode",value:function(t){return "string"==typeof t&&(t=kt[t]),this.directions=t,this}},{key:"setOriginPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2;}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2;}},{key:"setCellSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t;}},{key:"cellHeight",get:function(){return this.height},set:function(t){this.height=t;}}]),t}(),xt={getWorldXY:function(t,e,i){var n,r;switch(void 0===i?i={}:!0===i&&(i=vt),this.mode){case 0:n=t*this.width,r=e*this.height;break;case 1:n=(t-e)*this._halfWidth,r=(t+e)*this._halfHeight;}return n+=this.x,r+=this.y,i.x=n,i.y=r,i},getWorldX:function(t,e){return this.getWorldXY(t,e,!0).x},getWorldY:function(t,e){return this.getWorldXY(t,e,!0).y},getTileXY:function(t,e,i){void 0===i?i={}:!0===i&&(i=pt),t-=this.x,e-=this.y;var n=t/this.width,r=e/this.height;switch(this.mode){case 0:i.x=Math.round(n),i.y=Math.round(r);break;case 1:i.x=Math.round(+n+r),i.y=Math.round(-n+r);}return i},getTileX:function(t,e){return this.getTileXY(t,e,!0).x},getTileY:function(t,e){return this.getTileXY(t,e,!0).y}};Object.assign(bt.prototype,xt);var wt={orthogonal:0,isometric:1,staggered:2},kt={"4dir":4,"8dir":8},Ot=Phaser.Utils.Objects.GetFastValue,mt=new bt;return function(e){function i(e){return n(this,i),t(this,i,[e])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);}(i,Phaser.Plugins.BasePlugin),o(i,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this);}},{key:"hexagon",value:function(t,e){return function(t,e){void 0===e&&(e={});var i=gt(e,"width",-1),n=gt(e,"height",-1),r=gt(e,"cellWidth",1),o=gt(e,"cellHeight",r),s=gt(e,"staggeraxis",1),u=gt(e,"staggerindex",1),h=gt(e,"position",Phaser.Display.Align.CENTER),c=gt(e,"x",0),a=gt(e,"y",0);yt.setOriginPosition(c,a).setCellSize(r,o).setType(s,u),B.setSize(r,o);for(var f=n-1,l=i-1,d=0,g=0,y=0,v=t.length;y<v;y++)if(yt.getWorldXY(g,d,B),dt(t[y],B,h),-1===i)d++;else if(-1===n)g++;else if(g===l){if(d===f)break;g=0,d++;}else g++;return t}(t,e)}},{key:"quad",value:function(t,e){return function(t,e){void 0===e&&(e={});var i=Ot(e,"width",-1),n=Ot(e,"height",-1),r=Ot(e,"cellWidth",1),o=Ot(e,"cellHeight",r),s=Ot(e,"type",0),u=Ot(e,"position",Phaser.Display.Align.CENTER),h=Ot(e,"x",0),c=Ot(e,"y",0);mt.setOriginPosition(h,c).setCellSize(r,o).setType(s),B.setSize(r,o);for(var a=n-1,f=i-1,l=0,d=0,g=0,y=t.length;g<y;g++)if(mt.getWorldXY(d,l,B),dt(t[g],B,u),-1===i)l++;else if(-1===n)d++;else if(d===f){if(l===a)break;d=0,l++;}else d++;return t}(t,e)}}]),i}()}));
