var t,e;t=void 0,e=function(){const t=Phaser.GameObjects.GetCalcMatrix;var e={multiTexturing:!1,smoothPixelArt:!1},r={renderWebGL:function(r,s,i,a){var n=i.camera;if(n.addToRenderList(s),!s.skipRender()){var h,o=t(s,n,a).calc;s.dirty&&s.updateBuffers();var l=s.texture;h=l&&null!==l.smoothPixelArt?l.smoothPixelArt:s.scene.sys.game.config.smoothPixelArt,e.smoothPixelArt=h,(s.customRenderNodes.BatchHandler||s.defaultRenderNodes.BatchHandler).batchTriangles(i,s,o,s.texture.source[0].glTexture,s.vertexBuffer,s.uvBuffer,s.colorBuffer,s.alphaBuffer,s.alpha,s.tintFill,e,s.debugCallback)}},renderCanvas:function(t,e,r,s){},skipRender:function(){return 0===this.faces.length}};const s=Phaser.Math.RotateAround;var i=function(t,e,r,i){void 0===i?i={}:!0===i&&(i=a);var n=t.displayOriginX,h=t.displayOriginY;return i.x=e-t.x,i.y=r-t.y,i.x/=t.scaleX,i.y/=t.scaleY,s(i,0,0,-t.rotation),i.x+=n,i.y+=h,i},a={};const n=Phaser.Math.Linear,h=Phaser.Math.RotateAround;class o{constructor(){this.parent=void 0,this.name="",this.u=0,this.v=0,this.frameU=0,this.frameV=0,this.frameX=0,this.frameY=0,this._dx=0,this._dy=0,this.localX=0,this.localY=0,this.alpha=1,this.color=16777215}setParent(t){return this.parent=t,this}setName(t){return this.name=t,this}get frameU(){return this._frameU}set frameU(t){this._frameU!==t&&(this._frameU=t,this.parent&&this.parent.setUVDirtyFlag())}get frameV(){return this._frameV}set frameV(t){this._frameV!==t&&(this._frameV=t,this.parent&&this.parent.setUVDirtyFlag())}get frameX(){return this._frameX}set frameX(t){this._frameX!==t&&(this._frameX=t,this._localX=t+this._dx,this.parent&&this.parent.setVertexDirtyFlag())}get frameY(){return this._frameY}set frameY(t){this._frameY!==t&&(this._frameY=t,this._localY=t+this._dy,this.parent&&this.parent.setVertexDirtyFlag())}get localX(){return this._localX}set localX(t){this._localX!==t&&(this._localX=t,this._dx=t-this._frameX,this.parent&&this.parent.setVertexDirtyFlag())}get localY(){return this._localY}set localY(t){this._localY!==t&&(this._localY=t,this._dy=t-this._frameY,this.parent&&this.parent.setVertexDirtyFlag())}get alpha(){return this._alpha}set alpha(t){this._alpha!==t&&(this._alpha=t,this.parent&&this.parent.setAlphaDirtyFlag())}get color(){return this._color}set color(t){this._color!==t&&(this._color=t,this.parent&&this.parent.setColorDirtyFlag())}setUV(t,e){return this.u=t,this.v=e,this}setFrameUV(t,e,r,s){return this.frameU=n(t,r,this.u),this.frameV=n(e,s,this.v),this}setFrameSize(t,e){return this.frameX=this.u*t,this.frameY=this.v*e,this}resetPosition(){return this.localX=this.frameX,this.localY=this.frameY,this}setLocalPosition(t,e){return this.localX=t,this.localY=e,this}rotateAround(t,e,r){return l.x=this.localX,l.y=this.localY,h(l,t,e,r),this.localX=l.x,this.localY=l.y,this}setAlpha(t){return this.alpha=t,this}setColor(t){return this.color=t,this}getWorldXY(t){return this.parent?function(t,e,r,i){void 0===i?i={}:!0===i&&(i=a);var n=t.displayOriginX,h=t.displayOriginY;return i.x=e-n,i.y=r-h,s(i,0,0,t.rotation),i.x*=t.scaleX,i.y*=t.scaleY,i.x+=t.x,i.y+=t.y,i}(this.parent,this.localX,this.localY,t):null}setWorldXY(t,e){var r=i(this.parent,t,e,!0);return this.setLocalPosition(r.x,r.y),this}setPosition(t,e){return this.setWorldXY(t,e),this}get x(){return this.parent?this.getWorldXY(!0).x:null}set x(t){this.setWorldXY(t,this.y)}get y(){return this.parent?this.getWorldXY(!0).y:null}set y(t){this.setWorldXY(this.x,t)}}var l={};const c=Phaser.Geom.Triangle.InCenter;var u={},f={};const d=Phaser.Math.RadToDeg,v=Phaser.Math.DegToRad;class g{constructor(t,e,r){void 0===t&&(t=new o),void 0===e&&(e=new o),void 0===r&&(r=new o),this.parent=void 0,this.name="",this.vertices=[t,e,r],this._localOffsetX=0,this._localOffsetY=0,this._rotation=0,this._alpha=1,this._color=16777215}setParent(t){return this.parent=t,this.vertices[0].setParent(t),this.vertices[1].setParent(t),this.vertices[2].setParent(t),this}setName(t){return this.name=t,this}get vertex0(){return this.vertices[0]}set vertex0(t){this.vertices[0]=t}get vertex1(){return this.vertices[1]}set vertex1(t){this.vertices[1]=t}get vertex2(){return this.vertices[2]}set vertex2(t){this.vertices[2]=t}get localOffsetX(){return this._localOffsetX}set localOffsetX(t){t!==this._localOffsetX&&(this._localOffsetX=t,this.updateVerticesPosition())}get localOffsetY(){return this._localOffsetY}set localOffsetY(t){t!==this._localOffsetY&&(this._localOffsetY=t,this.updateVerticesPosition())}get rotation(){return this._rotation}set rotation(t){if(t!==this._rotation){this._rotation=t;var e,r,s=(e=this,void 0===(r=!0)?r={}:!0===r&&(r=f),u.x1=e.vertices[0].localX,u.y1=e.vertices[0].localY,u.x2=e.vertices[1].localX,u.y2=e.vertices[1].localY,u.x3=e.vertices[2].localX,u.y3=e.vertices[2].localY,c(u,r)),i=s.x,a=s.y;this.vertices[0].rotateAround(i,a,t),this.vertices[1].rotateAround(i,a,t),this.vertices[2].rotateAround(i,a,t)}}get angle(){return d(this._rotation)}set angle(t){this.rotation=v(t)}get alpha(){return this._alpha}set alpha(t){this._alpha!==t&&(this._alpha=t,this.vertices[0].setAlpha(t),this.vertices[1].setAlpha(t),this.vertices[2].setAlpha(t))}get color(){return this._color}set color(t){this._color!==t&&(this._color=t,this.vertices[0].setColor(t),this.vertices[1].setColor(t),this.vertices[2].setColor(t))}get isPositionModified(){return 0!==this._localOffsetX||0!==this._localOffsetY||0!==this._rotation}setUV(t,e,r,s,i,a){return this.vertices[0].setUV(t,e),this.vertices[1].setUV(r,s),this.vertices[2].setUV(i,a),this}setFrameUV(t,e,r,s){return this.vertices[0].setFrameUV(t,e,r,s),this.vertices[1].setFrameUV(t,e,r,s),this.vertices[2].setFrameUV(t,e,r,s),this}setFrameSize(t,e){for(var r=0,s=this.vertices.length;r<s;r++)this.vertices[r].setFrameSize(t,e);return this.isPositionModified&&this.updateVerticesPosition(),this}setLocalOffset(t,e){return this.localOffsetX=t,this.localOffsetY=e,this}resetVerticesPosition(){for(var t=0,e=this.vertices.length;t<e;t++)this.vertices[t].resetPosition();return this.isPositionModified&&this.updateVerticesPosition(),this}updateVerticesPosition(){for(var t=this._localOffsetX,e=this._localOffsetY,r=this.vertices,s=0,i=r.length;s<i;s++){var a=r[s];a.setLocalPosition(a.frameX+t,a.frameY+e)}var n=this.rotation;return this._rotation=0,this.rotation=n,this}setRotation(t){return this.rotation=t,this}setAngle(t){return this.angle=t,this}setAlpha(t){return this.alpha=t,this}setColor(t){return this.color=t,this}}const p=Phaser.Utils.Array.GetFirst;var m={clear(){return this.faces.length=0,this.vertices.length=0,this.setFaceCountDirtyFlag(),this},createVertex(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var r=new o;return r.setUV(t,e),r},createFace:(t,e,r)=>new g(t,e,r),addFace(t){if(this.faces.includes(t))return this;t.setParent(this),this.faces.push(t),this.setFaceCountDirtyFlag();var e=this.frame;t.setFrameSize(e.cutWidth,e.cutHeight).setFrameUV(e.u0,e.v0,e.u1,e.v1).resetVerticesPosition();var r=this.vertices;return t.vertices.forEach((function(t){r.includes(t)||r.push(t)})),this},addFaces(t){for(var e=0,r=t.length;e<r;e++)this.addFace(t[e]);return this},addGridFaces(t,e,r){return function(t,e,r,s){if(function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}(e)){var i=e;e=i.columns,r=i.rows,s=i.sharedVertexMode}void 0===e&&(e=1),void 0===r&&(r=1),void 0===s&&(s=!1);var a,n,h,o,l,c=[];if(s){a=[];for(var u=0;u<=r;u++)for(var f=0;f<=e;f++){var d=t.createVertex(f/e,u/r);a.push(d)}}for(u=0;u<r;u++)for(f=0;f<e;f++)if(s){var v=u*(e+1)+f,g=v+1,p=(u+1)*(e+1)+f,m=p+1,y=a[v],x=a[g],P=a[p],F=a[m];l=t.createFace(y,F,P),t.addFace(l),c.push(l),l=t.createFace(y,x,F),t.addFace(l),c.push(l)}else{var _=f/e,O=(f+1)/e,V=u/r,b=(u+1)/r;n=t.createVertex(_,V),h=t.createVertex(_,b),o=t.createVertex(O,b),l=t.createFace(n,h,o),t.addFace(l),c.push(l),n=t.createVertex(_,V),h=t.createVertex(O,b),o=t.createVertex(O,V),l=t.createFace(n,h,o),t.addFace(l),c.push(l)}s&&t.vertices.sort((function(t,e){return t.v===e.v?t.u-e.u:t.v-e.v}))}(this,t,e,r),this},getVertexByName(t){return p(this.vertices,"name",t)},getFaceByName(t){return p(this.faces,"name",t)},resetVerticesPosition(){for(var t=this.vertices,e=0,r=t.length;e<r;e++)t[e].resetPosition();return this}},y={clearDirtyFlag(){return this.dirtyFlags=0,this},setFaceCountDirtyFlag(){return this.dirtyFlags|=31,this},setUVDirtyFlag(){return this.dirtyFlags|=2,this},setVertexDirtyFlag(){return this.dirtyFlags|=4,this},setAlphaDirtyFlag(){return this.dirtyFlags|=8,this},setColorDirtyFlag(){return this.dirtyFlags|=16,this}},x={updateBuffers(){return this.dirty?(1&this.dirtyFlags&&this.resizeBuffers(),2&this.dirtyFlags&&this.updateUVBuffer(),4&this.dirtyFlags&&this.updateVertexBuffer(),8&this.dirtyFlags&&this.updateAlphaBuffer(),16&this.dirtyFlags&&this.updateColorBuffer(),this.clearDirtyFlag(),this):this},resizeBuffers(){var t=this.faces.length;return this.vertexBuffer=new Float32Array(6*t),this.uvBuffer=new Float32Array(6*t),this.colorBuffer=new Uint32Array(3*t),this.alphaBuffer=new Float32Array(3*t),this},updateUVBuffer(){for(var t,e,r=this.uvBuffer,s=this.faces,i=0,a=s.length;i<a;i++)e=s[i].vertices,r[t=6*i]=e[0].frameU,r[t+1]=e[0].frameV,r[t+2]=e[1].frameU,r[t+3]=e[1].frameV,r[t+4]=e[2].frameU,r[t+5]=e[2].frameV;return this},updateVertexBuffer(){for(var t,e,r=this.vertexBuffer,s=this.faces,i=0,a=s.length;i<a;i++)e=s[i].vertices,r[t=6*i]=e[0].localX,r[t+1]=e[0].localY,r[t+2]=e[1].localX,r[t+3]=e[1].localY,r[t+4]=e[2].localX,r[t+5]=e[2].localY;return this},updateAlphaBuffer(){for(var t,e,r=this.alphaBuffer,s=this.faces,i=0,a=s.length;i<a;i++)e=s[i].vertices,r[t=3*i]=e[0].alpha,r[t+1]=e[1].alpha,r[t+2]=e[2].alpha;return this},updateColorBuffer(){for(var t,e,r=this.colorBuffer,s=this.faces,i=0,a=s.length;i<a;i++)e=s[i].vertices,r[t=3*i]=e[0].color,r[t+1]=e[1].color,r[t+2]=e[2].color;return this}},P={setTintFill(t){return void 0===t&&(t=!1),this.tintFill=t,this},setTint(t){return this.tint=t,this},clearTint(){return this.setTint(16777215),this}},F={setDebug(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebugVerts:null,this},renderDebugVerts(t,e,r){for(var s=t.debugGraphic,i=0;i<e;i+=6){var a=r[i+0],n=r[i+1],h=r[i+2],o=r[i+3],l=r[i+4],c=r[i+5];s.lineBetween(a,n,h,o),s.lineBetween(h,o,l,c),s.lineBetween(l,c,a,n)}}},_={};Object.assign(_,m,y,x,P,F);const O=Phaser.Renderer.WebGL.Shaders.MultiFrag,V=Phaser.Renderer.WebGL.Shaders.MultiVert,b=Phaser.Renderer.WebGL.ShaderAdditionMakers,R=b.MakeApplyTint,Y=b.MakeDefineTexCount,B=b.MakeGetTexCoordOut,w=b.MakeGetTexRes,A=b.MakeSmoothPixelArt,T=b.MakeGetTexture,X=Phaser.Renderer.WebGL.Utils,U=Phaser.Renderer.WebGL.RenderNodes.BatchHandlerQuad,M=X.getTintAppendFloatAlpha;class j extends U{constructor(t,e){super(t,e),this.renderOptions.multiTexturing=!0}_generateElementIndices(t){for(var e=new ArrayBuffer(5*t*2),r=new Uint16Array(e),s=0,i=0;i<t;i++){var a=3*i;r[s++]=a,r[s++]=a,r[s++]=a+1,r[s++]=a+2,r[s++]=a+2}return e}batchTriangles(t,e,r,s,i,a,n,h,o,l,c,u){0===this.instanceCount&&this.manager.setCurrentBatchNode(this,t);var f=i.length/(2*this.verticesPerInstance);if(f>this.instancesPerBatch)throw new Error("rexBatchHandlerTriangle: Vertex count exceeds maximum per batch ("+this.maxVerticesPerBatch+")");this.instanceCount+f>this.instancesPerBatch&&this.run(t),this.updateRenderOptions(c),this._renderOptionsChanged&&(this.run(t),this.updateShaderConfig());var d,v=this.batchTextures(s),g=this.instanceCount*this.floatsPerInstance,p=this.vertexBufferLayout.buffer,m=p.viewF32,y=p.viewU32,x=t.camera.roundPixels;u&&(d=[]);for(var P=r.a,F=r.b,_=r.c,O=r.d,V=r.e,b=r.f,R=-e.displayOriginX,Y=-e.displayOriginY,B=i.length,w=0;w<B;w+=6){for(var A=0;A<3;A++){var T=w+2*A,X=i[T],U=i[T+1],j=(X+=R)*P+(U+=Y)*_+V,G=X*F+U*O+b;x&&(j=Math.round(j),G=Math.round(G));var C=w/2+A,S=M(n[C],h[C]*o);m[g++]=j,m[g++]=G,m[g++]=a[T],m[g++]=a[T+1],m[g++]=v,m[g++]=l,y[g++]=S,d&&d.push(j,G)}this.instanceCount++,this.currentBatchEntry.count++}u&&u.call(e,e,B,d)}}j.prototype.defaultConfig={name:"rexBatchHandlerTriangle",verticesPerInstance:3,indicesPerInstance:5,shaderName:"REXTRI",vertexSource:V,fragmentSource:O,shaderAdditions:[B(),w(!0),A(!0),Y(1),T(),R()],vertexBufferLayout:{usage:"DYNAMIC_DRAW",layout:[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexDatum"},{name:"inTintEffect"},{name:"inTint",size:4,type:"UNSIGNED_BYTE",normalized:!0}]}};const G=Phaser.Game;var C=function(t){return t instanceof G};const S=Phaser.Scene;var D=function(t){return t instanceof S},I=function(t,e,r){var s,i=(s=t,null==s||"object"!=typeof s?null:C(s)?s:C(s.game)?s.game:D(s)?s.sys.game:D(s.scene)?s.scene.sys.game:void 0).renderer.renderNodes;i.hasNode(e,!0)||i.addNodeConstructor(e,r)};const N=Phaser.GameObjects.GameObject,L=new Phaser.Structs.Map([["BatchHandler","rexBatchHandlerTriangles"]]);class k extends N{constructor(t,e,r,s,i){void 0===e&&(e=0),void 0===r&&(r=0),void 0===s&&(s="__DEFAULT"),super(t,"rexMeshImage"),this.dirtyFlags=0,this.vertices=[],this.faces=[],this.vertexBuffer=null,this.uvBuffer=null,this.alphaBuffer=null,this.colorBuffer=null,this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.setTexture(s,i),this.setPosition(e,r),this.setSizeToFrame(),this.setOriginFromFrame(),I(t,"rexBatchHandlerTriangles",j),this.initRenderNodes(this._defaultRenderNodesMap)}get _defaultRenderNodesMap(){return L}get dirty(){return 0!==this.dirtyFlags}get frame(){return this._frame}set frame(t){if(this._frame!==t){this._frame=t;var e=this.faces;if(e){var r,s=t?t.u0:0,i=t?t.v0:0,a=t?t.u1:0,n=t?t.v1:0,h=t?t.cutWidth:0,o=t?t.cutHeight:0,l=this._frameWidthSave!==h||this._frameHeightSave!==o;this._frameWidthSave=h,this._frameHeightSave=o;for(var c=0,u=e.length;c<u;c++)(r=e[c]).setFrameUV(s,i,a,n),l&&r.setFrameSize(h,o)}}}get tint(){return this.faces.length>0?this.faces[0].color:16777215}set tint(t){for(var e=this.faces,r=0,s=e.length;r<s;r++)e[r].setColor(t)}addedToScene(){this.scene.sys.updateList.add(this)}removedFromScene(){this.scene.sys.updateList.remove(this)}}const E=Phaser.GameObjects.Components;Phaser.Class.mixin(k,[E.AlphaSingle,E.BlendMode,E.Depth,E.Flip,E.Mask,E.Origin,E.RenderNodes,E.Size,E.Texture,E.Transform,E.Visible,E.ScrollFactor,r,_]);var W={play(t,e){return this.anims.play(t,e)},playReverse(t,e){return this.anims.playReverse(t,e)},playAfterDelay(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat(t,e){return this.anims.playAfterRepeat(t,e)},chain(t){return this.anims.chain(t)},stop(){return this.anims.stop()},stopAfterDelay(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat(t){return this.anims.stopAfterRepeat(t)},stopOnFrame(t){return this.anims.stopOnFrame(t)}},z={};Object.assign(z,W);const H=Phaser.Animations.AnimationState;class q extends k{constructor(t,e,r,s,i){super(t,e,r,s,i),this.type="rexMeshSprite",this.anims=new H(this)}preUpdate(t,e){this.anims.update(t,e)}preDestroy(){this.anims.destroy(),this.anims=void 0}}Object.assign(q.prototype,z);var Q={setRingRadiusList(t){return this.ringRadiusList=t,this},setSamplesPerRing(t){return this.samplesPerRing=t,this},setVariation(t){return this.variation=t,this}};function J(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var K={exports:{}};!function(t){var e;!function(){var r=1/1048576;function s(t,e,s,i){var a,n,h,o,l,c,u,f,d,v,g=t[e][0],p=t[e][1],m=t[s][0],y=t[s][1],x=t[i][0],P=t[i][1],F=Math.abs(p-y),_=Math.abs(y-P);if(F<r&&_<r)throw new Error("Eek! Coincident points!");return F<r?n=(o=-(x-m)/(P-y))*((a=(m+g)/2)-(c=(m+x)/2))+(f=(y+P)/2):_<r?n=(h=-(m-g)/(y-p))*((a=(x+m)/2)-(l=(g+m)/2))+(u=(p+y)/2):(a=((h=-(m-g)/(y-p))*(l=(g+m)/2)-(o=-(x-m)/(P-y))*(c=(m+x)/2)+(f=(y+P)/2)-(u=(p+y)/2))/(h-o),n=F>_?h*(a-l)+u:o*(a-c)+f),{i:e,j:s,k:i,x:a,y:n,r:(d=m-a)*d+(v=y-n)*v}}function i(t){var e,r,s,i,a,n;for(r=t.length;r;)for(i=t[--r],s=t[--r],e=r;e;)if(n=t[--e],s===(a=t[--e])&&i===n||s===n&&i===a){t.splice(r,2),t.splice(e,2);break}}e={triangulate:function(t,e){var a,n,h,o,l,c,u,f,d,v,g,p,m=t.length;if(m<3)return[];if(t=t.slice(0),e)for(a=m;a--;)t[a]=t[a][e];for(h=new Array(m),a=m;a--;)h[a]=a;for(h.sort((function(e,r){return t[r][0]-t[e][0]})),o=function(t){var e,r,s,i,a,n,h=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(e=t.length;e--;)t[e][0]<h&&(h=t[e][0]),t[e][0]>l&&(l=t[e][0]),t[e][1]<o&&(o=t[e][1]),t[e][1]>c&&(c=t[e][1]);return s=c-o,[[(a=h+.5*(r=l-h))-20*(i=Math.max(r,s)),(n=o+.5*s)-i],[a,n+20*i],[a+20*i,n-i]]}(t),t.push(o[0],o[1],o[2]),l=[s(t,m+0,m+1,m+2)],c=[],u=[],a=h.length;a--;u.length=0){for(p=h[a],n=l.length;n--;)(f=t[p][0]-l[n].x)>0&&f*f>l[n].r?(c.push(l[n]),l.splice(n,1)):f*f+(d=t[p][1]-l[n].y)*d-l[n].r>r||(u.push(l[n].i,l[n].j,l[n].j,l[n].k,l[n].k,l[n].i),l.splice(n,1));for(i(u),n=u.length;n;)g=u[--n],v=u[--n],l.push(s(t,v,g,p))}for(a=l.length;a--;)c.push(l[a]);for(l.length=0,a=c.length;a--;)c[a].i<m&&c[a].j<m&&c[a].k<m&&l.push(c[a].i,c[a].j,c[a].k);return l},contains:function(t,e){if(e[0]<t[0][0]&&e[0]<t[1][0]&&e[0]<t[2][0]||e[0]>t[0][0]&&e[0]>t[1][0]&&e[0]>t[2][0]||e[1]<t[0][1]&&e[1]<t[1][1]&&e[1]<t[2][1]||e[1]>t[0][1]&&e[1]>t[1][1]&&e[1]>t[2][1])return null;var r=t[1][0]-t[0][0],s=t[2][0]-t[0][0],i=t[1][1]-t[0][1],a=t[2][1]-t[0][1],n=r*a-s*i;if(0===n)return null;var h=(a*(e[0]-t[0][0])-s*(e[1]-t[0][1]))/n,o=(r*(e[1]-t[0][1])-i*(e[0]-t[0][0]))/n;return h<0||o<0||h+o>1?null:[h,o]}},t.exports=e}()}(K);var Z=J(K.exports);const $=Phaser.Geom.Triangle;var tt=function(t,e){void 0===e&&(e=!0);var r=Z.triangulate(t);if(e){for(var s=[],i=0,a=r.length;i<a;i+=3){var n=t[r[i+0]],h=t[r[i+1]],o=t[r[i+2]],l=new $(n[0],n[1],h[0],h[1],o[0],o[1]);s.push(l)}return s}return{vertices:t,indices:r}};const et=Phaser.Utils.Objects.GetValue,rt=Phaser.Math.Clamp,st=[1/27,3/27,9/27];var it=function(t,e,r,s,i,a,n,h,o,l,c,u){var f=[];f.push([t,e]);for(var d=Math.min(r,s),v=0,g=i.length;v<g;v++)nt(f,t,e,d*i[v],a,n,h,o,l,c,u);return d=2*Math.max(r,s),nt(f,t,e,d,a,n,h,o,l,c,u),f};const at=2*Math.PI;var nt=function(t,e,r,s,i,a,n,h,o,l,c){for(var u=0;u<i;u++){var f=u/i*at,d=e+Math.cos(f)*s*ht(a,n),v=r+Math.sin(f)*s*ht(a,n);d=rt(d,h,o),v=rt(v,l,c),t.push([d,v])}return t},ht=function(t,e){return t===e?t:t+(e-t)*Math.random()};const ot=Phaser.Utils.Objects.IsPlainObject,lt=Phaser.Math.Distance.Squared;var ct={resetImage:function(){return this.clear().addGridFaces(1,1),this},shatter:function(t,e,r){if(ot(t)&&(r=t,t=void 0,e=void 0),ot(r)&&(r.hasOwnProperty("centerX")&&(t=r.centerX),r.hasOwnProperty("centerY")&&(e=r.centerY),r.hasOwnProperty("ringRadiusList")&&this.setRingRadiusList(r.ringRadiusList),r.hasOwnProperty("samplesPerRing")&&this.setSamplesPerRing(r.samplesPerRing),r.hasOwnProperty("variation")&&this.setVariation(r.variation)),void 0===t)t=this.width/2,e=this.height/2;else{var s=i(this,t,e);t=s.x,e=s.y}if(this.shatterCenter.x=t,this.shatterCenter.y=e,this.clear(),0===this.width||0===this.height)return this;for(var a=function(t){var e,r,s,i,a,n,h=t.rectangle;h?(e=h.x,s=h.y,a=h.width,n=h.height):(e=0,s=0,a=t.width,n=t.height),r=e+a,i=s+n;var o,l,c=t.center;void 0===c?(o=(e+r)/2,l=(s+i)/2):(o=rt(c.x,e,r),l=rt(c.y,s,i));var u,f=et(t,"ringRadiusList",st),d=et(t,"samplesPerRing",12),v=et(t,"variation",.25),g=et(t,"triangleOutput",!0);(u=f)&&"function"==typeof u&&(f=f(a,n));for(var p=1-v,m=1+v,y=0;y<10;y++)try{var x=it(o,l,a,n,f,d,p,m,e,r,s,i);return tt(x,g)}catch(t){}throw new Error("Generate triangles fail")}({width:1,height:1,center:{x:t/=this.width,y:e/=this.height},triangleOutput:!1,ringRadiusList:this.ringRadiusList,variation:this.variation,samplesPerRing:this.samplesPerRing}),n=a.vertices,h=a.indices,o=[],l=0,c=n.length;l<c;l++){var u=n[l],f=u[0],d=u[1];o.push({g:lt(t,e,f,d),x:f,y:d})}for(l=0,c=h.length;l<c;l+=3){var v=o[h[l+0]],g=o[h[l+1]],p=o[h[l+2]],m=this.createVertex(v.x,v.y),y=this.createVertex(g.x,g.y),x=this.createVertex(p.x,p.y),P=this.createFace(m,y,x);this.addFace(P),P.g=Math.min(v.g,g.g,p.g)}return this.faces.sort((function(t,e){return t.g-e.g})),this}};Object.assign(ct,Q);const ut=Phaser.Utils.Objects.IsPlainObject,ft=Phaser.Utils.Objects.GetValue,dt=[1/27,3/27,9/27];class vt extends q{constructor(t,e,r,s,i,a){ut(e)&&(e=ft(a=e,"x",0),r=ft(a,"y",0),s=ft(a,"key",null),i=ft(a,"frame",null)),super(t,e,r,s,i),this.type="rexShatterImage",this.resetImage(),this.shatterCenter={x:null,y:null},this.setRingRadiusList(ft(a,"ringRadiusList",dt)),this.setSamplesPerRing(ft(a,"samplesPerRing",12)),this.setVariation(ft(a,"variation",.25))}}function gt(t,e,r,s,i){var a=new vt(this.scene,t,e,r,s,i);return this.scene.add.existing(a),a}Object.assign(vt.prototype,ct);const pt=Phaser.Utils.Objects.GetAdvancedValue,mt=Phaser.GameObjects.BuildGameObject;function yt(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var r=pt(t,"key",null),s=pt(t,"frame",null),i=new vt(this.scene,0,0,r,s,t);return mt(this.scene,i,t),i}const xt=Phaser.Textures.DynamicTexture,Pt=Phaser.Utils.Objects.IsPlainObject,Ft=Phaser.Utils.Objects.GetValue;class _t extends vt{constructor(t,e,r,s,i,a){Pt(e)&&(e=Ft(a=e,"x",0),r=Ft(a,"y",0),s=Ft(a,"width",32),i=Ft(a,"height",32));var n=function(t,e,r){return void 0===e&&(e=2),void 0===r&&(r=2),new xt(t.sys.textures,null,e,r)}(t,s,i);super(t,e,r,n,null,a),this.type="rexShatterRenderTexture",this.rt=this.texture}destroy(t){this.scene&&!this.ignoreDestroy&&(super.destroy(t),this.rt.destroy(),this.rt=null)}}function Ot(t,e,r,s,i){var a=new _t(this.scene,t,e,r,s,i);return this.scene.add.existing(a),a}const Vt=Phaser.Utils.Objects.GetAdvancedValue,bt=Phaser.GameObjects.BuildGameObject;function Rt(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var r=Vt(t,"width",32),s=Vt(t,"height",32),i=new _t(this.scene,0,0,r,s,t);return bt(this.scene,i,t),i}var Yt=function(t){return null==t||""===t||0===t.length},Bt=function(t,e,r,s){if(void 0===s&&(s="."),"object"==typeof t){if(Yt(e)){if(null==r)return;"object"==typeof r&&(t=r)}else{"string"==typeof e&&(e=e.split(s));var i=e.pop(),a=function(t,e,r){var s=t;if(Yt(e));else{var i;"string"==typeof e&&(e=e.split("."));for(var a=0,n=e.length;a<n;a++){var h;null!=s[i=e[a]]&&"object"==typeof s[i]||(h=a===n-1?void 0===r?{}:r:{},s[i]=h),s=s[i]}}return s}(t,e);a[i]=r}return t}};class wt extends Phaser.Plugins.BasePlugin{constructor(t){super(t),t.registerGameObject("rexShatterImage",gt,yt),t.registerGameObject("rexShatterRenderTexture",Ot,Rt)}start(){this.game.events.on("destroy",this.destroy,this)}}return Bt(window,"RexPlugins.GameObjects.ShatterImage",vt),Bt(window,"RexPlugins.GameObjects.ShatterRenderTexture",_t),wt},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexshatterimageplugin=e();
