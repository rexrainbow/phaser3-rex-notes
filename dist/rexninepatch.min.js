!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexninepatch=e();}(undefined,(function(){function t(t,r,i){return r=c(r),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,e()?Reflect.construct(r,i||[],c(t).constructor):r.apply(t,i))}function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(t){}return (e=function(){return !!t})()}function r(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(t,"string");return "symbol"==typeof e?e:String(e)}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o);}}function s(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e);}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},u.apply(this,arguments)}var l=function(t,e,r){return "__BASE"===r?"".concat(t,",").concat(e):"".concat(r,":").concat(t,",").concat(e)},d=function t(e){var r,o,n;if(null==e||"object"!==i(e))return e;if(r=Array.isArray(e)?[]:{},function(t){if("object"!==i(t)||t.nodeType||t===t.window)return !1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return !1}catch(t){return !1}return !0}(e))for(n in e)o=e[n],r[n]=t(o);else r=e;return r},f=Phaser.Utils.Objects.IsPlainObject,m=Phaser.Utils.Objects.GetValue,v=function(t){return "string"==typeof t&&(t=y[t]),t},y={scale:0,repeat:1},p=function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1},g=function(){},b={_beginDraw:g,_drawImage:g,_drawTileSprite:g,_endDraw:g,setGetFrameNameCallback:function(t){return void 0===t&&(t=l),this.getFrameNameCallback=t,this},setBaseTexture:function(t,e,r,o){Array.isArray(e)&&(o=r,r=e,e=void 0),null==e&&(e="__BASE"),"number"==typeof r&&arguments.length>=6?(r=[arguments[2],void 0,arguments[3]],o=[arguments[4],void 0,arguments[5]]):void 0===r&&void 0===o&&void 0!==this.columns.data&&void 0!==this.rows.data?(r=this.columns.data,o=this.rows.data):(r=d(r),o=d(o)),this.textureKey=t,this.baseFrameName=e,this.columns.data=r,this.columns.count=r?r.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.columns.scale=1,this.rows.data=o,this.rows.count=o?o.length:0,this.rows.stretch=0,this.rows.minHeight=0,this.rows.scale=1;var n=this.scene.sys.textures.get(t);if(!n)return this.clear(),this;if(!r||!o)return this.clear(),this;for(var s=n.get(e),a=s.width,c=0,h=0,u=r.length;h<u;h++)void 0===r[h]?c++:"number"==typeof r[h]?a-=r[h]:a-=r[h].width;var l=c>0?a/c:0,f=s.height,m=0;for(h=0,u=o.length;h<u;h++)void 0===o[h]?m++:"number"==typeof o[h]?f-=o[h]:f-=o[h].width;for(var v,y,p,g,b,w=m?f/m:0,x=0,P=0,S=0,O=o.length;S<O;S++){void 0===o[S]&&(o[S]=w),"number"==typeof o[S]&&(o[S]={height:o[S],stretch:S%2}),p=(v=o[S]).height,this.rows.stretch+=0|v.stretch,this.rows.minHeight+=v.stretch>0?0:p,x=0;h=0;for(var j=r.length;h<j;h++){if(void 0===r[h]&&(r[h]=l),"number"==typeof r[h]&&(r[h]={width:r[h],stretch:h%2}),g=(y=r[h]).width,0===S&&(this.columns.stretch+=0|y.stretch,this.columns.minWidth+=y.stretch>0?0:g),g>=1&&p>=1){var F=i(b=this.getFrameNameCallback(h,S,e));"string"!==F&&"number"!==F||n.add(b,0,x+s.cutX,P+s.cutY,g,p);}x+=g;}P+=p;}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.sys.textures.get(this.textureKey);if(!t)return this;var e,r,i,o,n,s,a,c=this.columns.minWidth*this.maxFixedPartScaleX,h=this.rows.minHeight*this.maxFixedPartScaleY,u=this.width-c,l=this.height-h,d=u>=0?this.maxFixedPartScaleX:this.width/c,f=l>=0?this.maxFixedPartScaleY:this.height/h;if(this.preserveRatio){var m=Math.min(d,f);if(d>m){var v=(d-m)*c;u>=0?u+=v:u=v,d=m;}if(f>m){var y=(f-m)*h;l>=0?l+=y:l=y,f=m;}}this.columns.scale=d,this.rows.scale=f,e=u>0&&this.columns.stretch>0?u/this.columns.stretch:0,r=l>0&&this.rows.stretch>0?l/this.rows.stretch:0;var p=0,g=0;this._beginDraw();for(var b=0,w=this.rows.count;b<w;b++){a=0===(n=this.rows.data[b]).stretch?n.height*f:r*n.stretch,p=0;for(var x=0,P=this.columns.count;x<P;x++)s=0===(o=this.columns.data[x]).stretch?o.width*d:e*o.stretch,i=this.getFrameNameCallback(x,b,this.baseFrameName),t.has(i)&&s>0&&a>0&&(0===(0===n.stretch&&0===o.stretch||0===this.getStretchMode(x,b)?0:1)?this._drawImage(this.textureKey,i,p,g,s,a):this._drawTileSprite(this.textureKey,i,p,g,s,a)),p+=s;g+=a;}this._endDraw();},setStretchMode:function(t){return f(t)?(this.stretchMode.edge=v(m(t,"edge",0)),this.stretchMode.internal=v(m(t,"internal",0))):(t=v(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return p.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal},setPreserveRatio:function(t){return null==t&&(t=!0),this.preserveRatio=t,this},setMaxFixedPartScale:function(t,e){return void 0===e&&(e=t),this.maxFixedPartScaleX=t,this.maxFixedPartScaleY=e,this}},w=Phaser.Utils.Objects.IsPlainObject,x=Phaser.Utils.Objects.GetValue,P=Phaser.Game,S=function(t){return t instanceof P},O=Phaser.Scene,j=function(t){return t instanceof O},F=function(t){return null==t||"object"!==i(t)?null:S(t)?t:S(t.game)?t.game:j(t)?t.sys.game:j(t.scene)?t.scene.sys.game:void 0},_=Phaser.GameObjects,k=void 0,T=function(t,e){if(k||(k={},F(t).events.once("destroy",(function(){for(var t in k)k[t].destroy();k=void 0;}))),!k.hasOwnProperty(e)){var r=F(t).scene.systemScene;(t=new _[e](r)).setOrigin(0),k[e]=t;}return k[e]},M=function(e){function r(){return o(this,r),t(this,r,arguments)}return a(r,e),s(r)}(function(e,r){var i=function(e){function i(e,n,s,a,c,h,u,l,d,f){var m;if(o(this,i),w(n)?(n=x(f=n,"x",0),s=x(f,"y",0),a=x(f,"width",1),c=x(f,"height",1),h=x(f,"key",void 0),u=x(f,"baseFrame",void 0),l=x(f,"columns",void 0),d=x(f,"rows",void 0)):w(a)?(a=x(f=a,"width",1),c=x(f,"height",1),h=x(f,"key",void 0),u=x(f,"baseFrame",void 0),l=x(f,"columns",void 0),d=x(f,"rows",void 0)):w(h)?(h=x(f=h,"key",void 0),u=x(f,"baseFrame",void 0),l=x(f,"columns",void 0),d=x(f,"rows",void 0)):w(u)?(u=x(f=u,"baseFrame",void 0),l=x(f,"columns",void 0),d=x(f,"rows",void 0)):Array.isArray(u)?(f=d,d=l,l=u,u=x(f,"baseFrame",void 0)):w(l)&&(l=x(f=l,"columns",void 0),d=x(f,"rows",void 0)),void 0===u&&(u=x(f,"frame",void 0)),void 0===l){var v=x(f,"leftWidth",void 0),y=x(f,"rightWidth",void 0);void 0!==v&&void 0!==y&&(l=[v,void 0,y]);}if(void 0===d){var p=x(f,"topHeight",void 0),g=x(f,"bottomHeight",void 0);void 0!==p&&void 0!==g&&(d=[p,void 0,g]);}(m=t(this,i,[e])).type=r,m.setPosition(n,s).setSize(a,c).setOrigin(.5,.5),m.columns={},m.rows={},m.stretchMode={},m._tileSprite=void 0,m._image=void 0,m.setGetFrameNameCallback(x(f,"getFrameNameCallback",void 0)),m.setStretchMode(x(f,"stretchMode",0)),m.setPreserveRatio(x(f,"preserveRatio",!0));var b=x(f,"maxFixedPartScale",1),P=x(f,"maxFixedPartScaleX",b),S=x(f,"maxFixedPartScaleY",void 0);return m.setMaxFixedPartScale(P,S),m.setBaseTexture(h,u,l,d),m}return a(i,e),s(i,[{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}},{key:"fixedPartScaleX",get:function(){return this.columns.scale}},{key:"fixedPartScaleY",get:function(){return this.rows.scale}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(u(c(i.prototype),"resize",this)?u(c(i.prototype),"resize",this).call(this,t,e):u(c(i.prototype),"setSize",this).call(this,t,e),this.updateTexture()),this}},{key:"leftWidth",get:function(){return this.columns.data[0]}},{key:"rightWidth",get:function(){return this.columns.data[this.columns.count-1]}},{key:"topHeight",get:function(){return this.rows.data[0]}},{key:"bottomHeight",get:function(){return this.rows.data[this.rows.count-1]}}]),i}(e);return Object.assign(i.prototype,b),i}(Phaser.GameObjects.RenderTexture,"rexNinePatch")),R={_drawImage:function(t,e,r,i,o,n){var s=T(this,"Image").setTexture(t,e).setDisplaySize(o,n);this.draw(s,r,i);},_drawTileSprite:function(t,e,r,i,o,n){var s=T(this,"TileSprite").setTexture(t,e).setSize(o,n);this.draw(s,r,i);}};return Object.assign(M.prototype,R),M}));
