!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rextagplayerplugin=e()}(void 0,function(){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(s=i.key,"symbol"==typeof(r=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(s,"string"))?r:String(r)),i)}var s,r}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(i){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(i);if(s){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return o(t)}(this,t)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(arguments.length<3?t:n):s.value}}).apply(this,arguments)}function p(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function a(t){return t instanceof e}function g(t){return t instanceof m}var e=Phaser.Scene,t={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},m=Phaser.Game,v=Phaser.Utils.Objects.GetValue,y=function(){function n(t,e){u(this,n),this.setParent(t),this.isShutdown=!1,this.setEventEmitter(v(e,"eventEmitter",!0)),this.parent&&(this.parent===this.scene?this.scene.sys.events.once("shutdown",this.onEnvDestroy,this):this.parent===this.game?this.game.events.once("shutdown",this.onEnvDestroy,this):this.parent.once&&this.parent.once("destroy",this.onParentDestroy,this))}return c(n,[{key:"shutdown",value:function(){this.isShutdown||(this.parent&&(this.parent===this.scene?this.scene.sys.events.off("shutdown",this.onEnvDestroy,this):this.parent===this.game?this.game.events.off("shutdown",this.onEnvDestroy,this):this.parent.once&&this.parent.off("destroy",this.onParentDestroy,this)),this.destroyEventEmitter(),this.parent=void 0,this.scene=void 0,this.game=void 0,this.isShutdown=!0)}},{key:"destroy",value:function(t){this.shutdown(t)}},{key:"onEnvDestroy",value:function(){this.destroy(!0)}},{key:"onParentDestroy",value:function(t,e){this.destroy(e)}},{key:"setParent",value:function(t){var e,n;return this.parent=t,this.scene=null==(e=t)||"object"!==i(e)?null:a(e)?e:e.scene&&a(e.scene)?e.scene:e.parent&&e.parent.scene&&a(e.parent.scene)?e.parent.scene:null,this.game=null==(n=t)||"object"!==i(n)?null:g(n)?n:g(n.game)?n.game:a(n)?n.sys.game:a(n.scene)?n.scene.sys.game:void 0,this}}]),n}();Object.assign(y.prototype,t);function k(t){return t instanceof N}function b(t,e,n,i,s){k(t)&&(s=i,i=n,n=e,e=t,t=void 0),void 0===i&&(i=1),void 0===s&&(s=0);var r,a={mode:0,volume:{start:s,end:i},duration:n};return"string"==typeof e&&(e=t.sys.sound.add(e)),e.hasOwnProperty("_fade")?(r=e._fade).stop().resetFromJSON(a):(r=new z(t,e,a),e._fade=r),r.start(),e.isPlaying||e.setVolume(s).play(),e}function E(t,e,n,i){k(t)&&(i=n,n=e,e=t,t=void 0),void 0===i&&(i=!0);var s,r={mode:i?2:1,volume:{start:e.volume,end:0},duration:n};return e.hasOwnProperty("_fade")?(s=e._fade).stop().resetFromJSON(r):(s=new z(t,e,r),e._fade=s),s.start(),e.isPlaying||e.play(),e}var M=Phaser.Utils.Objects.GetValue,O=function(){h(s,y);var i=f(s);function s(t,e){var n;return u(this,s),(n=i.call(this,t,e))._isRunning=!1,n.isPaused=!1,n.tickingState=!1,n.setTickingMode(M(e,"tickingMode",1)),n}return c(s,[{key:"boot",value:function(){2!==this.tickingMode||this.tickingState||this.startTicking()}},{key:"shutdown",value:function(t){this.isShutdown||(this.stop(),this.tickingState&&this.stopTicking(),d(l(s.prototype),"shutdown",this).call(this,t))}},{key:"setTickingMode",value:function(t){"string"==typeof t&&(t=T[t]),this.tickingMode=t}},{key:"startTicking",value:function(){this.tickingState=!0}},{key:"stopTicking",value:function(){this.tickingState=!1}},{key:"isRunning",get:function(){return this._isRunning},set:function(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking()))}},{key:"start",value:function(){return this.isPaused=!1,this.isRunning=!0,this}},{key:"pause",value:function(){return this.isRunning&&(this.isPaused=!0,this.isRunning=!1),this}},{key:"resume",value:function(){return this.isPaused&&(this.isRunning=!0),this}},{key:"stop",value:function(){return this.isPaused=!1,this.isRunning=!1,this}},{key:"complete",value:function(){this.isPaused=!1,this.isRunning=!1,this.emit("complete",this.parent,this)}}]),s}(),T={no:0,lazy:1,always:2},w=Phaser.Utils.Objects.GetValue,S=function(){h(r,O);var s=f(r);function r(t,e){var n;u(this,r);var i=(n=s.call(this,t,e)).scene?"update":"step";return n.tickEventName=w(e,"tickEventName",i),n.isSceneTicker=!j(n.tickEventName),n}return c(r,[{key:"startTicking",value:function(){d(l(r.prototype),"startTicking",this).call(this),this.isSceneTicker?this.scene.sys.events.on(this.tickEventName,this.update,this):this.game.events.on(this.tickEventName,this.update,this)}},{key:"stopTicking",value:function(){d(l(r.prototype),"stopTicking",this).call(this),this.isSceneTicker&&this.scene?this.scene.sys.events.off(this.tickEventName,this.update,this):this.game&&this.game.events.off(this.tickEventName,this.update,this)}}]),r}(),j=function(t){return"step"===t||"poststep"===t},P=Phaser.Utils.Objects.GetValue,x=Phaser.Math.Clamp,C=function(){function e(t){u(this,e),this.resetFromJSON(t)}return c(e,[{key:"resetFromJSON",value:function(t){this.state=P(t,"state",G),this.timeScale=P(t,"timeScale",1),this.delay=P(t,"delay",0),this.repeat=P(t,"repeat",0),this.repeatCounter=P(t,"repeatCounter",0),this.repeatDelay=P(t,"repeatDelay",0),this.duration=P(t,"duration",0),this.nowTime=P(t,"nowTime",0),this.justRestart=P(t,"justRestart",!1)}},{key:"toJSON",value:function(){return{state:this.state,timeScale:this.timeScale,delay:this.delay,repeat:this.repeat,repeatCounter:this.repeatCounter,repeatDelay:this.repeatDelay,duration:this.duration,nowTime:this.nowTime,justRestart:this.justRestart}}},{key:"destroy",value:function(){}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setDelay",value:function(t){return void 0===t&&(t=0),this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatInfinity",value:function(){return this.repeat=-1,this}},{key:"setRepeatDelay",value:function(t){return this.repeatDelay=t,this}},{key:"start",value:function(){return this.nowTime=0<this.delay?-this.delay:0,this.state=0<=this.nowTime?R:B,this.repeatCounter=0,this}},{key:"stop",value:function(){return this.state=G,this}},{key:"update",value:function(t,e){this.state!==G&&this.state!==_&&0!==e&&0!==this.timeScale&&(this.nowTime+=e*this.timeScale,this.justRestart=!1,this.nowTime>=this.duration?-1===this.repeat||this.repeatCounter<this.repeat?(this.repeatCounter++,this.justRestart=!0,this.nowTime-=this.duration,0<this.repeatDelay&&(this.nowTime-=this.repeatDelay,this.state=V)):(this.nowTime=this.duration,this.state=_):0<=this.nowTime&&(this.state=R))}},{key:"t",get:function(){var t;switch(this.state){case G:case B:case V:t=0;break;case R:t=this.nowTime/this.duration;break;case _:t=1}return x(t,0,1)},set:function(t){(t=x(t,-1,1))<0?(this.state=B,this.nowTime=-this.delay*t):(this.state=R,this.nowTime=this.duration*t,1===t&&0!==this.repeat&&this.repeatCounter++)}},{key:"setT",value:function(t){return this.t=t,this}},{key:"isIdle",get:function(){return this.state===G}},{key:"isDelay",get:function(){return this.state===B}},{key:"isCountDown",get:function(){return this.state===R}},{key:"isRunning",get:function(){return this.state===B||this.state===R}},{key:"isDone",get:function(){return this.state===_}},{key:"isOddIteration",get:function(){return 1==(1&this.repeatCounter)}},{key:"isEvenIteration",get:function(){return 0==(1&this.repeatCounter)}}]),e}(),G=0,B=1,R=2,V=3,_=-1,F=function(){h(s,S);var i=f(s);function s(t,e){var n;return u(this,s),(n=i.call(this,t,e)).timer=new C,n}return c(s,[{key:"shutdown",value:function(t){this.isShutdown||(d(l(s.prototype),"shutdown",this).call(this,t),this.timer.destroy(),this.timer=void 0)}},{key:"start",value:function(){return this.timer.start(),d(l(s.prototype),"start",this).call(this),this}},{key:"stop",value:function(){return this.timer.stop(),d(l(s.prototype),"stop",this).call(this),this}},{key:"complete",value:function(){return this.timer.stop(),d(l(s.prototype),"complete",this).call(this),this}}]),s}(),D=Phaser.Utils.Objects.GetValue,L=Phaser.Utils.Objects.GetAdvancedValue,A=Phaser.Tweens.Builders.GetEaseFunction,I=function(){h(e,F);var t=f(e);function e(){return u(this,e),t.apply(this,arguments)}return c(e,[{key:"resetFromJSON",value:function(t){return this.timer.resetFromJSON(D(t,"timer")),this.setEnable(D(t,"enable",!0)),this.setTarget(D(t,"target",this.parent)),this.setDelay(L(t,"delay",0)),this.setDuration(L(t,"duration",1e3)),this.setEase(D(t,"ease","Linear")),this.setRepeat(D(t,"repeat",0)),this}},{key:"setEnable",value:function(t){return null==t&&(t=!0),this.enable=t,this}},{key:"setTarget",value:function(t){return void 0===t&&(t=this.parent),this.target=t,this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatDelay",value:function(t){return this.repeatDelay=t,this}},{key:"setEase",value:function(t){return void 0===t&&(t="Linear"),this.ease=t,this.easeFn=A(t),this}},{key:"start",value:function(){return this.timer.isRunning||d(l(e.prototype),"start",this).call(this),this}},{key:"restart",value:function(){return this.timer.stop(),this.start.apply(this,arguments),this}},{key:"stop",value:function(t){return void 0===t&&(t=!1),d(l(e.prototype),"stop",this).call(this),t&&(this.timer.setT(1),this.updateGameObject(this.target,this.timer),this.complete()),this}},{key:"update",value:function(t,e){if(!this.isRunning||!this.enable||!this.parent.active)return this;var n=this.target,i=this.timer;return i.update(t,e),i.isDelay||this.updateGameObject(n,i),this.emit("update",n,this),i.isDone&&this.complete(),this}},{key:"updateGameObject",value:function(){}}]),e}(),N=Phaser.Sound.BaseSound,W=Phaser.Utils.Objects.GetValue,U=Phaser.Utils.Objects.GetAdvancedValue,J=Phaser.Math.Linear,z=function(){h(r,I);var s=f(r);function r(t,e,n){var i;return u(this,r),k(t)&&(n=e,e=t,t=void 0),e.active=!0,e.scene=t,e.game=e.manager.game,(i=s.call(this,e,n)).volume={},i.resetFromJSON(n),i}return c(r,[{key:"resetFromJSON",value:function(t){return d(l(r.prototype),"resetFromJSON",this).call(this,t),this.setMode(W(t,"mode",0)),this.setEnable(W(t,"enable",!0)),this.setVolumeRange(U(t,"volume.start",this.parent.volume),U(t,"volume.end",0)),this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=X[t]),this.mode=t,this}},{key:"setVolumeRange",value:function(t,e){return this.volume.start=t,this.volume.end=e,this}},{key:"start",value:function(){return this.timer.isRunning||(this.parent.setVolume(this.volume.start),this.timer.setDelay(this.delay).setDuration(this.duration),d(l(r.prototype),"start",this).call(this)),this}},{key:"updateGameObject",value:function(t,e){t.volume=J(this.volume.start,this.volume.end,e.t)}},{key:"complete",value:function(){switch(d(l(r.prototype),"complete",this).call(this),this.mode){case 1:this.parent.stop();break;case 2:this.parent.destroy()}return this}}]),r}(),X={stop:1,destroy:2},Y={setBackgroundMusicLoopValue:function(t){return this.backgroundMusicLoopValue=t,this},setBackgroundMusicFadeTime:function(t){return this.backgroundMusicFadeTime=t,this},getBackgroundMusic:function(){return this.backgroundMusic},setCurrentBackgroundMusic:function(t){return(this.backgroundMusic=t)&&(t.setLoop(this.backgroundMusicLoopValue),t.once("complete",function(){this.backgroundMusic===t&&(this.backgroundMusic.destroy(),this.backgroundMusic=void 0)},this).once("destroy",function(){this.backgroundMusic===t&&(this.backgroundMusic=void 0)},this),t.isPlaying||t.play()),this},playBackgroundMusic:function(t){return this.backgroundMusic&&this.backgroundMusic.key===t||(this.stopBackgroundMusic(),this.setCurrentBackgroundMusic(this.sound.add(t)),0<this.backgroundMusicFadeTime&&this.fadeInBackgroundMusic(this.backgroundMusicFadeTime)),this},pauseBackgroundMusic:function(){return this.backgroundMusic&&this.backgroundMusic.pause(),this},resumeBackgroundMusic:function(){return this.backgroundMusic&&this.backgroundMusic.resume(),this},stopBackgroundMusic:function(){return this.backgroundMusic&&(0<this.backgroundMusicFadeTime?this.fadeOutBackgroundMusic(this.backgroundMusicFadeTime,!0):(this.backgroundMusic.stop(),this.backgroundMusic.destroy(),this.backgroundMusic=void 0)),this},fadeInBackgroundMusic:function(t){return this.backgroundMusic&&b(this.backgroundMusic,t,this.backgroundMusicVolume,0),this},fadeOutBackgroundMusic:function(t,e){return this.backgroundMusic&&E(this.backgroundMusic,t,e),this},crossFadeBackgroundMusic:function(t,e){var n=this.backgroundMusicFadeTime;return this.backgroundMusicFadeTime=0,this.fadeOutBackgroundMusic(e,!0).playBackgroundMusic(t).fadeInBackgroundMusic(e),this.backgroundMusicFadeTime=n,this},setBackgroundMusicVolume:function(t){return this.backgroundMusicVolume=t,this}},$={setBackgroundMusic2LoopValue:function(t){return this.backgroundMusic2LoopValue=t,this},setBackgroundMusic2FadeTime:function(t){return this.backgroundMusic2FadeTime=t,this},getBackgroundMusic2:function(){return this.backgroundMusic2},setCurrentBackgroundMusic2:function(t){return(this.backgroundMusic2=t)&&(t.setLoop(this.backgroundMusic2LoopValue),t.once("complete",function(){this.backgroundMusic2===t&&(this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0)},this).once("destroy",function(){this.backgroundMusic2===t&&(this.backgroundMusic2=void 0)},this),t.isPlaying||t.play()),this},playBackgroundMusic2:function(t){return this.backgroundMusic2&&this.backgroundMusic2.key===t||(this.stopBackgroundMusic2(),this.setCurrentBackgroundMusic2(this.sound.add(t)),0<this.backgroundMusic2FadeTime&&this.fadeInBackgroundMusic2(this.backgroundMusic2FadeTime)),this},pauseBackgroundMusic2:function(){return this.backgroundMusic2&&this.backgroundMusic2.pause(),this},resumeBackgroundMusic2:function(){return this.backgroundMusic2&&this.backgroundMusic2.resume(),this},stopBackgroundMusic2:function(){return this.backgroundMusic2&&(0<this.backgroundMusic2FadeTime?this.fadeOutBackgroundMusic2(this.backgroundMusic2FadeTime,!0):(this.backgroundMusic2.stop(),this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0)),this},fadeInBackgroundMusic2:function(t){return this.backgroundMusic2&&b(this.backgroundMusic2,t,this.backgroundMusic2Volume,0),this},fadeOutBackgroundMusic2:function(t,e){return this.backgroundMusic2&&E(this.backgroundMusic2,t,e),this},crossFadeBackgroundMusic2:function(t,e){var n=this.backgroundMusic2FadeTime;return this.backgroundMusic2FadeTime=0,this.fadeOutBackgroundMusic2(e,!0).playBackgroundMusic2(t).fadeInBackgroundMusic2(e),this.backgroundMusic2FadeTime=n,this},setBackgroundMusic2Volume:function(t){return this.backgroundMusic2Volume=t,this}},H=Phaser.Utils.Array.Remove,K={getSoundEffects:function(){return this.soundEffects},getLastSoundEffect:function(){return this.soundEffects[this.soundEffects.length-1]},playSoundEffect:function(t){var e=this.sound.add(t);return e.setVolume(this.soundEffectsVolume),this.soundEffects.push(e),e.once("complete",function(){e.destroy(),this.sound&&H(this.soundEffects,e)},this).once("destroy",function(){this.sound&&H(this.soundEffects,e)},this).play(),this},fadeInSoundEffect:function(t){var e=this.getLastSoundEffect();return e&&b(e,t,this.soundEffectsVolume,0),this},fadeOutSoundEffect:function(t,e){var n=this.getLastSoundEffect();return n&&E(n,t,e),this},fadeOutAllSoundEffects:function(t,e){for(var n=this.soundEffects.length-1;0<=n;n--)E(this.soundEffects[n],t,e);return this},setSoundEffectVolume:function(t,e){if(void 0===e&&(e=!1),e){var n=this.getLastSoundEffect();n&&n.setVolume(t)}else this.soundEffectsVolume=t;return this}},q=Phaser.Utils.Array.Remove,Z={getSoundEffects2:function(){return this.soundEffects2},getLastSoundEffect2:function(){return this.soundEffects2[this.soundEffects2.length-1]},playSoundEffect2:function(t){var e=this.sound.add(t);return e.setVolume(this.soundEffects2Volume),this.soundEffects2.push(e),e.once("complete",function(){e.destroy(),this.sound&&q(this.soundEffects2,e)},this).once("destroy",function(){this.sound&&q(this.soundEffects2,e)},this).play(),this},fadeInSoundEffect2:function(t){var e=this.getLastSoundEffect2();return e&&b(e,t,this.soundEffects2Volume,0),this},fadeOutSoundEffect2:function(t,e){var n=this.getLastSoundEffect2();return n&&E(n,t,e),this},fadeOutAllSoundEffects2:function(t,e){for(var n=this.soundEffects2.length-1;0<=n;n--)E(this.soundEffects2[n],t,e);return this},setSoundEffect2Volume:function(t,e){if(void 0===e&&(e=!1),e){var n=this.getLastSoundEffect2();n&&n.setVolume(t)}else this.soundEffects2Volume=t;return this}},Q={};Object.assign(Q,Y,$,K,Z);var tt=Phaser.Utils.Objects.GetValue,et=function(){function r(t,e){var n;u(this,r),this.sound=a(n=t)?n.sys.sound:n.sound,this.backgroundMusic=void 0,this._backgroundMusicVolume=tt(e,"bgm.volume",1),this.setBackgroundMusicLoopValue(tt(e,"bgm.loop",!0)),this.setBackgroundMusicFadeTime(tt(e,"bgm.fade",500)),this.backgroundMusic2=void 0,this._backgroundMusic2Volume=tt(e,"bgm2.volume",1),this.setBackgroundMusic2LoopValue(tt(e,"bgm2.loop",!0)),this.setBackgroundMusic2FadeTime(tt(e,"bgm2.fade",500)),this.soundEffects=[],this._soundEffectsVolume=tt(e,"soundEffect.volume",1),this.soundEffects2=[],this._soundEffects2Volume=tt(e,"soundEffect2.volume",1);var i=tt(e,"bgm.initial",void 0);i&&this.setCurrentBackgroundMusic(i);var s=tt(e,"bgm2.initial",void 0);s&&this.setCurrentBackgroundMusic2(s)}return c(r,[{key:"destroy",value:function(){if(this.backgroundMusic&&this.backgroundMusic.destroy(),this.backgroundMusic=void 0,this.backgroundMusic2&&this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0,this.soundEffects.length)for(var t=this.soundEffects.length-1;0<=t;t--)this.soundEffects[t].destroy();if(this.soundEffects.length=0,this.soundEffects2.length)for(t=this.soundEffects2.length-1;0<=t;t--)this.soundEffects2[t].destroy();return this.soundEffects2.length=0,this.sound=void 0,this}},{key:"backgroundMusicVolume",get:function(){return this._backgroundMusicVolume},set:function(t){this._backgroundMusicVolume=t,this.backgroundMusic&&this.backgroundMusic.setVolume(t)}},{key:"backgroundMusic2Volume",get:function(){return this._backgroundMusic2Volume},set:function(t){this._backgroundMusic2Volume=t,this.backgroundMusic2&&this.backgroundMusic2.setVolume(t)}},{key:"soundEffectsVolume",get:function(){return this._soundEffectsVolume},set:function(t){this._soundEffectsVolume=t;for(var e=this.soundEffects,n=0,i=e.length;n<i;n++)e[n].setVolume(t)}}]),r}();Object.assign(et.prototype,Q);function nt(t,e){var n=mt(e,"sounds");return!1!==n&&(this.soundManager=new et(t,n)),this.gameObjectManagers={},this.timeline=new gt(this),this.managersScene=t,this}function it(t){for(var e in this.timeline.timeScale=t,this.gameObjectManagers)this.gameObjectManagers[e].setTimeScale(t);return this}function st(){return this.timeline.timeScale}function rt(t){for(var e in this.soundManager&&this.soundManager.destroy(),this.soundManager=void 0,this.gameObjectManagers)this.gameObjectManagers[e].destroy(t),delete this.gameObjectManagers[e];this.timeline&&this.timeline.destroy(),this.timeline=void 0,this.managersScene=void 0}var at=Phaser.Utils.Objects.GetValue,ot=function(){h(s,O);var i=f(s);function s(t,e){var n;return u(this,s),(n=i.call(this,t,e)).resetFromJSON(e),n.boot(),n}return c(s,[{key:"resetFromJSON",value:function(t){return this.isRunning=at(t,"isRunning",!1),this.timeScale=at(t,"timeScale",1),this.now=at(t,"now",0),this}},{key:"toJSON",value:function(){return{isRunning:this.isRunning,timeScale:this.timeScale,now:this.now,tickingMode:this.tickingMode}}},{key:"start",value:function(t){return void 0===t&&(t=0),this.delta=0,this.now=t,d(l(s.prototype),"start",this).call(this),this}},{key:"seek",value:function(t){return this.now=t,this}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"tick",value:function(t){return t*=this.timeScale,this.now+=t,this.delta=t,this.emit("update",this.now,this.delta),this}}]),s}(),ut=function(){h(e,ot);var t=f(e);function e(){return u(this,e),t.apply(this,arguments)}return c(e,[{key:"startTicking",value:function(){d(l(e.prototype),"startTicking",this).call(this),this.scene.sys.events.on("update",this.update,this)}},{key:"stopTicking",value:function(){d(l(e.prototype),"stopTicking",this).call(this),this.scene&&this.scene.sys.events.off("update",this.update,this)}},{key:"update",value:function(t,e){return this.isRunning&&0!==this.timeScale&&this.tick(e),this}}]),e}(),ct=Phaser.Math.Clamp,ht=function(){function n(t,e){u(this,n),this.setTimeline(t).reset(e)}return c(n,[{key:"setTimeline",value:function(t){return this.timeline=t,this}},{key:"setName",value:function(t){return this.name=t,this}},{key:"setCallbacks",value:function(t,e,n,i){return this.target=t,this.onStart=e,this.onProgress=n,this.onComplete=i,this}},{key:"setDuration",value:function(t,e){return void 0===e&&(e=!1),this.duration=t,this.remainder=t,this.t=0,this.yoyo=e,this}},{key:"setPaused",value:function(t){return this.isPaused=t,this}},{key:"pause",value:function(){return this.isPaused=!0,this}},{key:"resume",value:function(){return this.isPaused=!1,this}},{key:"setRemoved",value:function(t){return this.removed=t,this}},{key:"remove",value:function(){return this.removed=!0,this}},{key:"seek",value:function(t){return this.remainder=this.duration*(1-t),this}},{key:"reset",value:function(t){return this.setName(t.name).setDuration(t.duration,t.yoyo).setCallbacks(t.target,t.onStart,t.onProgress,t.onComplete).setPaused(!1).setRemoved(!1),this}},{key:"onFree",value:function(){this.setTimeline().setCallbacks()}},{key:"getProgress",value:function(){var t,e,n=1-this.remainder/this.duration;return n=ct(n,0,1),this.yoyo&&(void 0===e&&(e=.5),(t=n)<=e?t/=e:t=1-(t-e)/(1-e),n=t),n}},{key:"setProgress",value:function(t){t=ct(t,0,1),this.remainder=this.duration*(1-t)}},{key:"runCallback",value:function(t){t&&t(this.target,this.t,this)}},{key:"update",value:function(t,e){if(this.removed)return!0;if(this.isPaused)return!1;this.remainder-=e,this.t=this.getProgress(),this.runCallback(this.onProgress);var n=this.remainder<=0;return n&&this.runCallback(this.onComplete),n}}]),n}(),lt=function(){function t(){u(this,t),this.items=[]}return c(t,[{key:"destroy",value:function(){this.clear(),this.items=void 0}},{key:"pop",value:function(){return 0<this.items.length?this.items.pop():null}},{key:"push",value:function(t){return this.items.push(t),this}},{key:"pushMultiple",value:function(t){return this.items.push.apply(this.items,t),t.length=0,this}},{key:"clear",value:function(){return this.items.length=0,this}}]),t}(),ft=function(){h(e,lt);var t=f(e);function e(){return u(this,e),t.apply(this,arguments)}return c(e,[{key:"allocate",value:function(){return this.pop()}},{key:"free",value:function(t){t.onFree(),this.push(t)}},{key:"freeMultiple",value:function(t){for(var e=0,n=t.length;e<n;e++)this.free(t[e]);return this}}]),e}(),dt=Phaser.Utils.Objects.GetValue,pt=new ft,gt=function(){h(o,ut);var i=f(o);function o(t,e){var n;return u(this,o),(n=i.call(this,t,e)).addedTimers=[],n.timers=[],n.timerPool=dt(e,"pool",pt),n}return c(o,[{key:"shutdown",value:function(){this.isShutdown||(this.timerPool.freeMultiple(this.addedTimers).freeMultiple(this.timers),this.timerPool=void 0,this.addedTimers=void 0,this.timers=void 0,d(l(o.prototype),"shutdown",this).call(this))}},{key:"addTimer",value:function(t){var e=this.timerPool.allocate();return e?e.setTimeline(this).reset(t):e=new ht(this,t),this.addedTimers.push(e),e.runCallback(e.onStart),this.isRunning||this.start(),e}},{key:"delayCall",value:function(t,i,s,r){return this.addTimer({duration:t,onComplete:function(t,e,n){void 0===s&&(s=[]),s.push(n),i.apply(r,s)}})}},{key:"getTimers",value:function(t){for(var e=[],n=[this.addedTimers,this.timers],i=0,s=n.length;i<s;i++)for(var r=n[i],a=0,o=r.length;a<o;a++){var u=r[a];u.name===t&&e.push(u)}return e}},{key:"update",value:function(t,e){var n;if(d(l(o.prototype),"update",this).call(this,t,e),this.isRunning){(n=this.timers).push.apply(n,p(this.addedTimers));for(var i=[],s=this.addedTimers.length=0,r=this.timers.length;s<r;s++){var a=this.timers[s];a.update(this.now,this.delta)?this.timerPool.free(a):i.push(a)}this.timers=i,0===this.timers.length&&0===this.addedTimers.length&&this.complete()}}}]),o}(),mt=Phaser.Utils.Objects.GetValue,vt={hasProperty:function(t){var e=this.gameObject;return!!e.hasOwnProperty(t)||void 0!==e[t]},getProperty:function(t){return this.gameObject[t]},setProperty:function(t,e){return this.gameObject[t]=e,this},easeProperty:function(t,e,n,i,s,r,a){var o=this.tweens,u=o[t];u&&u.remove();var c=this.gameObject,h={targets:c,duration:n,ease:i,repeat:s,yoyo:r,onComplete:function(){o[t].remove(),o[t]=null,a&&a(c,t)},onCompleteScope:this};return h[t]=e,(u=this.scene.tweens.add(h)).timeScale=this.timeScale,o[t]=u,this}},yt={hasMethod:function(t){return"function"==typeof this.gameObject[t]},call:function(t){if(!this.hasMethod(t))return this;for(var e=this.gameObject,n=arguments.length,i=new Array(1<n?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return e[t].apply(e,i),this}},kt=function(){function i(t,e,n){u(this,i),this.GOManager=t,this.tweens={},this.setGO(e,n)}return c(i,[{key:"scene",get:function(){return this.GOManager.scene}},{key:"timeScale",get:function(){return this.GOManager.timeScale}},{key:"destroy",value:function(){this.freeGO(),this.GOManager=void 0}},{key:"freeTweens",value:function(){var t,e=this.tweens;for(var n in e)(t=e[n])&&t.remove(),e[n]=null;return this}},{key:"freeGO",value:function(){return this.freeTweens(),this.gameObject.destroy(),this.gameObject=void 0,this}},{key:"setGO",value:function(t,e){return t.setName(e),this.gameObject=t,this.name=e,this.freeTweens(),this}},{key:"setTimeScale",value:function(t){var e=this.tweens;for(var n in e){var i=e[n];i&&(i.timeScale=t)}return this}}]),i}();Object.assign(kt.prototype,vt,yt,{hasData:function(t){var e=this.gameObject;return!!e.data&&e.data.has(t)},getData:function(t){return this.gameObject.getData(t)},setData:function(t,e){return this.gameObject.setData(t,e),this}});function bt(t){return t>>16&255}function Et(t){return t>>8&255}function Mt(t){return 255&t}function Ot(t,e,n,i,s,r){return void 0===r?r={}:!0===r&&(r=Ct),"number"!=typeof n&&(i=n=0),r.x=s.x+s.width*t+n,r.y=s.y+s.height*e+i,r}function Tt(t,e,n,i,s,r,a){if(t.hasOwnProperty("vp"))return t;"function"==typeof n&&(a=n,n=void 0),"function"==typeof s&&(a=s,s=void 0),void 0===n&&(n=.5),void 0===i&&(i=.5),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=Ot),function(e){if(e.events)return;var n=new xt,i=e.x;Object.defineProperty(e,"x",{get:function(){return i},set:function(t){i!==t&&(i=t,n.emit("update",e))}});var s=e.y;Object.defineProperty(e,"y",{get:function(){return s},set:function(t){s!==t&&(s=t,n.emit("update",e))}});var r=e.width;Object.defineProperty(e,"width",{get:function(){return r},set:function(t){r!==t&&(r=t,n.emit("update",e))}});var a=e.height;Object.defineProperty(e,"height",{get:function(){return a},set:function(t){a!==t&&(a=t,n.emit("update",e))}}),e.events=n}(e);var o=e.events;function u(){a(n,i,s,r,e,t)}t.vp=e,o.on("update",u),t.once("destroy",function(){o.off("update",u),t.vp=void 0}),Object.defineProperty(t,"vpx",{get:function(){return n},set:function(t){n!==t&&(n=t,u())}}),Object.defineProperty(t,"vpy",{get:function(){return i},set:function(t){i!==t&&(i=t,u())}}),Object.defineProperty(t,"vpxOffset",{get:function(){return s},set:function(t){s!==t&&(s=t,u())}}),Object.defineProperty(t,"vpyOffset",{get:function(){return r},set:function(t){r!==t&&(r=t,u())}}),u()}function wt(t){return void 0!==t.displayWidth?t.displayWidth:t.width}function St(t){return void 0!==t.displayHeight?t.displayHeight:t.height}var jt={tint:0,alpha:1},Pt={setGOFadeMode:function(t){return"string"==typeof t&&(t=jt[t]),this.fadeMode=t,this},setGOFadeTime:function(t){return this.fadeTime=t,this},hasTintFadeEffect:function(t){return(void 0===this.fadeMode||0===this.fadeMode)&&0<this.fadeTime&&void 0!==t.setTint},hasAlphaFadeEffect:function(t){return(void 0===this.fadeMode||1===this.fadeMode)&&0<this.fadeTime&&void 0!==t.setAlpha},fadeBob:function(t,e,n,i){var s=t.gameObject;return this.hasTintFadeEffect(s)?(void 0!==e&&t.setProperty("tintGray",255*e),t.easeProperty("tintGray",Math.floor(255*n),this.fadeTime,"Linear",0,!1,i)):this.hasAlphaFadeEffect(s)?(void 0!==e&&t.setProperty("alpha",e),t.easeProperty("alpha",n,this.fadeTime,"Linear",0,!1,i)):i&&i(s),this}},xt=Phaser.Events.EventEmitter,Ct={},Gt=Phaser.Utils.Array.Remove,Bt={has:function(t){return this.bobs.hasOwnProperty(t)},exists:function(t){return this.bobs.hasOwnProperty(t)},get:function(t){return this.bobs[t]},getGO:function(t){var e=this.get(t);return e?e.gameObject:null},addGO:function(t,e){this.remove(t,!0),this.hasTintFadeEffect(e)&&function(e,n){if(e.hasOwnProperty("tintR"))return;void 0===n&&(n=16777215);var i=bt(n),s=Et(n),r=Mt(n);Object.defineProperty(e,"tint",{get:function(){return n},set:function(t){t=16777215&Math.floor(t),e.setTint&&e.setTint(t),n!==t&&(i=bt(n=t),s=Et(n),r=Mt(n))}}),Object.defineProperty(e,"tintR",{get:function(){return i},set:function(t){t=255&Math.floor(t),i!==t&&(i=t,e.tint=(255&t)<<16|65535&n)}}),Object.defineProperty(e,"tintG",{get:function(){return s},set:function(t){t=255&Math.floor(t),s!==t&&(s=t,e.tint=(255&t)<<8|16711935&n)}}),Object.defineProperty(e,"tintB",{get:function(){return r},set:function(t){t=255&Math.floor(t),r!==t&&(r=t,e.tint=255&t|16776960&n)}}),Object.defineProperty(e,"tintGray",{get:function(){return Math.floor((i+s+r)/3)},set:function(t){t=255&Math.floor(t),i===t&&s===t&&r===t||(r=s=i=t,e.tint=(255&t)<<16|(255&t)<<8|255&t)}}),e.tint=n}(e),this.viewportCoordinateEnable&&Tt(e,this.viewport),e.once("destroy",function(){Gt(this.removedGOs,e),this.isEmpty&&this.emit("empty")},this);var n=new this.BobClass(this,e,t);return this.bobs[t]=n,this},add:function(t){for(var e=this.createGameObjectCallback,n=this.createGameObjectScope,i=arguments.length,s=new Array(1<i?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];var a=e.call.apply(e,[n,this.scene].concat(s));this.addGO(t,a);var o=this.get(t);return this.fadeBob(o,0,1),this},forEachGO:function(t,e){for(var n in this.bobs){var i=this.bobs[n].gameObject;if(e?t.call(e,i,n,this):t(i,n,this))break}return this}},Rt={remove:function(t,e){if(!this.has(t))return this;var n=this.get(t);return delete this.bobs[t],this.removedGOs.push(n.gameObject),e?n.destroy():this.fadeBob(n,void 0,0,function(){n.destroy()}),this},removeAll:function(){var t=this.bobs;for(var e in t)this.remove(e);return this},clear:function(t){void 0===t&&(t=!0);var e=this.bobs;for(var n in e)t&&e[n].destroy(),delete e[n];return this.removedGOs.length=0,this}},Vt={hasProperty:function(t,e){return!!this.has(t)&&this.get(t).hasProperty(e)},getProperty:function(t,e){if(this.has(t))return this.get(t).getProperty(e)},isNumberProperty:function(t,e){return"number"==typeof this.getProperty(t,e)},setProperty:function(t,e,n){return this.has(t)&&(this.symbols&&"string"==typeof n&&this.isNumberProperty(t,e)&&(n in this.symbols?n=this.symbols[n]:console.warn("Can't find symbol ".concat(n))),this.get(t).setProperty(e,n)),this},easeProperty:function(t,e,n,i,s,r,a,o){return this.has(t)&&(void 0===i&&(i=1e3),void 0===s&&(s="Linear"),void 0===r&&(r=0),void 0===a&&(a=!1),this.symbols&&"string"==typeof n&&this.isNumberProperty(t,e)&&(n in this.symbols?n=this.symbols[n]:console.warn("Can't find symbol ".concat(n))),this.get(t).easeProperty(e,n,i,s,r,a,o)),this},hasTweenTask:function(t,e){return!!this.has(t)&&this.get(t).tweens.hasOwnProperty(e)},getTweenTask:function(t,e){if(!this.has(t))return null;var n=this.get(t).tweens[e];return n||null}},_t={hasMethod:function(t,e){return!!this.has(t)&&this.get(t).hasMethod(e)},call:function(t,e){var n;if(!this.has(t))return this;for(var i=arguments.length,s=new Array(2<i?i-2:0),r=2;r<i;r++)s[r-2]=arguments[r];return(n=this.get(t)).call.apply(n,[e].concat(s)),this}},Ft={hasData:function(t,e){return!!this.has(t)&&this.get(t).hasData(e)},getData:function(t,e){if(this.has(t))return this.get(t).getData(e)},setData:function(t,e,n){return this.has(t)&&this.get(t).setData(e,n),this}};Phaser.Geom.Rectangle;var Dt=Phaser.Math.Vector2,Lt=Phaser.Math.RotateAround,At=void 0,It=function(t,e,n){void 0===n&&(n=!1),0!==t.rotation&&Lt(e,t.x,t.y,t.rotation),n&&t.parentContainer&&t.parentContainer.getBoundsTransformMatrix().transformPoint(e.x,e.y,e);return e},Nt=Phaser.Utils.Objects.GetValue,Wt=function(t,e,n,i,s,r,a){if(t.getBounds||void 0!==t.width&&void 0!==t.height){void 0===n&&(n=16777215),void 0===i&&(i=1),void 0===s&&(s=null),void 0===r&&(r=1),void 0===a&&(a=0);var o,u,c,h=(o=t,void 0===(u=Ut[0])?u=new Dt:!0===u&&(void 0===At&&(At=new Dt),u=At),o.getTopLeft?o.getTopLeft(u):(u.x=o.x-wt(o)*o.originX,u.y=o.y-St(o)*o.originY,It(o,u,c)));h.x-=a,h.y-=a;var l,f,d,p=(l=t,void 0===(f=Ut[1])?f=new Dt:!0===f&&(void 0===At&&(At=new Dt),f=At),l.getTopRight?l.getTopRight(f):(f.x=l.x-wt(l)*l.originX+wt(l),f.y=l.y-St(l)*l.originY,It(l,f,d)));p.x+=a,p.y-=a;var g,m,v,y=(g=t,void 0===(m=Ut[2])?m=new Dt:!0===m&&(void 0===At&&(At=new Dt),m=At),g.getBottomRight?g.getBottomRight(m):(m.x=g.x-wt(g)*g.originX+wt(g),m.y=g.y-St(g)*g.originY+St(g),It(g,m,v)));y.x+=a,y.y+=a;var k,b,E,M=(k=t,void 0===(b=Ut[3])?b=new Dt:!0===b&&(void 0===At&&(At=new Dt),b=At),k.getBottomLeft?k.getBottomLeft(b):(b.x=k.x-wt(k)*k.originX,b.y=k.y-St(k)*k.originY+St(k),It(k,b,E)));M.x-=a,M.y+=a,null!==s&&e.fillStyle(s,r).fillPoints(Ut,!0,!0),null!==n&&e.lineStyle(i,n).strokePoints(Ut,!0,!0)}},Ut=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],Jt={drawGameObjectsBounds:function(e,n){return this.forEachGO(function(t){t.drawBounds?t.drawBounds(e,n):function(t,e,n){var i,s,r,a,o;if("number"==typeof n?i=n:(i=Nt(n,"color"),s=Nt(n,"lineWidth"),r=Nt(n,"fillColor"),a=Nt(n,"fillAlpha",1),o=Nt(n,"padding",0)),Array.isArray(t))for(var u=0,c=t.length;u<c;u++)Wt(t[u],e,i,s,r,a,o);else Wt(t,e,i,s,r,a,o)}(t,e,n)}),this}};Object.assign(Jt,Pt,Bt,Rt,Vt,_t,Ft);function zt(t,e,n){return e instanceof Xt||(n=e,e=void 0),void 0===n?n=new Yt:!0===n&&(n=$t),e?t.scale.getViewPort(e,n):t.scale.getViewPort(n)}var Xt=Phaser.Cameras.Scene2D.BaseCamera,Yt=Phaser.Geom.Rectangle,$t=new Yt,Ht=Phaser.Utils.Objects.GetValue,Kt=function(){function s(t,e){u(this,s),this.scene=t,this.BobClass=Ht(e,"BobClass",kt),this.setCreateGameObjectCallback(Ht(e,"createGameObject"),Ht(e,"createGameObjectScope")),this.setEventEmitter(Ht(e,"eventEmitter",void 0));var n=Ht(e,"fade",500);"number"==typeof n?(this.setGOFadeMode(),this.setGOFadeTime(n)):(this.setGOFadeMode(Ht(n,"mode")),this.setGOFadeTime(Ht(n,"time",500)));var i=Ht(e,"viewportCoordinate",!1);!1!==i?(this.setViewportCoordinateEnable(Ht(e,"enable",!0)),this.setViewport(Ht(i,"viewport"))):this.setViewportCoordinateEnable(!1),this.setSymbols(Ht(e,"symbols")),this.bobs={},this.removedGOs=[],this._timeScale=1}return c(s,[{key:"destroy",value:function(t){this.clear(!t),this.createGameObjectCallback=void 0,this.viewport=void 0,this.scene=void 0}},{key:"timeScale",get:function(){return this._timeScale},set:function(t){if(this._timeScale!==t){this._timeScale=t;var e=this.bobs;for(var n in e)e[n].setTimeScale(t)}}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setCreateGameObjectCallback",value:function(t,e){return this.createGameObjectCallback=t,this.createGameObjectScope=e,this}},{key:"setViewportCoordinateEnable",value:function(t){return void 0===t&&(t=!0),this.viewportCoordinateEnable=t,this}},{key:"setViewport",value:function(t){return void 0===t&&(t=zt(this.scene,this.scene.cameras.main)),this.viewport=t,this}},{key:"setSymbols",value:function(t){return this.symbols=t,this}},{key:"isEmpty",get:function(){return function(t){for(var e in t)return!1;return!0}(this.bobs)&&0===this.removedGOs.length}}]),s}();Object.assign(Kt.prototype,t,Jt);function qt(n){var t=function(){h(e,n);var t=f(e);function e(){return u(this,e),t.apply(this,arguments)}return c(e)}(),e={initManagers:nt,setTimeScale:it,getTimeScale:st,destroyManagers:rt};return Object.assign(t.prototype,e,ee,ne),t}function Zt(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===e.indexOf("."))return n;for(var i=e.split("."),s=t,r=n,a=0;a<i.length;a++){if(!s.hasOwnProperty(i[a])){r=n;break}r=s[i[a]],s=s[i[a]]}return r}return n}function Qt(t){return"string"!=typeof t||(""===t?t=null:ie.test(t)?t=parseFloat(t):se.test(t)?t=parseInt(t,16):"false"===t?t=!1:"true"===t&&(t=!0)),t}function te(t){return t.replace(re,"\\$&").replace(ae,"\\x2d")}var ee={addGameObjectManager:function(t,e){void 0===t&&(t={}),void 0===e&&(e=Kt),t.createGameObjectScope||(t.createGameObjectScope=this);var n=new e(this.managersScene,t);return this.gameObjectManagers[t.name]=n,this},getGameObjectManager:function(t){return this.gameObjectManagers[t]},getGameObjectManagerNames:function(){var t=[];for(var e in this.gameObjectManagers)t.push(e);return t}},ne={createGameObject:function(t,e){for(var n,i=arguments.length,s=new Array(2<i?i-2:0),r=2;r<i;r++)s[r-2]=arguments[r];return(n=this.getGameObjectManager(t)).add.apply(n,[e].concat(s)),this},destroyGameObject:function(t,e){var n=this.getGameObjectManager(t);return void 0===e?n.removeAll():n.remove(e),this},callGameObjectMethod:function(t,e,n){for(var i,s=arguments.length,r=new Array(3<s?s-3:0),a=3;a<s;a++)r[a-3]=arguments[a];return(i=this.getGameObjectManager(t)).call.apply(i,[e,n].concat(r)),this},setGameObjectProperty:function(t,e,n,i){return this.getGameObjectManager(t).setProperty(e,n,i),this},easeGameObjectProperty:function(t,e,n,i,s,r,a,o){return this.getGameObjectManager(t).easeProperty(e,n,i,s,r,a,o),this},getGameObject:function(t,e,n){var i=this.getGameObjectManager(t);if("string"==typeof e)return i.getGO(e);var s=e;for(e in void 0===s&&(s=i.bobs),void 0===n&&(n={}),s)n[e]=i.getGO(e);return n},addGameObject:function(t,e,n){var i=this.getGameObjectManager(t);if("string"==typeof e)i.addGO(e,n);else{var s=e;for(e in s)i.addGO(e,s[e])}return this},drawGameObjectsBounds:function(t,e,n){t instanceof Phaser.GameObjects.Graphics&&(n=e,e=t,t=void 0),void 0===t&&(t=this.getGameObjectManagerNames()),Array.isArray(t)||(t=[t]);for(var i=0,s=t.length;i<s;i++)this.getGameObjectManager(t[i]).drawGameObjectsBounds(e,n);return this}},ie=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,se=/^0x[0-9A-F]+$/i,re=/[|\\{}()[\]^$+*?.]/g,ae=/-/g,oe=function(){function n(t){u(this,n),this.setEventEmitter(Zt(t,"eventEmitter",void 0)),this.setValueConverter(Zt(t,"valueConvert",!0)),this.setLoopEnable(Zt(t,"loop",!1)),this.setMultipleLinesTagEnable(Zt(t,"multipleLinesTag",!1));var e=Zt(t,"delimiters","<>");this.setDelimiters(e[0],e[1]),this.setTranslateTagNameCallback(Zt(t,"translateTagNameCallback")),this.isRunning=!1,this.isPaused=!1,this.skipEventFlag=!1,this.justCompleted=!1,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null}return c(n,[{key:"shutdown",value:function(){this.destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setMultipleLinesTagEnable",value:function(t){return void 0===t&&(t=!0),this.multipleLinesTagEnable=t,this}},{key:"setDelimiters",value:function(t,e){void 0===e&&(e=t[1],t=t[0]),this.delimiterLeft=t,this.delimiterRight=e,t=te(this.delimiterLeft),e=te(this.delimiterRight);var n=this.multipleLinesTagEnable?"gs":"gi";return this.reSplit=RegExp("".concat(t,"(.+?)").concat(e),n),this}},{key:"setTranslateTagNameCallback",value:function(t){return this.translateTagNameCallback=t,this}},{key:"setValueConverter",value:function(t){return t=!0===t?Qt:t||ue,this.valueConverter=t,this}},{key:"setLoopEnable",value:function(t){return void 0===t&&(t=!0),this.loopEnable=t,this}},{key:"setSource",value:function(t){return this.source=t,this}},{key:"resetIndex",value:function(t){return void 0===t&&(t=0),this.progressIndex=t,this.reSplit.lastIndex=t,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null,this.justCompleted=!1,this.isRunning=!1,this}},{key:"start",value:function(t){return this.setSource(t).restart(),this}},{key:"restart",value:function(){this.resetIndex().next()}},{key:"next",value:function(){if(this.isPaused&&this.onResume(),this.isRunning)return this;if(this.isRunning=!0,this.justCompleted)return this.isRunning=!1,this;0===this.reSplit.lastIndex&&this.onStart();var t=this.source,e=t.length;for(this.reSplit.lastIndex=this.progressIndex;;){var n=this.reSplit.exec(t);if(!n){if(this.progressIndex<e&&(this.onContent(t.substring(this.progressIndex,e)),this.isPaused)){this.progressIndex=e;break}return this.onComplete(),void(this.isRunning=!1)}var i=this.reSplit.lastIndex,s=i-n[0].length;if(this.progressIndex<s&&(this.onContent(t.substring(this.progressIndex,s)),this.isPaused)){this.progressIndex=s;break}if(this.onTag(n[1]),this.progressIndex=i,this.isPaused)break}return this.isRunning=!1,this}},{key:"skipEvent",value:function(){return this.skipEventFlag=!0,this}},{key:"pause",value:function(){return this.isPaused||this.onPause(),this}},{key:"pauseUntilEvent",value:function(t,e){return this.isPaused||(this.pause(),t.once(e,function(){this.next()},this)),this}},{key:"onContent",value:function(t){this.skipEventFlag=!1,this.emit("content",t),this.lastContent=t}},{key:"onTag",value:function(){}},{key:"onStart",value:function(){this.isRunning=!0,this.emit("start",this)}},{key:"onComplete",value:function(){this.isRunning=!1,this.justCompleted=!0,this.emit("complete",this),this.loopEnable&&this.resetIndex()}},{key:"onPause",value:function(){this.isPaused=!0,this.emit("pause",this)}},{key:"onResume",value:function(){this.isPaused=!1,this.emit("resume",this)}}]),n}(),ue=function(t){return t};Object.assign(oe.prototype,t);var ce=function(){h(a,oe);var i=f(a);function a(t){var e;u(this,a),void 0===t&&(t={}),t.hasOwnProperty("multipleLinesTag")||(t.multipleLinesTag=!1),(e=i.call(this,t)).setTagExpression(Zt(t,"regex.tag",void 0)),e.setValueExpression(Zt(t,"regex.value",void 0));var n=Zt(t,"delimiters","<>");return e.setDelimiters(n[0],n[1]),e}return c(a,[{key:"setTagExpression",value:function(t){return t=t||he,this.tagExpression=t,this}},{key:"setValueExpression",value:function(t){return t=t||he,this.valueExpression=t,this}},{key:"setDelimiters",value:function(t,e){d(l(a.prototype),"setDelimiters",this).call(this,t,e);var n="(".concat(this.tagExpression,")(=(").concat(this.valueExpression,"))?");if(this.reTag=RegExp(n,"i"),this.tagExpression!==he||this.valueExpression!==he){var i="".concat(this.tagExpression,"(=").concat(this.valueExpression,")?"),s="/".concat(this.tagExpression);t=te(this.delimiterLeft),e=te(this.delimiterRight);var r=this.multipleLinesTagEnable?"gs":"gi";this.reSplit=RegExp("".concat(t,"((").concat(i,")|(").concat(s,"))").concat(e),r)}return this}},{key:"onTag",value:function(t){var e=t.match(this.reTag),n=e[1],i="/"===n.charAt(0);if(i&&(n=n.substring(1,n.length)),this.translateTagNameCallback&&(n=this.translateTagNameCallback(n)),this.skipEventFlag=!1,i)this.emit("-".concat(n)),this.skipEventFlag||this.emit("-",n),this.lastTagEnd=n;else{var s=function(t,e){if(null==t)return[];for(var n=t.split(","),i=0,s=n.length;i<s;i++)n[i]=e(n[i]);return n}(e[3],this.valueConverter);this.emit.apply(this,["+".concat(n)].concat(p(s))),this.skipEventFlag||this.emit.apply(this,["+",n].concat(p(s))),this.lastTagStart=n}}}]),a}(),he="[^=]+",le=Phaser.Math.DegToRad,fe=[function(e,n){n.on("+".concat("wait"),function(t){e.wait(t),n.skipEvent()}).on("-".concat("wait"),function(){n.skipEvent()}).on("+".concat("click"),function(){e.wait("click"),n.skipEvent()}).on("-".concat("click"),function(){n.skipEvent()})},function(n,i){var t="se";i.on("+".concat(t),function(t,e){this.skipSoundEffect||(n.soundManager.playSoundEffect(t),e&&n.soundManager.fadeInSoundEffect(e),i.skipEvent())}).on("-".concat(t),function(){i.skipEvent()});t="se2";i.on("+".concat(t),function(t,e){this.skipSoundEffect||(n.soundManager.playSoundEffect2(t),e&&n.soundManager.fadeInSoundEffect2(e),i.skipEvent())}).on("-".concat(t),function(){i.skipEvent()})},function(e,n){var t="se.fadein";n.on("+".concat(t),function(t){e.soundManager.fadeInSoundEffect(t),n.skipEvent()}).on("-".concat(t),function(){n.skipEvent()});t="se2.fadein";n.on("+".concat(t),function(t){e.soundManager.fadeInSoundEffect2(t),n.skipEvent()}).on("-".concat(t),function(){n.skipEvent()})},function(n,i){var t="se.fadeout";i.on("+".concat(t),function(t,e){e="stop"===e,n.soundManager.fadeOutSoundEffect(t,e),i.skipEvent()}).on("-".concat(t),function(){i.skipEvent()});t="se2.fadeout";i.on("+".concat(t),function(t,e){e="stop"===e,n.soundManager.fadeOutSoundEffect2(t,e),i.skipEvent()}).on("-".concat(t),function(){i.skipEvent()})},function(e,n){var t="se.volume";n.on("+".concat(t),function(t){e.soundManager.setSoundEffectVolume(t,!0),n.skipEvent()}).on("-".concat(t),function(){n.skipEvent()});t="se2.volume";n.on("+".concat(t),function(t){e.soundManager.setSoundEffectVolume2(t,!0),n.skipEvent()}).on("-".concat(t),function(){n.skipEvent()})},function(n,i){var t="bgm";i.on("+".concat(t),function(t,e){n.soundManager.playBackgroundMusic(t),e&&n.soundManager.fadeInBackgroundMusic(e),i.skipEvent()}).on("-".concat(t),function(){n.soundManager.stopBackgroundMusic(),i.skipEvent()});t="bgm2";i.on("+".concat(t),function(t,e){n.soundManager.playBackgroundMusic2(t),e&&n.soundManager.fadeInBackgroundMusic2(e),i.skipEvent()}).on("-".concat(t),function(){n.soundManager.stopBackgroundMusic2(),i.skipEvent()})},function(e,n){var t="bgm.fadein";n.on("+".concat(t),function(t){e.soundManager.fadeInBackgroundMusic(t),n.skipEvent()}).on("-".concat(t),function(){n.skipEvent()});t="bgm2.fadein";n.on("+".concat(t),function(t){e.soundManager.fadeInBackgroundMusic2(t),n.skipEvent()}).on("-".concat(t),function(){n.skipEvent()})},function(n,i){var t="bgm.fadeout";i.on("+".concat(t),function(t,e){e="stop"===e,n.soundManager.fadeOutBackgroundMusic(t,e),i.skipEvent()}).on("-".concat(t),function(){i.skipEvent()});t="bgm2.fadeout";i.on("+".concat(t),function(t,e){e="stop"===e,n.soundManager.fadeOutBackgroundMusic2(t,e),i.skipEvent()}).on("-".concat(t),function(){i.skipEvent()})},function(n,i){var t="bgm.cross";i.on("+".concat(t),function(t,e){n.soundManager.crossFadeBackgroundMusic(t,e),i.skipEvent()}).on("-".concat(t),function(){i.skipEvent()});t="bgm2.cross";i.on("+".concat(t),function(t,e){n.soundManager.crossFadeBackgroundMusic2(t,e),i.skipEvent()}).on("-".concat(t),function(){i.skipEvent()})},function(t,e){var n="bgm.pause";e.on("+".concat(n),function(){t.soundManager.pauseBackgroundMusic(),e.skipEvent()}).on("-".concat(n),function(){t.soundManager.resumeBackgroundMusic(),e.skipEvent()});n="bgm2.pause";e.on("+".concat(n),function(){t.soundManager.pauseBackgroundMusic2(),e.skipEvent()}).on("-".concat(n),function(){t.soundManager.resumeBackgroundMusic2(),e.skipEvent()})},function(s,r){r.on("+".concat("camera.fadein"),function(t,e,n,i){s.targetCamera.fadeIn(t,e,n,i),r.skipEvent()})},function(s,r){r.on("+".concat("camera.fadeout"),function(t,e,n,i){s.targetCamera.fadeOut(t,e,n,i),r.skipEvent()})},function(n,i){i.on("+".concat("camera.shake"),function(t,e){n.targetCamera.shake(t,e),i.skipEvent()})},function(s,r){r.on("+".concat("camera.flash"),function(t,e,n,i){s.targetCamera.flash(t,e,n,i),r.skipEvent()})},function(i,s){var t="camera.zoom";s.on("+".concat(t),function(t){i.targetCamera.setZoom(t),s.skipEvent()}).on("+".concat(t,".to"),function(t,e,n){i.targetCamera.zoomTo(t,e,n),s.skipEvent()})},function(i,s){var t="camera.rotate";s.on("+".concat(t),function(t){i.targetCamera.setRotation(le(t)),s.skipEvent()}).on("+".concat(t,".to"),function(t,e,n){t=le(t),i.targetCamera.rotateTo(le(t),!1,e,n),s.skipEvent()})},function(o,u){var t="camera.scroll";u.on("+".concat(t),function(t,e){o.targetCamera.setScroll(t,e),u.skipEvent()}).on("+".concat(t,".to"),function(t,e,n,i){var s=o.targetCamera,r=s.scrollX,a=s.scrollY;s.setScroll(t,e),t+=s.centerX,e+=s.centerY,s.setScroll(r,a),s.pan(t,e,n,i),u.skipEvent()})},function(i,s){s.on("content",function(t){if(!s.skipEventFlag&&"\n"!==t){t=t.replaceAll("\\n","\n");var e=i.contentCallback;if(e){var n=i.contentCallbackScope;n?e.call(n,t):e(t),s.skipEvent()}i.emit("+".concat(s.lastTagStart,"#content"),t),i.emit("content",t)}})},function(s,r){r.on("+",function(t){if(!r.skipEventFlag){for(var e=arguments.length,n=new Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];s.emit.apply(s,["+".concat(t),r].concat(n))}}).on("-",function(t){r.skipEventFlag||s.emit("-".concat(t),r)})}],de=Phaser.Utils.Objects.GetValue,pe=function(){h(s,ce);var i=f(s);function s(t,e){var n;return u(this,s),void 0===e&&(e={}),e.hasOwnProperty("delimiters")||(e.delimiters="[]"),function(t,e,n){for(var i=0,s=fe.length;i<s;i++)fe[i](t,e,n);e.on("start",function(){t.emit("start",e)}).on("complete",function(){t.emit("complete",e)})}(t,o(n=i.call(this,e)),e),n.setCommentLineStartSymbol(de(e,"comment","//")),n}return c(s,[{key:"setCommentLineStartSymbol",value:function(t){return this.commentLineStart=t,this}},{key:"start",value:function(t){return d(l(s.prototype),"start",this).call(this,function(t,e){for(var n=t.commentLineStart,i=e.split("\n"),s=0,r=i.length;s<r;s++){var a=i[s];""===a||(0===a.trim().length||n&&a.startsWith(n))&&(i[s]="")}return i.join("")}(this,t)),this}}]),s}(),ge=function(){h(e,kt);var t=f(e);function e(){return u(this,e),t.apply(this,arguments)}return c(e,[{key:"playAnimation",value:function(t){return this.gameObject.anims.timeScale=this.timeScale,this.gameObject.play(t),this}},{key:"stopAnimation",value:function(){return this.gameObject.stop(),this}},{key:"chainAnimation",value:function(t){return this.gameObject.chain(t),this}},{key:"pauseAnimation",value:function(){return this.gameObject.anims.pause(),this}},{key:"setTimeScale",value:function(t){return d(l(e.prototype),"setTimeScale",this).call(this,t),this.gameObject.anims&&(this.gameObject.anims.timeScale=t),this}}]),e}(),me={};Object.assign(me,{playAnimation:function(t,e){return this.has(t)||this.add(t),this.get(t).playAnimation(e),this},stopAnimation:function(t){return this.has(t)&&this.get(t).stopAnimation(),this},chainAnimation:function(t,e){return this.has(t)&&this.get(t).chainAnimation(e),this},pauseAnimation:function(t){return this.has(t)&&this.get(t).pauseAnimation(),this}});var ve=function(){h(i,Kt);var n=f(i);function i(t,e){return u(this,i),void 0===e&&(e={}),e.BobClass=ge,n.call(this,t,e)}return c(i,[{key:"setCreateGameObjectCallback",value:function(t,e){return t&&"sprite"!==t?"image"===t&&(t=ke):t=ye,d(l(i.prototype),"setCreateGameObjectCallback",this).call(this,t,e),this}}]),i}(),ye=function(t,e,n){return"string"!=typeof n&&"number"!=typeof n&&(n=void 0),t.add.sprite(0,0,e,n)},ke=function(t,e,n){return"string"!=typeof n&&"number"!=typeof n&&(n=void 0),t.add.image(0,0,e,n)};Object.assign(ve.prototype,me);function be(t,e){return 3===t.length&&t[0]===e&&"play"===t[2]}function Ee(t){return t instanceof Te?2:t instanceof Oe?0:1}var Me=[function(t,r,e){var a=e.name,o=t.getGameObjectManager(a);r.on("+",function(t){if(!r.skipEventFlag){var e,n=t.split(".");if(be(n,a)){e=n[1];var i=Array.prototype.slice.call(arguments,1),s=i.shift();o.playAnimation(e,s),0<i.length&&o.chainAnimation(e,i),r.skipEvent()}}}).on("+",function(t){if(!r.skipEventFlag){var e,n,i,s=t.split(".");if(i=a,3===(n=s).length&&n[0]===i&&"stop"===n[2])e=s[1],o.stopAnimation(e),r.skipEvent()}}).on("-",function(t){if(!r.skipEventFlag){var e,n=t.split(".");be(n,a)&&(e=n[1],o.stopAnimation(e),r.skipEvent())}})},function(t,r,e){var a=e.name,o=t.getGameObjectManager(a);r.on("+",function(t){if(!r.skipEventFlag){var e,n,i,s=t.split(".");if(i=a,3===(n=s).length&&n[0]===i&&"pause"===n[2])e=s[1],o.pauseAnimation(e),r.skipEvent()}})},function(t,a,e){var o=e.name,u=t.getGameObjectManager(o);a.on("+",function(t){if(!a.skipEventFlag){var e,n=t.split(".");if(s=o,3===(i=n).length&&i[0]===s&&"chain"===i[2]){var i,s;e=n[1];var r=Array.prototype.slice.call(arguments,1);u.chainAnimation(e,r),a.skipEvent()}}})}],Oe=Phaser.GameObjects.Text,Te=Phaser.GameObjects.BitmapText,we=Phaser.Utils.Objects.GetFastValue,Se=Phaser.Utils.Objects.GetValue,je=function(){h(s,y);var i=f(s);function s(t,e){var n;return u(this,s),(n=i.call(this,t,e)).timer=null,n.resetFromJSON(e),n}return c(s,[{key:"resetFromJSON",value:function(t){this.setTextWrapEnable(Se(t,"wrap",!1)),this.setTypeMode(Se(t,"typeMode",0)),this.setTypingSpeed(Se(t,"speed",333)),this.setTextCallback=we(t,"setTextCallback",null),this.setTextCallbackScope=we(t,"setTextCallbackScope",null),this.setTypingContent(we(t,"text","")),this.typingIdx=we(t,"typingIdx",0),this.insertIdx=we(t,"insertIdx",null);var e=we(t,"elapsed",null);return null!==e&&this.start(void 0,void 0,this.typingIdx,e),this}},{key:"shutdown",value:function(t){this.isShutdown||(this.freeTimer(),d(l(s.prototype),"shutdown",this).call(this,t))}},{key:"setTypeMode",value:function(t){return"string"==typeof t&&(t=xe[t]),this.typeMode=t,this}},{key:"setTypeSpeed",value:function(t){return this.speed=t,this}},{key:"setTypingSpeed",value:function(t){return this.speed=t,this}},{key:"setTextWrapEnable",value:function(t){return void 0===t&&(t=!0),this.textWrapEnable=t,this}},{key:"text",get:function(){return this._text},set:function(t){var e=Pe(t);this.textWrapEnable&&(e=function(t,e){switch(Ee(t)){case 0:t.style.syncFont(t.canvas,t.context),e=t.runWordWrap(e);break;case 1:e=t.getText(e,void 0,void 0,!0);break;case 2:e=t.setText(e).getTextBounds().wrappedText}return e}(this.parent,e)),this._text=e}},{key:"isTyping",get:function(){return null!==this.getTimer()}},{key:"isLastChar",get:function(){return this.typingIdx===this.textLen}},{key:"start",value:function(t,e,n,i){return void 0!==t&&this.setTypingContent(t),void 0!==e&&(this.speed=e),void 0===n&&(n=0),this.typingIdx=n+1,0===this.speed?this.stop(!0):(this.setText(""),this.startTimer(i)),this}},{key:"appendText",value:function(t){var e=this.text.concat(Pe(t));return this.isTyping?this.setTypingContent(e):this.start(e,void 0,this.textLen),this}},{key:"stop",value:function(t){return this.getTimer()&&this.freeTimer(),t&&(this.typingIdx=this.textLen,this.setText(this.text),this.emit("type"),this.emit("complete",this,this.parent)),this}},{key:"pause",value:function(){var t=this.getTimer();return t&&(t.paused=!0),this}},{key:"resume",value:function(){var t=this.getTimer();return t&&(t.paused=!1),this}},{key:"setTypingContent",value:function(t){return this.text=t,this.textLen=this.getTextLength(this.text),this}},{key:"onTyping",value:function(){var t=this.getTypingString(this.text,this.typingIdx,this.textLen,this.typeMode);this.setText(t),this.emit("type"),this.isLastChar?(this.freeTimer(),this.emit("complete",this,this.parent)):(this.timer.delay=this.speed,this.typingIdx++)}},{key:"getTypingString",value:function(t,e,n,i){var s;if(0===i){var r=0,a=e;this.insertIdx=a,s=this.getSubString(t,r,a)}else if(1===i){r=(a=n)-e;this.insertIdx=0,s=this.getSubString(t,r,a)}else if(2===i){var o=n/2;a=(r=Math.floor(o-e/2))+e;this.insertIdx=e%2?e:0,s=this.getSubString(t,r,a)}else if(3===i){var u,c=Math.floor(e/2);if(0<c){r=(a=n)-c;u=this.getSubString(t,r,a)}else u="";var h,l=e-c;if(0<l){a=(r=0)+l;this.insertIdx=a,h=this.getSubString(t,r,a)}else h="",this.insertIdx=0;s=h+u}return s}},{key:"startTimer",value:function(t){var e;return this.timer&&this.freeTimer(),e=void 0===t?0:(this.speed,t),this.timer=this.scene.time.addEvent({delay:1e-4,startAt:e,loop:!0,callback:this.onTyping,callbackScope:this}),this}},{key:"getTimer",value:function(){return this.timer}},{key:"freeTimer",value:function(){return this.timer&&(this.timer.remove(),this.timer=null),this}},{key:"setText",value:function(t){this.setTextCallback&&(t=this.setTextCallbackScope?this.setTextCallback.call(this.setTextCallbackScope,t,this.isLastChar,this.insertIdx):this.setTextCallback(t,this.isLastChar,this.insertIdx)),this.textWrapEnable?function(t,e){switch(Ee(t)){case 0:var n=(s=t.style).wordWrapWidth,i=s.wordWrapCallback;s.wordWrapWidth=0,s.wordWrapCallback=void 0,t.setText(e),s.wordWrapWidth=n,s.wordWrapCallback=i;break;case 1:var s,r=(s=t.style).wrapMode;s.wrapMode=0,t.setText(e),s.wrapMode=r;break;case 2:var a=t._maxWidth;t._maxWidth=0,t.setText(e),t._maxWidth=a}}(this.parent,t):this.parent.setText(t)}},{key:"getTextLength",value:function(t){var e=this.parent;return e.getPlainText?e.getPlainText(t).length:t.length}},{key:"getSubString",value:function(t,e,n){var i=this.parent;return i.getSubString?i.getSubString(t,e,n):t.slice(e,n)}}]),s}(),Pe=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t},xe={"left-to-right":0,"right-to-left":1,"middle-to-sides":2,"sides-to-middle":3},Ce=function(){h(n,kt);var t=f(n);function n(){return u(this,n),t.apply(this,arguments)}return c(n,[{key:"setGO",value:function(t,e){return d(l(n.prototype),"setGO",this).call(this,t,e),t.setData("typing",!0),this}},{key:"clearText",value:function(){return this.gameObject.setText(""),this}},{key:"appendText",value:function(t){return this.gameObject.setText(this.gameObject.text+t),this}},{key:"setTypingSpeed",value:function(t){var e=this.gameObject;return e.typing||(e.typing=new je(e)),e.typing.setTypingSpeed(t),this}},{key:"clearTyping",value:function(){var t=this.gameObject;return t.typing?t.typing.start(""):t.typing=new je(t),this}},{key:"typing",value:function(t,e){var n=this.gameObject;return n.typing||(n.typing=new je(n)),void 0!==e&&n.typing.setTypingSpeed(e),n.setData("typing",!1),n.typing.once("complete",function(){n.setData("typing",!0)}).appendText(t),this}}]),n}(),Ge={};Object.assign(Ge,{clearText:function(t){return this.has(t)&&this.get(t).clearText(),this},appendText:function(t,e){return this.has(t)&&this.get(t).appendText(e),this},clearTyping:function(t){return this.has(t)&&this.get(t).clearTyping(),this},typing:function(t,e){return this.has(t)&&this.get(t).typing(e),this},appendTyping:function(t,e){return this.has(t)&&this.get(t).appendTyping(e),this},setTypingSpeed:function(t,e){return this.has(t)&&this.get(t).setTypingSpeed(e),this}});var Be=function(){h(i,Kt);var n=f(i);function i(t,e){return u(this,i),void 0===e&&(e={}),e.BobClass=Ce,n.call(this,t,e)}return c(i,[{key:"setCreateGameObjectCallback",value:function(t,e){return t&&"text"!==t||(t=Re),d(l(i.prototype),"setCreateGameObjectCallback",this).call(this,t,e),this}}]),i}(),Re=function(t){return t.add.text(0,0,"")};Object.assign(Be.prototype,Ge);function Ve(t,e){return 2===t.length&&t[0]===e}function _e(t){return n=t,i="complete",new Promise(function(t,e){n.once(i,function(){t()})});var n,i}function Fe(t,e,n,i,s){return function(){t.emit(qe,s),e.apply(i,n)}}function De(t,e,n,i,s){var r=Fe(t,n,i,s,"custom"),a=e?"wait.".concat(e):"wait";t.emit(a,r)}function Le(t,e,n,i,s){var r,a=Fe(t,n,i,s,"time");t.once(qe,function(){r&&(r.remove(),r=void 0)}),r=t.timeline.delayCall(e,a),t.emit("wait.time",e)}function Ae(t,e,n,i){var s=t.clickEE;if(s){var r=Fe(t,e,n,i,"click");t.once(qe,function(){s.off("pointerdown",r,t)}),s.once("pointerdown",r,t),t.emit("wait.click")}}function Ie(t,e,n,i,s){var r=Fe(t,n,i,s,"music");e&&(t.once(qe,function(){e.off("complete",r,t)}),e.once("complete",r,t)),t.emit("wait.music",e),e||r()}function Ne(t){switch(t){case"camera.fadein":case"camera.fadeout":case"camera.flash":case"camera.shake":case"camera.zoom":case"camera.rotate":case"camera.scroll":return 1;default:return}}function We(e,t,n,i,s){var r,a,o=Fe(e,n,i,s,"camera.".concat(t)),u=e.targetCamera;switch(t){case"camera.fadein":r=u.fadeEffect,a="camerafadeincomplete";break;case"camera.fadeout":r=u.fadeEffect,a="camerafadeoutcomplete";break;case"camera.flash":r=u.flashEffect,a="cameraflashcomplete";break;case"camera.shake":r=u.shakeEffect,a="camerashakecomplete";break;case"camera.zoom":r=u.zoomEffect,a="camerazoomcomplete";break;case"camera.rotate":r=u.rotateToEffect,a="camerarotatecomplete";break;case"camera.scroll":r=u.panEffect,a="camerapancomplete"}r.isRunning?(e.once(qe,function(t){u.off(a,o,e)}),u.once(a,o,e),e.emit("wait.camera",t)):(e.emit("wait.camera",t),o())}function Ue(t,e,n,i,s){var r=Fe(t,n,i,s,"keydown"),a="keydown-".concat(e.toUpperCase()),o=t.scene.input.keyboard;t.once(qe,function(){o.off(a,r,t)}),o.once(a,r,t),t.emit("wait.keydown",e)}function Je(n,t,e,i,s){var r=Fe(n,e,i,s),a=t.split("."),o=a[0],u=n.getGameObjectManager(o),c="wait.".concat(o);switch(a.length){case 1:return void(u.isEmpty?(n.emit(c),r()):(n.once(qe,function(t){u.off("empty",r,n)}),u.once("empty",r,n),n.emit(c)));case 2:var h=a[1];if(u.has(h)){var l=u.get(h).gameObject;n.once(qe,function(){l.off("destroy",r,n)}),l.once("destroy",r,n),n.emit(c,h)}else n.emit(c,h),r();return;case 3:h=a[1];var f=a[2];if(u.isNumberProperty(h,f)){var d=u.getTweenTask(h,f);return void(d?(n.once(qe,function(){d.off("complete",r,n)}),d.once("complete",r,n),n.emit(c,h,f)):(n.emit(c,h,f),r()))}var p=f,g=p.startsWith("!");if(g&&(p=p.substring(1)),u.hasData(h,p)){var m=(l=u.getGO(h)).getData(p),v=!g;if(m===v)n.emit(c,h,f),r();else{var y="changedata-".concat(p);e=function(t,e){(e=!!e)===v&&r.call(n)};n.once(qe,function(){l.off(y,e)}),l.on(y,e),n.emit(c,h,f)}return}}}var ze=[function(t,e,n){var i=n.name,s=t.getGameObjectManager(i);t.on("".concat(i,".text"),function(e){s.clearText(e),t.setContentCallback(function(t){s.appendText(e,t)})})},function(t,e,n){var i=n.name,s=t.getGameObjectManager(i);t.on("".concat(i,".typing"),function(e,n){s.clearTyping(e),t.setContentCallback(function(t){void 0!==n&&s.setTypingSpeed(e,n),s.typing(e,t)})})}],Xe={to:!0,yoyo:!0,from:!0,toLeft:!0,toRight:!0,toUp:!0,toDown:!0,yoyoLeft:!0,yoyoRight:!0,yoyoUp:!0,yoyoDown:!0,fromLeft:!0,fromRight:!0,fromUp:!0,fromDown:!0},Ye=[function(t,a,e){var o=e.name,u=t.getGameObjectManager(o);a.on("+",function(t){if(!a.skipEventFlag){var e,n=t.split(".");if(Ve(n,o)){e=n[1];for(var i=arguments.length,s=new Array(1<i?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];u.add.apply(u,[e].concat(s)),a.skipEvent()}}}).on("-",function(t){if(!a.skipEventFlag){var e,n=t.split(".");Ve(n,o)&&(e=n[1],u.remove(e),a.skipEvent())}})},function(t,e,n){var i=n.name,s=t.getGameObjectManager(i);e.on("-",function(t){e.skipEventFlag||t===i&&(s.removeAll(),e.skipEvent())})},function(h,l,t){var f=t.name,d=h.getGameObjectManager(f);l.on("+",function(t){if(!l.skipEventFlag){var e,n,i=t.split(".");if(r=f,3===(s=i).length&&s[0]===r){var s,r;e=i[1],n=i[2];for(var a="".concat(f,".").concat(n),o=arguments.length,u=new Array(1<o?o-1:0),c=1;c<o;c++)u[c-1]=arguments[c];h.emit.apply(h,[a,e].concat(u)),0<h.listenerCount(a)||(d.hasMethod(e,n)?d.call.apply(d,[e,n].concat(u)):d.setProperty(e,n,u[0])),l.skipEvent()}}})},function(t,d,e){var p=e.name,g=t.getGameObjectManager(p);d.on("+",function(t,e,n,i,s){if(!d.skipEventFlag){var r,a,o,u,c=t.split(".");if(l=p,4===(h=c).length&&h[0]===l&&Xe[h[3]]&&(r=c[1],a=c[2],"number"==typeof(o=g.getProperty(r,a)))){var h,l;"number"==typeof i&&(s=i,i=void 0),(u=c[3]).endsWith("Left")||u.endsWith("Up")?u.startsWith("to")||u.startsWith("yoyo")?e=o-e:u.startsWith("from")&&(g.setProperty(r,a,o-e),e=o):u.endsWith("Right")||u.endsWith("Down")?u.startsWith("to")||u.startsWith("yoyo")?e=o+e:u.startsWith("from")&&(g.setProperty(r,a,o+e),e=o):"from"===u&&(g.setProperty(r,a,e),e=o);var f=u.startsWith("yoyo");g.easeProperty(r,a,e,n,i,s,f),d.skipEvent()}}})}],$e=ee.addGameObjectManager,He={addGameObjectManager:function(t,e){void 0===t&&(t={}),t.name||console.warn("Parameter 'name' is required in TagPlayer.addGameObjectManager(config) method"),$e.call(this,t,e);for(var n=t.parseCallbacks,i=0,s=(n=n?[].concat(p(n),Ye):Ye).length;i<s;i++)n[i](this,this.parser,t);return this}},Ke={play:function(t){return this.parser.start(t),this},playPromise:function(t){var e=_e(this);return this.play(t),e}},qe="_remove.wait",Ze=[qe,"_remove.play"],Qe=Phaser.Input.Keyboard.KeyCodes,tn=Phaser.Data.DataManager,en={destroyDataManager:function(){this.data&&(this.data.destroy(),this.data=void 0)},setDataEnabled:function(){return this.data||(this.data=new tn(this)),this},setData:function(t,e){return this.data||(this.data=new tn(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new tn(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new tn(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new tn(this)),this.data.get(t)}},nn={setClickTarget:function(t){return(this.clickTarget=t)?a(t)?this.clickEE=t.input:this.clickEE=t.setInteractive():this.clickEE=null,this},setTargetCamera:function(t){return this.targetCamera=t,this},setSkipSoundEffect:function(t){if(void 0===t&&(t=!0),this.skipSoundEffect=t){var e=this._soundManager;e&&e.fadeOutAllSoundEffects(100,!0)}return this},wait:function(t){return this.ignoreWait||(this.pause(),function(t,e,n,i,s){for(var r=0,a=(e="string"==typeof e&&1<e.length&&-1!==e.indexOf("|")?e.split("|"):[e]).length;r<a;r++){var o=e[r];if(null==o||"wait"===o)De(t,void 0,n,i,s);else if("number"!=typeof o&&isNaN(o))if("click"===o)Ae(t,n,i,s);else if("se"===o){var u=t.soundManager.getLastSoundEffect();Ie(t,u,n,i,s)}else if("se2"===o){u=t.soundManager.getLastSoundEffect2();Ie(t,u,n,i,s)}else if("bgm"===o){u=t.soundManager.getBackgroundMusic();Ie(t,u,n,i,s)}else if("bgm2"===o){u=t.soundManager.getBackgroundMusic2();Ie(t,u,n,i,s)}else Qe.hasOwnProperty(o.toUpperCase())?Ue(t,o,n,i,s):Ne(o)?We(t,o,n,i,s):(c=t,h=o.split("."),(c.gameObjectManagers.hasOwnProperty(h[0])?Je:De)(t,o,n,i,s));else Le(t,parseFloat(o),n,i,s)}var c,h}(this,t,this.resume,[],this)),this}};Object.assign(nn,Ke,{pause:function(){return this.parser.pause(),this},pauseUntilEvent:function(t,e){return this.parser.pauseUntilEvent(t,e),this}},{resume:function(){return this.parser.next(),this}},He,{getSprite:function(t){return this.getGameObject("sprite",t)},addSprite:function(t,e){return this.addGameObject("sprite",t,e),this}},{getTextGameObject:function(t){return this.getGameObject("text",t)},addTextGameObject:function(t,e){return this.addGameObject("text",t,e),this}},{setContentCallback:function(t,e){return this.contentCallback=t,this.contentCallbackScope=e,this}},en);var sn=Phaser.Events.EventEmitter,rn=Phaser.Utils.Objects.GetValue,an=function(){h(a,qt(sn));var r=f(a);function a(t,e){var n;u(this,a),void 0===e&&(e={}),(n=r.call(this)).scene=t,n.parser=new pe(o(n),rn(e,"parser",void 0)),n.setTargetCamera(rn(e,"camera",n.scene.sys.cameras.main)),n.initManagers(t,e);var i=rn(e,"sprites");!1!==i&&null!==i&&function(t){void 0===t&&(t={}),t.name="sprite",t.parseCallbacks=Me,this.addGameObjectManager(t,ve)}.call(o(n),i);var s=rn(e,"texts");return!1!==s&&null!==s&&function(t){void 0===t&&(t={}),t.name="text",t.parseCallbacks=ze,this.addGameObjectManager(t,Be)}.call(o(n),s),n.setClickTarget(rn(e,"clickTarget",t)),n}return c(a,[{key:"isPlaying",get:function(){return this.parser.isRunning}},{key:"spriteManager",get:function(){return this.getGameObjectManager("sprite")}},{key:"textManager",get:function(){return this.getGameObjectManager("text")}},{key:"gameObjectManagerNames",get:function(){var t=[];for(var e in this.gameObjectManagers)t.push(e);return t}},{key:"destroy",value:function(t){this.scene&&(function(t){for(var e=0,n=Ze.length;e<n;e++)t.emit(Ze[e])}(this),this.targetCamera=void 0,d(l(a.prototype),"destroy",this).call(this),this.destroyManagers(t),this.scene=void 0)}},{key:"timeScale",get:function(){return this.getTimeScale()},set:function(t){this.setTimeScale(t)}}]),a}();return Object.assign(an.prototype,nn),function(){h(n,Phaser.Plugins.BasePlugin);var e=f(n);function n(t){return u(this,n),e.call(this,t)}return c(n,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new an(t,e)}}]),n}()});
