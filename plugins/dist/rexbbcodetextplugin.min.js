!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rexbbcodetextplugin=e():t.rexbbcodetextplugin=e()}(window,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=331)}({1:function(t,e,i){"use strict";e.a={hleft:0,hcenter:1,hright:2,vtop:0,vcenter:1,vbottom:2,NO_NEWLINE:0,RAW_NEWLINE:1,WRAPPED_NEWLINE:2,NO_WRAP:0,WORD_WRAP:1,CHAR_WRAP:2,SPLITREGEXP:/(?:\r\n|\r|\n)/}},10:function(t,e,i){"use strict";var s=i(6);e.a=function(t,e){var i=Array.isArray(t);for(var n in void 0===e?e=i?[]:{}:Object(s.a)(e),i&&(e.length=t.length),t)e[n]=t[n];return e}},11:function(t,e,i){"use strict";var s=class{constructor(){this.items=[]}pop(){return this.items.length>0?this.items.pop():null}push(t){this.items.push(t)}pushMultiple(t){for(var e=0,i=t.length;e<i;e++)this.items.push(t[e]);t.length=0}};e.a=s},121:function(t,e){t.exports=function(t,e,i,s,n){0!==e.width&&0!==e.height&&t.batchSprite(e,e.frame,s,n)}},122:function(t,e){var i=Phaser.Renderer.WebGL.Utils;t.exports=function(t,e,s,n,r){if(0!==e.width&&0!==e.height){var o=e.frame,a=o.width,h=o.height,l=i.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,o.glTexture,a,h,e.x,e.y,a/e.style.resolution,h/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,a,h,l(e._tintTL,n.alpha*e._alphaTL),l(e._tintTR,n.alpha*e._alphaTR),l(e._tintBL,n.alpha*e._alphaBL),l(e._tintBR,n.alpha*e._alphaBR),e._isTinted&&e.tintFill,0,0,n,r)}}},27:function(t,e,i){"use strict";const s=Phaser.Display.Canvas.CanvasPool;var n={},r=function(t){var e=s.create(this),i=e.getContext("2d");t.syncFont(e,i);var r=Math.ceil(i.measureText(t.testString).width*t.baselineX),o=r,a=2*o;o=o*t.baselineY|0,e.width=r,e.height=a,i.fillStyle="#f00",i.fillRect(0,0,r,a),i.font=t._font,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(t.testString,0,o);var h=n;if(!i.getImageData(0,0,r,a))return h.ascent=o,h.descent=o+6,h.fontSize=h.ascent+h.descent,s.remove(e),h;var l,d,u=i.getImageData(0,0,r,a).data,c=u.length,f=4*r,p=0,g=!1;for(l=0;l<o;l++){for(d=0;d<f;d+=4)if(255!==u[p+d]){g=!0;break}if(g)break;p+=f}for(h.ascent=o-l,p=c-f,g=!1,l=a;l>o;l--){for(d=0;d<f;d+=4)if(255!==u[p+d]){g=!0;break}if(g)break;p-=f}return h.descent=l-o,h.fontSize=h.ascent+h.descent,s.remove(e),h},o=i(1);const a=Phaser.Utils.Objects.GetAdvancedValue,h=Phaser.Utils.Objects.GetValue;var l={backgroundColor:["backgroundColor",null],fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],underlineColor:["underline.color","#000"],underlineThickness:["underline.thickness",0],underlineOffset:["underline.offset",0],halign:["halign",0],valign:["valign",0],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],lineSpacing:["lineSpacing",0],rtl:["rtl",!1],testString:["testString","|MÃ‰qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wrapMode:["wrap.mode",1],wrapWidth:["wrap.width",0]};const d={left:o.a.hleft,center:o.a.hcenter,right:o.a.hright},u={top:o.a.vtop,center:o.a.vcenter,bottom:o.a.vbottom},c={none:o.a.NO_WRAP,word:o.a.WORD_WRAP,char:o.a.CHAR_WRAP,character:o.a.CHAR_WRAP};e.a=class{constructor(t,e){this.parent=t,this.backgroundColor,this.fontFamily,this.fontSize,this.fontStyle,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.underlineColor,this.underlineThickness,this.underlineOffset,this.halign,this.valign,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.lineSpacing,this.rtl,this.testString,this.baselineX,this.baselineY,this._font,this.setStyle(e,!1);var i=h(e,"metrics",!1);this.metrics=i?{ascent:h(i,"ascent",0),descent:h(i,"descent",0),fontSize:h(i,"fontSize",0)}:r(this)}setStyle(t,e){if(void 0===e&&(e=!0),t&&t.hasOwnProperty("halign")&&"string"==typeof t.halign&&(t.halign=d[t.halign.toLowerCase()]||0),t&&t.hasOwnProperty("valign")&&"string"==typeof t.valign&&(t.valign=u[t.valign.toLowerCase()]||0),t&&t.hasOwnProperty("wrap")){var i=t.wrap;if(i.hasOwnProperty("mode")){var s=i.mode;"string"==typeof s&&(i.mode=c[s])}else i.hasOwnProperty("width")&&(i.mode=1)}for(var n in t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),l)this[n]="wrapCallback"===n||"wrapCallbackScope"===n?h(t,l[n][0],l[n][1]):a(t,l[n][0],l[n][1]);var r=h(t,"font",null);this._font=null===r?this.fontStyle+" "+this.fontSize+" "+this.fontFamily:r;var o=h(t,"fill",null);return null!==o&&(this.color=o),e?this.update(!0):this.parent}syncFont(t,e){e.font=this._font}syncStyle(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"}syncShadow(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)}update(t){return t&&(this._font=this.fontStyle+" "+this.fontSize+" "+this.fontFamily,this.metrics=r(this)),this.parent.updateText(t)}buildFont(){var t=this.fontStyle+" "+this.fontSize+" "+this.fontFamily;return t!==this._font&&(this._font=t),this}setFont(t){return"string"==typeof t?(this.fontFamily=t,this.fontSize="",this.fontStyle=""):(this.fontFamily=h(t,"fontFamily","Courier"),this.fontSize=h(t,"fontSize","16px"),this.fontStyle=h(t,"fontStyle","")),this.update(!0)}setFontFamily(t){return this.fontFamily=t,this.update(!0)}setFontStyle(t){return this.fontStyle=t,this.update(!0)}setFontSize(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize=t,this.update(!0)}setTestString(t){return this.testString=t,this.update(!0)}setFixedSize(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)}setResolution(t){return this.resolution=t,this.update(!1)}setLineSpacing(t){return this.lineSpacing=t,this.update(!1)}setBackgroundColor(t){return this.backgroundColor=t,this.update(!1)}setFill(t){return this.color=t,this.update(!1)}setColor(t){return this.color=t,this.update(!1)}setStroke(t,e){return void 0===t?this.strokeThickness=0:(void 0===e&&(e=this.strokeThickness),this.stroke=t,this.strokeThickness=e),this.update(!0)}setShadow(t,e,i,s,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="#000"),void 0===s&&(s=0),void 0===n&&(n=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=s,this.shadowStroke=n,this.shadowFill=r,this.update(!1)}setShadowOffset(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)}setShadowColor(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)}setShadowBlur(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)}setShadowStroke(t){return this.shadowStroke=t,this.update(!1)}setShadowFill(t){return this.shadowFill=t,this.update(!1)}setUnderline(t,e,i){return void 0===t&&(t="#000"),void 0===e&&(e=0),void 0===i&&(i=0),this.underlineColor=t,this.underlineThickness=e,this.underlineOffset=i,this.update(!1)}setUnderlineColor(t){return void 0===t&&(t="#000"),this.underlineColor=t,this.update(!1)}setUnderlineThickness(t){return void 0===t&&(t=0),this.underlineThickness=t,this.update(!1)}setUnderlineOffset(t){return void 0===t&&(t=0),this.underlineOffset=t,this.update(!1)}setWrapMode(t){return"string"==typeof t&&(t=c[t.toLowerCase()]||0),this.wrapMode=t,this.update(!0)}setWrapWidth(t){return this.wrapWidth=t,this.update(!1)}setAlign(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),"string"==typeof t&&(t=d[t.toLowerCase()]||0),"string"==typeof e&&(e=d[e.toLowerCase()]||0),this.halign=t,this.valign=e,this.update(!1)}setHAlign(t){return void 0===t&&(t=0),"string"==typeof t&&(t=d[t.toLowerCase()]||0),this.halign=t,this.update(!1)}setVAlign(t){return void 0===t&&(t=0),"string"==typeof t&&(t=d[t.toLowerCase()]||0),this.valign=t,this.update(!1)}setMaxLines(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)}getTextMetrics(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}}get lineHeight(){return this.metrics.fontSize+this.strokeThickness+this.lineSpacing}toJSON(){var t={};for(var e in l)t[e]=this[e];return t.metrics=this.getTextMetrics(),t}destroy(){this.parent=void 0}}},3:function(t,e,i){"use strict";var s=function(t){return null==t||""===t||0===t.length};e.a=function(t,e,i){if("object"==typeof t)if(s(e)){if(null==i)return;"object"==typeof i&&(t=i)}else{"string"==typeof e&&(e=e.split("."));var n=e.pop();((function(t,e,i){void 0===i&&(i={});var n=t;if(s(e));else{var r;"string"==typeof e&&(e=e.split("."));for(var o=0,a=e.length;o<a;o++){var h;null!=n[r=e[o]]&&"object"==typeof n[r]||(h=o===a-1?i:{},n[r]=h),n=n[r]}}return n})(t,e))[n]=i}}},331:function(t,e,i){"use strict";i.r(e);var s=i(65),n=i(3);const r=Phaser.Utils.Objects.GetAdvancedValue,o=Phaser.GameObjects.BuildGameObject;Object(n.a)(window,"RexPlugins.GameObjects.BBCodeText",s.a),e.default=class extends Phaser.Plugins.BasePlugin{constructor(t){super(t),t.registerGameObject("rexBBCodeText",this.addBBCodeText,this.makeBBCodeText)}start(){this.game.events.once("destroy",this.destroy,this)}addBBCodeText(t,e,i,n){var r=new s.a(this.scene,t,e,i,n);return this.scene.add.existing(r),r}makeBBCodeText(t,e){var i=r(t,"text",""),n=r(t,"style",null),a=r(t,"padding",null);null!==a&&(n.padding=a),void 0!==e&&(t.add=e);var h=new s.a(this.scene,0,0,i,n);return o(this.scene,h,t),h.autoRound=r(t,"autoRound",!0),h.resolution=r(t,"resolution",1),h}}},44:function(t,e,i){"use strict";var s=i(60),n=i.n(s),r=i(27),o=i(11),a=i(1);const h=Phaser.Utils.Objects.GetValue,l=a.a.NO_NEWLINE,d=a.a.RAW_NEWLINE;var u=class{constructor(t){this.prop={},this.resetFromJSON(t)}resetFromJSON(t){this.text=h(t,"text",""),this.x=h(t,"x",0),this.y=h(t,"y",0),this.width=h(t,"width",0);var e=h(t,"prop",null);null===e&&(e={}),this.prop=e,this.newLineMode=h(t,"newLineMode",0),this.startIndex=h(t,"startIndex",0)}get plainText(){var t=this.text;return this.newLineMode===d&&(t+="\n"),t}get wrapText(){var t=this.text;return this.newLineMode!==l&&(t+="\n"),t}get rawTextLength(){var t=this.text.length;return this.newLineMode===d&&(t+=1),t}get endIndex(){return this.startIndex+this.rawTextLength}get lastX(){return this.x+this.width}},c=i(10),f=i(9);const p=Phaser.Utils.Objects.GetFastValue,g=a.a.NO_NEWLINE;var v=new o.a,x=new o.a;class w{constructor(t){this.pens=[],this.lines=[],this.maxLinesWidth=void 0,this.PensPool=p(t,"pensPool",v),this.LinesPool=p(t,"linesPool",x),this.tagToText=p(t,"tagToText",f.default),this.tagToTextScope=p(t,"tagToTextScope",void 0)}destroy(){this.freePens(),this.tagToText=void 0,this.tagToTextScope=void 0}freePens(){for(var t=0,e=this.lines.length;t<e;t++)this.lines[t].length=0;this.PensPool.pushMultiple(this.pens),this.LinesPool.pushMultiple(this.lines),this.maxLinesWidth=void 0}addPen(t,e,i,s,n,r){var o=this.PensPool.pop();null==o&&(o=new u),y.text=t,y.x=e,y.y=i,y.width=s,y.prop=n,y.newLineMode=r,o.resetFromJSON(y);var a=this.lastPen;o.startIndex=null==a?0:a.endIndex,this.pens.push(o);var h=this.lastLine;null==h&&(h=this.LinesPool.pop()||[],this.lines.push(h)),h.push(o),o.newLineMode!==g&&(h=this.LinesPool.pop()||[],this.lines.push(h)),this.maxLinesWidth=void 0}clone(t){null==t&&(t=new w),t.freePens();for(var e=0,i=this.lines.length;e<i;e++)for(var s=this.lines[e],n=0,r=s.length;n<r;n++){var o=s[n];t.addPen(o.text,o.x,o.y,o.width,Object(c.a)(o.prop),o.newLineMode)}return t}get lastPen(){return this.pens[this.pens.length-1]}get lastLine(){return this.lines[this.lines.length-1]}getLineStartIndex(t){if(t>=this.lines.length)return this.getLineEndIndex(t);var e=this.lines[t];return e&&e[0]?e[0].startIndex:0}getLineEndIndex(t){t>=this.lines.length&&(t=this.lines.length-1);var e,i,s=!1;for(e=t;e>=0&&!(s=null!=(i=this.lines[e])&&i.length>0);e--);return s?i[i.length-1].endIndex:0}getLineWidth(t){var e=this.lines[t];if(!e)return 0;var i=e[e.length-1];return null==i?0:i.lastX}getMaxLineWidth(){if(void 0!==this.maxLinesWidth)return this.maxLinesWidth;for(var t,e=0,i=0,s=this.lines.length;i<s;i++)(t=this.getLineWidth(i))>e&&(e=t);return this.maxLinesWidth=e,e}getLineWidths(){for(var t=[],e=0,i=this.lines.length;e<i;e++)t.push(this.getLineWidth(e));return t}get linesCount(){return this.lines.length}get plainText(){for(var t="",e=this.pens,i=0,s=e.length;i<s;i++)t+=e[i].plainText;return t}get rawTextLength(){for(var t=0,e=this.pens,i=0,s=this.pens.length;i<s;i++)t+=e[i].rawTextLength;return t}getSliceTagText(t,e,i){if(void 0===t&&(t=0),void 0===e){var s=this.lastPen;if(null==s)return"";e=s.endIndex}void 0===i&&(i=!1);for(var n,r,o,a,h,l,d="",u=0,c=this.pens.length;u<c&&((a=(n=this.pens[u]).endIndex)<=t||(n=this.pens[u],r=i?n.wrapText:n.plainText,h=n.prop,(o=n.startIndex)>=t&&a<=e||(r=r.substring(t-o,e-o)),this.tagToTextScope?d+=this.tagToText.call(this.tagToTextScope,r,h,l):d+=this.tagToText(r,h,l),l=h,!(a>=e)));u++);return d}}var y={},S=w;const T=a.a.NO_NEWLINE,m=a.a.RAW_NEWLINE,P=a.a.WRAPPED_NEWLINE,b=a.a.NO_WRAP,O=a.a.WORD_WRAP,k=(a.a.CHAR_WRAP,a.a.SPLITREGEXP);var M=[],C=new o.a;C.newline=function(t,e,i){var s=this.pop();return null===s&&(s={}),s.text=t,s.width=e,s.newLineMode=i,s};var L=function(t,e,i,s,n){s<=0&&(i=b);var r=M;if(C.pushMultiple(r),!t||!t.length)return r;for(var o,a,h,l=t.split(k),d=0,u=l.length;d<u;d++)if(o=l[d],h=d===u-1?T:m,i!==b){var c,f;if(a=0===d?s-n:s,o.length<=100&&(S=e(o))<=a){r.push(C.newline(o,S,h));continue}for(var p,g="",v="",x=0,w=0,y=(c=i===O?o.split(" "):o).length;w<y;w++)f=c[w],i===O?(g+=f,w<y-1&&(g+=" ")):g+=f,(p=e(g))>a&&(0===w?r.push(C.newline("",0,P)):(r.push(C.newline(v,x,P)),g=f,i===O&&w<y-1&&(g+=" "),p=e(g)),a=s),v=g,x=p;r.push(C.newline(v,x,h))}else{var S=e(o);r.push(C.newline(o,S,h))}return r};const W=Phaser.Utils.Objects.GetValue,F=(a.a.NO_WRAP,a.a.NO_NEWLINE),_=(a.a.hleft,a.a.hcenter),z=a.a.hright,R=(a.a.vtop,a.a.vcenter),B=a.a.vbottom;var A={},N=class{constructor(t){this.context=W(t,"context",null),this.canvas=this.context.canvas,this.parser=W(t,"parser",null),this.defatultStyle=W(t,"style",null),this.autoRound=!0,this.pensPool=W(t,"pensPool",null),this.penManager=this.newPenManager(),this._tmpPenManager=null;var e=this.context;this.getTextWidth=function(t){return e.measureText(t).width}}updatePenManager(t,e,i,s,n){if(void 0===n&&(n=this.penManager),n.freePens(),""===t)return n;for(var r,o,a,h,l,d=this.canvas,u=this.context,f=0,p=0,g=this.parser.splitText(t),v=0,x=g.length;v<x;v++)if(r=(h=this.parser.tagTextToProp(g[v],o)).plainText,o=h.prop,""!==r){this.context.save(),(a=this.parser.propToContextStyle(this.defatultStyle,o)).buildFont(),a.syncFont(d,u),a.syncStyle(d,u);for(var w=0,y=(l=L(r,this.getTextWidth,e,i,f)).length;w<y;w++){var S=l[w];n.addPen(S.text,f,p,S.width,Object(c.a)(o),S.newLineMode),S.newLineMode!==F?(f=0,p+=s):f+=S.width}this.context.restore()}return n}draw(t,e,i,s,n){void 0===n&&(n=this.penManager);var r=this.context;r.save(),this.drawBackground();var o=this.defatultStyle;t+=o.strokeThickness/2,e+=o.strokeThickness/2+o.metrics.ascent;var a,h,l,d,u,c,f=o.halign,p=o.valign,g=o.lineHeight,v=n.lines,x=v.length,w=o.maxLines;w>0&&x>w?(h=w,l=p===R?Math.floor((x-h)/2):p===B?x-h:0):(h=x,l=0),d=l+h,c=p===R?Math.max((s-h*g)/2,0):p===B?Math.max(s-h*g-2,0):0,c+=e;for(var y=l;y<d;y++)if(0!==(a=n.getLineWidth(y))){u=f===_?(i-a)/2:f===z?i-a:0,u+=t;for(var S=v[y],T=0,m=S.length;T<m;T++)this.drawPen(S[T],u,c)}r.restore()}clear(){var t=this.canvas;this.context.clearRect(0,0,t.width,t.height)}drawBackground(){var t=this.defatultStyle.backgroundColor;if(null!==t){var e=this.context,i=this.canvas;e.fillStyle=t,e.fillRect(0,0,i.width,i.height)}}drawUnderline(t,e,i,s,n){if(!(s<=0)){var r=this.context,o=r.lineCap;r.lineCap="butt",r.beginPath(),r.strokeStyle=n,r.lineWidth=s,r.moveTo(t,e),r.lineTo(t+i,e),r.stroke(),r.lineCap=o}}drawPen(t,e,i){var s=this.canvas,n=this.context;n.save();var r=this.parser.propToContextStyle(this.defatultStyle,t.prop);r.buildFont(),r.syncFont(s,n),r.syncStyle(s,n),e+=t.x,i+=t.y,this.autoRound&&(e=Math.round(e),i=Math.round(i));var o=t.text,a=t.width;this.drawUnderline(e,i+r.underlineOffset,a,r.underlineThickness,r.underlineColor),r.strokeThickness&&(r.syncShadow(n,r.shadowStroke),n.strokeText(o,e,i)),r.color&&"none"!==r.color&&(r.syncShadow(n,r.shadowFill),n.fillText(o,e,i)),n.restore()}destroy(){this.context=void 0,this.canvas=void 0,this.parser=void 0,this.defatultStyle=void 0,this.penManager.destroy(),this.penManager=void 0,this._tmpPenManager&&(this._tmpPenManager.destroy(),this._tmpPenManager=void 0)}get lines(){return this.penManager.lines}get desplayLinesCount(){var t=this.penManager.linesCount,e=this.defatultStyle.maxLines;return e>0&&t>e&&(t=e),t}get linesWidth(){return this.penManager.getMaxLineWidth()}get linesHeight(){var t=this.desplayLinesCount,e=this.defatultStyle.lineHeight*t;return t>0&&(e-=this.defatultStyle.lineSpacing),e}newPenManager(){return A.pensPool=this.pensPool,A.tagToText=this.parser.propToTagText,A.tagToTextScope=this.parser,new S(A)}get tmpPenManager(){return null===this._tmpPenManager&&(this._tmpPenManager=this.newPenManager()),this._tmpPenManager}getPlainText(t,e,i){var s;if(null==t)s=this.penManager.plainText;else{var n=this.parser.splitText(t,1);s="";for(var r=0,o=n.length;r<o;r++)s+=n[r]}return null==e&&null==i||(null==e&&(e=0),null==i&&(i=s.length),s=s.substring(e,i)),s}getPenManager(t,e){if(void 0===t)return this.copyPenManager(e,this.penManager);void 0===e&&(e=this.newPenManager());var i=this.defatultStyle;return this.updatePenManager(t,i.wrapMode,i.wrapWidth,i.lineHeight,e),e}getText(t,e,i,s){if(null==t)return this.penManager.getSliceTagText(e,i,s);var n=this.tmpPenManager,r=this.defatultStyle;return this.updatePenManager(t,r.wrapMode,r.wrapWidth,r.lineHeight,n),n.getSliceTagText(e,i,s)}copyPenManager(t,e){return void 0===e&&(e=this.penManager),e.copy(t)}getTextWidth(t){return void 0===t&&(t=this.penManager),t.getMaxLineWidth()}getLastPen(t){return void 0===t&&(t=this.penManager),t.lastPen}};const j=Phaser.DOM.AddToDOM,E=Phaser.Display.Canvas.CanvasPool,I=Phaser.GameObjects.Components,X=Phaser.GameObjects.GameObject,H=Phaser.Utils.Objects.GetValue,G=Phaser.DOM.RemoveFromDOM,Y=a.a.SPLITREGEXP,D=Phaser.Geom.Rectangle;var U={},V=new Phaser.Class({Extends:X,Mixins:[I.Alpha,I.BlendMode,I.ComputedSize,I.Crop,I.Depth,I.Flip,I.GetBounds,I.Mask,I.Origin,I.Pipeline,I.ScrollFactor,I.Tint,I.Transform,I.Visible,n.a],initialize:function(t,e,i,s,n,a,h){if(void 0===e&&(e=0),void 0===i&&(i=0),X.call(this,t,a),this.renderer=t.sys.game.renderer,this.setPosition(e,i),this.setOrigin(0,0),this.initPipeline(),this.canvas=E.create(this),this.context=this.canvas.getContext("2d"),n&&n.hasOwnProperty("align")){var l=n.align;delete n.align,n.halign=l}this.style=new r.a(this,n),this.autoRound=!0,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.dirty=!1,0===this.style.resolution&&(this.style.resolution=t.sys.game.config.resolution),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),U.hasOwnProperty(a)||(U[a]=new o.a),J.context=this.context,J.parser=h,J.style=this.style,J.pensPool=U[a],this.canvasText=new N(J),n&&n.padding&&this.setPadding(n.padding),this.setText(s),t.sys.game.config.renderType===Phaser.WEBGL&&t.sys.game.renderer.onContextRestored(function(){this.dirty=!0},this)},text:{set:function(t){this.setText(t)},get:function(){return this._text}},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",j(this.canvas,this.scene.sys.canvas),this.originX=1)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,i,s,n,r){return this.style.setShadow(t,e,i,s,n,r)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWrapMode:function(t){return this.style.setWrapMode(t)},setWrapWidth:function(t){return this.style.setWrapWidth(t)},setAlign:function(t){return this.style.setHAlign(t)},setLineSpacing:function(t){return this.style.setLineSpacing(t)},setPadding:function(t,e,i,s){if("object"==typeof t){var n=t,r=H(n,"x",null);null!==r?(t=r,i=r):(t=H(n,"left",0),i=H(n,"right",t));var o=H(n,"y",null);null!==o?(e=o,s=o):(e=H(n,"top",0),s=H(n,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=t),void 0===s&&(s=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=s,this.updateText(!1)},setResolution:function(t){return this.style.setResolution(t)},setMaxLines:function(t){return this.style.setMaxLines(t)},updateText:function(t){void 0===t&&(t=!0);var e=this.canvasText,i=this.style;t&&e.updatePenManager(this._text,i.wrapMode,i.wrapWidth,i.lineHeight);var s,n,r=this.padding;0===i.fixedWidth?(this.width=e.linesWidth+r.left+r.right,s=e.linesWidth):(this.width=i.fixedWidth,(s=this.width-r.left-r.right)<e.linesWidth&&(s=e.linesWidth)),0===i.fixedHeight?(this.height=e.linesHeight+r.top+r.bottom,n=e.linesHeight):(this.height=i.fixedHeight,(n=this.height-r.top-r.bottom)<e.linesHeight&&(n=e.linesHeight));var o=this.width,a=this.height;this.updateDisplayOrigin();var h=i.resolution;o*=h,a*=h,o=Math.max(Math.ceil(o),1),a=Math.max(Math.ceil(a),1);var l=this.canvas,d=this.context;return l.width!==o||l.height!==a?(l.width=o,l.height=a,this.frame.setSize(o,a)):d.clearRect(0,0,o,a),d.save(),d.scale(h,h),e.draw(r.left,r.top,s,n),d.restore(),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(l,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0,this.input&&this.input.hitArea instanceof D&&(this.input.hitArea.width=this.width,this.input.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},toJSON:function(){var t=I.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),resolution:this.resolution,padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){this.style.rtl&&G(this.canvas),E.remove(this.canvas),this.canvasText.destroy()},getWrappedText:function(t,e,i){return(t=this.canvasText.getText(t,e,i,!0)).split(Y)},getPlainText:function(t,e,i){return this.canvasText.getPlainText(t,e,i)},getText:function(t,e,i){return this.canvasText.getText(t,e,i,!1)},getSubString:function(t,e,i){return this.getText(t,e,i)},copyPenManager:function(t){return this.canvasText.copyPenManager(t)},getPenManager:function(t,e){return this.canvasText.getPenManager(t,e)},setSize:function(t,e){return this.setFixedSize(t,e)},resize:function(t,e){return this.setFixedSize(t,e)},lineSpacing:{get:function(){return this.style.lineSpacing},set:function(t){this.setLineSpacing(t)}}}),J={};e.a=V},6:function(t,e,i){"use strict";e.a=function(t){if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]}},60:function(t,e,i){var s=i(9),n=i(9);s=i(122),n=i(121),t.exports={renderWebGL:s,renderCanvas:n}},65:function(t,e,i){"use strict";var s=i(44),n={plainText:null,prevProp:null},r=new(i(27).a),o={},a={splitText:function(t,e){for(var i,s,n=[],r=0,o=t.length,a=o;i=d.exec(t);)s=i[0],r<(a=d.lastIndex-s.length)&&n.push(t.substring(r,a)),void 0===e&&n.push(s),r=d.lastIndex;return r<o&&n.push(t.substring(r,o)),n},tagTextToProp:function(t,e){var i,s;null==e&&(e={}),e.img&&h(e,L,"img"),u.test(t)?(h(e,W,"b",!0),i=""):c.test(t)?(h(e,L,"b"),i=""):f.test(t)?(h(e,W,"i",!0),i=""):p.test(t)?(h(e,L,"i"),i=""):g.test(t)?(s=t.match(g),h(e,W,"size",s[1]+"px"),i=""):v.test(t)?(h(e,L,"size"),i=""):x.test(t)?(s=t.match(x),h(e,W,"color",s[1]),i=""):w.test(t)?(h(e,L,"color"),i=""):y.test(t)?(s=t.match(y),h(e,W,"u",!0),i=""):S.test(t)?(s=t.match(S),h(e,W,"u",s[1]),i=""):T.test(t)?(h(e,L,"u"),i=""):m.test(t)?(h(e,W,"shadow",!0),i=""):P.test(t)?(h(e,L,"shadow"),i=""):b.test(t)?(h(e,W,"stroke",!0),i=""):O.test(t)?(s=t.match(O),h(e,W,"stroke",s[1]),i=""):k.test(t)?(h(e,L,"stroke"),i=""):M.test(t)?(s=t.match(M),h(e,W,"img",s[1]),i=""):C.test(t)?(h(e,L,"img"),i=""):i=t;var r=n;return r.plainText=i,r.prop=e,r},propToContextStyle:function(t,e){var i=r;if(e.hasOwnProperty("img"))i.image=e.img;else{if(i.image=null,e.hasOwnProperty("family")?i.fontFamily=e.family:i.fontFamily=t.fontFamily,e.hasOwnProperty("size")){var s=e.size;"number"==typeof s&&(s=s.toString()+"px"),i.fontSize=s}else i.fontSize=t.fontSize;i.fontStyle=l(e.b,e.i),e.hasOwnProperty("color")?i.color=e.color:i.color=t.color,e.hasOwnProperty("stroke")?!0===e.stroke?(i.stroke=t.stroke,i.strokeThickness=t.strokeThickness):(i.stroke=e.stroke,i.strokeThickness=t.strokeThickness):(i.stroke=t.stroke,i.strokeThickness=0)}return e.hasOwnProperty("shadow")?!0===e.shadow?(i.shadowColor=t.shadowColor,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0):(i.shadowColor=e.shadow,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0):(i.shadowColor="#000",i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,i.shadowStroke=!1,i.shadowFill=!1),e.hasOwnProperty("u")?!0===e.u?(i.underlineColor=t.underlineColor,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset):(i.underlineColor=e.u,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset):(i.underlineColor="#000",i.underlineThickness=0,i.underlineOffset=0),i},propToTagText:function(t,e,i){for(var s in null==i&&(i=o),i)e.hasOwnProperty(s)||(t="[/"+s+"]"+t);var n="";for(var s in e)i[s]!==e[s]&&("size"===s?n+="[size="+e[s].replace("px","")+"]":"color"===s||"stroke"===s||"img"===s?n+="["+s+"="+e[s]+"]":"u"===s?!0===e[s]?n+="[u]":n+="[u="+e[s]+"]":n+="["+s+"]");return t=n+t}},h=function(t,e,i,s){return e===W?t[i]=s:t.hasOwnProperty(i)&&delete t[i],t},l=function(t,e){return t&&e?"bold italic":t?"bold":e?"italic":""},d=/\[b\]|\[\/b\]|\[i\]|\[\/i\]|\[size=(\d+)\]|\[\/size\]|\[color=([a-z]+|#[0-9abcdef]+)\]|\[\/color\]|\[u\]|\[u=([a-z]+|#[0-9abcdef]+)\]|\[\/u\]|\[shadow\]|\[\/shadow\]|\[stroke\]|\[stroke=([a-z]+|#[0-9abcdef]+)\]|\[\/stroke\]|\[img=([^\]]+)\]|\[\/img\]/gi,u=/\[b\]/i,c=/\[\/b\]/i,f=/\[i\]/i,p=/\[\/i\]/i,g=/\[size=(\d+)\]/i,v=/\[\/size\]/i,x=/\[color=([a-z]+|#[0-9abcdef]+)\]/i,w=/\[\/color\]/i,y=/\[u\]/i,S=/\[u=([a-z]+|#[0-9abcdef]+)\]/i,T=/\[\/u\]/i,m=/\[shadow\]/i,P=/\[\/shadow\]/i,b=/\[stroke\]/i,O=/\[stroke=([a-z]+|#[0-9abcdef]+)\]/i,k=/\[\/stroke\]/i,M=/\[img=([^\]]+)\]/i,C=/\[\/img\]/i;const L=!1,W=!0;var F=a;e.a=class extends s.a{constructor(t,e,i,s,n){super(t,e,i,s,n,"rexBBCodeText",F)}}},9:function(t,e,i){"use strict";i.r(e);e.default=function(){}}}).default});